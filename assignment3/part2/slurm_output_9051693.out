============================================================================================== 
Warning! Mixing Conda and module environments may lead to corruption of the
user environment. 
We do not recommend users mixing those two environments unless absolutely
necessary. Note that 
SURF does not provide any support for Conda environment.
For more information, please refer to our software policy page:
https://servicedesk.surf.nl/wiki/display/WIKI/Software+policy+Snellius#SoftwarepolicySnellius-UseofAnacondaandMinicondaenvironmentsonSnellius 

Remember that many packages have already been installed on the system and can
be loaded using 
the 'module load <package__name>' command. If you are uncertain if a package is
already available 
on the system, please use 'module avail' or 'module spider' to search for it.
============================================================================================== 
Arguments:
batch_size: 64
valid_ratio: 0.75
augmentations: False
pretrained: True
num_epochs: 30
train_strats: ['fgsm']
visualise: True
epsilon_fgsm: 0.1
alpha_fgsm: 0.5
epsilon_pgd: 0.01
alpha_pgd: 2
num_iter_pgd: 10
save_dir: 
test_crossover_defense: False
Device: cuda
training_strategy: fgsm
Loading model
/gpfs/home6/scur2773/uvadlc_practicals_2024/assignment3/part2/cifar10_models/resnet.py:204: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  state_dict = torch.load(script_dir + '/state_dicts/'+arch+'.pt', map_location=device)
Loading data
Files already downloaded and verified
Files already downloaded and verified
Training model
Epoch 0/29
----------
Inputs - shape: torch.Size([64, 3, 32, 32]) requires_grad: False
Labels - shape: torch.Size([64])
Inputs - requires_grad: True
Inputs - grad after backward: tensor([[[[-2.1512e-06,  2.8287e-06, -3.3407e-06,  ...,  6.0189e-06,
            1.8084e-06,  4.3603e-06],
          [-5.8186e-06, -1.7706e-06, -2.7371e-06,  ..., -4.8828e-06,
           -3.0431e-06,  1.2227e-06],
          [-2.1422e-06,  4.1199e-06,  4.2103e-06,  ...,  3.3389e-06,
           -1.1824e-07,  1.4595e-06],
          ...,
          [ 8.4691e-06,  5.7489e-06,  2.8141e-06,  ...,  5.8971e-06,
           -1.0612e-06,  9.5661e-07],
          [ 3.6019e-06, -3.7523e-06,  6.8529e-06,  ..., -4.7366e-06,
           -2.2108e-06, -1.5325e-06],
          [-4.1337e-06,  7.0930e-07,  5.8726e-06,  ...,  1.3254e-06,
            3.6886e-06,  1.0068e-06]],

         [[-4.5846e-07,  6.3606e-06, -2.5098e-06,  ...,  3.4542e-06,
            1.1542e-06,  3.7096e-06],
          [-4.1187e-06,  3.8142e-06, -3.6203e-07,  ..., -4.3181e-06,
           -9.9437e-07,  3.5363e-07],
          [-2.3192e-06,  1.9925e-06, -2.7153e-07,  ...,  3.4895e-06,
            2.9030e-06,  7.6561e-07],
          ...,
          [ 7.6960e-06, -7.0835e-06, -5.0998e-06,  ...,  7.0015e-06,
           -1.7403e-07,  5.5255e-07],
          [ 2.2070e-06, -1.1526e-05, -1.5246e-06,  ..., -2.8131e-06,
           -1.5893e-06, -1.2206e-06],
          [-1.7410e-06,  1.5567e-06, -2.7718e-07,  ...,  2.1445e-06,
            6.3117e-07,  2.9301e-07]],

         [[ 1.8426e-07,  6.2857e-06, -1.6761e-06,  ...,  3.1605e-06,
            2.8253e-06,  3.7402e-06],
          [-3.9078e-06,  4.4028e-06, -3.5092e-07,  ..., -1.5531e-06,
            2.9770e-06,  1.3022e-06],
          [-5.6650e-07,  6.6415e-06,  2.2140e-06,  ...,  2.8427e-06,
            5.2394e-06,  1.1789e-06],
          ...,
          [ 1.1590e-05,  4.5618e-07, -3.6163e-07,  ...,  6.0349e-06,
            5.4833e-07,  6.9817e-07],
          [ 5.1222e-06, -6.5149e-06, -1.8294e-06,  ..., -2.5102e-06,
            6.7315e-07, -1.5125e-07],
          [-9.8361e-07,  2.1987e-06, -1.2930e-06,  ...,  5.6294e-07,
           -6.0945e-07,  3.4754e-08]]],


        [[[-1.1879e-06, -2.5323e-06,  2.8674e-06,  ..., -1.6927e-07,
            1.6285e-06,  8.4087e-06],
          [-6.7606e-07,  1.6780e-06,  4.0217e-06,  ..., -4.7153e-06,
            1.3308e-06,  2.3025e-06],
          [-1.0227e-05, -4.0075e-07,  9.0239e-06,  ..., -7.4269e-06,
           -4.8843e-06,  1.1924e-06],
          ...,
          [ 1.2869e-06,  3.7957e-06, -1.6271e-06,  ...,  1.0399e-06,
            2.8523e-06,  5.2521e-06],
          [-1.5934e-06,  1.7541e-07, -3.7398e-06,  ..., -3.2448e-06,
           -9.5414e-07,  1.2110e-07],
          [-3.0616e-06,  1.7083e-06,  5.3844e-06,  ...,  8.0810e-07,
            2.1375e-06,  4.7250e-07]],

         [[-2.5728e-06, -1.0624e-05, -1.0126e-05,  ...,  2.5635e-06,
            3.2369e-06,  5.8317e-06],
          [ 3.2233e-06,  1.2609e-06, -2.7240e-06,  ...,  2.0060e-06,
            5.4302e-06,  2.0432e-07],
          [-4.0551e-06,  4.0047e-06, -1.1691e-06,  ..., -1.2857e-07,
           -4.0635e-07,  1.7372e-07],
          ...,
          [-2.6305e-06,  7.0173e-08, -3.2197e-06,  ..., -3.2324e-07,
           -3.7694e-08,  4.1693e-06],
          [-3.5151e-06, -3.3081e-06, -6.8035e-06,  ..., -4.9276e-06,
           -2.1826e-06,  1.2477e-08],
          [-2.9828e-06,  4.0796e-07,  2.0815e-06,  ...,  1.5588e-06,
            1.0438e-06, -6.7832e-08]],

         [[ 1.1029e-06, -1.7777e-06,  1.7077e-06,  ...,  1.2219e-06,
            1.2418e-06,  3.9124e-06],
          [ 3.1573e-06,  5.8064e-06,  1.1427e-05,  ...,  2.4119e-06,
            4.8645e-06,  5.9860e-08],
          [-6.3332e-06,  2.5641e-06,  1.2666e-05,  ..., -9.9691e-07,
            1.1059e-06,  5.7117e-07],
          ...,
          [-1.0285e-06,  2.9067e-06, -4.4927e-07,  ...,  1.4394e-06,
            4.0387e-07,  3.3237e-06],
          [-1.2480e-06, -1.0100e-07, -3.7401e-06,  ..., -3.4576e-06,
           -1.3569e-06,  2.7938e-07],
          [-2.9428e-06,  5.5012e-07,  5.1237e-07,  ...,  6.7230e-07,
           -1.1969e-07, -3.3969e-07]]],


        [[[-3.1523e-06, -9.5493e-06, -3.9723e-06,  ..., -6.8391e-06,
            1.3740e-06,  3.3698e-07],
          [-7.1349e-06, -1.3837e-05, -2.8104e-05,  ..., -5.0424e-06,
           -1.5754e-06, -2.6650e-07],
          [-1.4294e-05, -1.2351e-05, -1.7558e-05,  ...,  2.6042e-06,
           -6.8724e-06,  3.6668e-06],
          ...,
          [ 3.1372e-06, -8.6740e-06,  1.2905e-06,  ...,  2.0158e-06,
           -1.4626e-06, -1.2001e-06],
          [ 5.7802e-06,  7.1777e-06,  2.1542e-05,  ...,  1.2679e-07,
            1.4713e-06,  2.5024e-07],
          [ 7.4320e-07, -6.5848e-07,  1.3347e-05,  ...,  4.7243e-06,
            3.2018e-06, -5.4037e-07]],

         [[ 1.0357e-06,  1.9500e-06, -1.8524e-07,  ..., -2.1185e-07,
            4.7984e-06,  2.0160e-06],
          [ 4.1207e-06,  8.8092e-06, -3.8029e-06,  ...,  4.9527e-06,
            3.2138e-06,  1.1885e-06],
          [-7.1484e-07,  1.1594e-05,  1.7233e-06,  ...,  4.8676e-06,
           -3.3688e-06,  3.7031e-06],
          ...,
          [-2.5292e-06, -5.2858e-06,  1.2440e-05,  ...,  5.9908e-07,
           -1.4469e-06, -1.7563e-06],
          [-5.5099e-06, -4.8245e-06,  1.4802e-05,  ...,  1.8293e-06,
            3.0912e-06, -2.0176e-06],
          [-4.3930e-06, -3.2644e-06,  5.0291e-07,  ...,  2.4883e-06,
            2.2094e-06, -1.9852e-06]],

         [[ 4.4144e-08,  1.3924e-06, -4.8131e-06,  ..., -4.1655e-06,
            4.1025e-06,  1.4860e-06],
          [ 1.6434e-06,  6.3736e-06, -2.7099e-06,  ...,  4.1419e-06,
            3.5354e-06,  3.5747e-10],
          [-2.9740e-06,  7.5732e-06, -3.9124e-06,  ...,  5.6468e-06,
            5.1436e-07,  1.9015e-06],
          ...,
          [-3.8857e-06, -2.7283e-06,  6.4194e-06,  ..., -8.3351e-07,
           -1.6069e-06, -1.0738e-06],
          [-7.4254e-06, -8.5256e-06,  1.9477e-06,  ...,  2.5198e-06,
            3.4487e-06, -1.8869e-06],
          [-3.2547e-06, -2.1377e-06, -6.8055e-06,  ...,  2.1126e-06,
            2.7912e-06, -1.9193e-06]]],


        ...,


        [[[ 9.2521e-07,  6.1521e-06,  2.1807e-06,  ...,  2.3901e-06,
            1.9228e-06,  1.9904e-06],
          [ 4.8527e-06, -2.5392e-07,  3.1092e-06,  ...,  2.7883e-06,
           -2.7369e-06, -8.1032e-07],
          [-3.1936e-06,  7.2225e-06,  7.8171e-06,  ..., -1.9206e-07,
           -4.4206e-06, -7.6897e-07],
          ...,
          [-6.6911e-06,  5.2517e-06,  6.5081e-06,  ...,  3.1046e-06,
           -4.6049e-07,  2.4321e-06],
          [-4.4951e-06,  3.0749e-06,  2.9464e-06,  ...,  1.3043e-06,
            6.9173e-06,  5.6054e-06],
          [-1.8641e-06,  5.7689e-07,  1.6520e-06,  ...,  6.6072e-06,
            4.0433e-06, -3.1383e-07]],

         [[-8.0783e-07,  4.4732e-06,  1.2890e-06,  ...,  1.3044e-06,
            6.8014e-07,  1.4188e-06],
          [ 8.9288e-07, -6.5674e-06, -1.1939e-06,  ..., -4.8840e-07,
           -4.4821e-06, -2.3606e-06],
          [ 6.8826e-07,  4.2442e-06,  2.6229e-06,  ..., -1.5265e-06,
           -1.9125e-06,  1.1083e-06],
          ...,
          [-5.1709e-06,  1.2992e-06, -3.2309e-06,  ..., -3.3630e-06,
           -9.7785e-06, -2.5378e-06],
          [-4.9448e-06, -2.0307e-08, -2.8821e-06,  ..., -8.3425e-06,
           -3.1171e-06,  1.8735e-06],
          [-1.3767e-06, -1.1827e-06, -1.1067e-06,  ...,  1.1993e-06,
           -1.4635e-06, -2.2150e-06]],

         [[-1.1296e-06,  4.3960e-06,  1.8397e-06,  ...,  3.3022e-06,
            1.6226e-06,  1.4090e-06],
          [ 8.1896e-07, -7.4738e-06, -2.5203e-06,  ...,  3.1829e-06,
           -5.1000e-07, -1.6546e-06],
          [ 2.6643e-06,  3.1548e-06,  5.4138e-07,  ...,  2.6541e-06,
            2.1338e-06,  1.9508e-06],
          ...,
          [-2.6608e-06,  2.6336e-06, -4.4141e-06,  ...,  5.2570e-06,
           -3.2931e-06,  1.2501e-06],
          [-2.6554e-06,  3.1397e-06, -1.7394e-06,  ..., -2.7053e-06,
           -9.0141e-07,  3.1452e-06],
          [ 5.4442e-07,  3.0922e-07, -1.1806e-06,  ...,  1.4102e-06,
           -1.0670e-06, -2.5743e-06]]],


        [[[-1.3168e-06, -8.3377e-06,  3.9679e-06,  ..., -1.2869e-06,
           -1.3114e-06,  1.0925e-06],
          [-7.1526e-06, -1.6040e-05,  1.2895e-05,  ..., -2.8513e-07,
           -9.2848e-07,  3.8173e-06],
          [-9.2187e-06, -4.1217e-06,  8.9547e-07,  ...,  3.8958e-06,
           -7.4361e-06, -2.7331e-06],
          ...,
          [-1.8343e-07, -9.4197e-06, -4.2814e-06,  ..., -3.6212e-06,
            2.2529e-06, -1.5683e-06],
          [ 1.1088e-06,  2.7129e-06, -4.5800e-06,  ...,  2.6758e-06,
           -3.6978e-06, -1.8244e-06],
          [-4.9167e-06,  6.0045e-06, -3.7760e-06,  ..., -1.3404e-07,
            1.9758e-06, -1.0769e-06]],

         [[ 4.5329e-06, -2.8285e-06,  2.4425e-06,  ...,  1.2329e-06,
            1.9453e-07,  8.7679e-07],
          [ 2.6134e-06, -7.3990e-06,  8.1711e-06,  ...,  3.6121e-06,
            2.2652e-06,  3.2361e-06],
          [-2.5442e-06,  7.4728e-06,  1.3012e-06,  ...,  5.2628e-06,
           -7.9843e-06, -3.5974e-06],
          ...,
          [-2.9389e-06, -1.7360e-05, -1.0456e-05,  ..., -1.6519e-06,
            2.4520e-06, -1.1759e-06],
          [ 3.4436e-07,  8.5822e-07, -6.1154e-06,  ...,  4.6380e-06,
           -2.1874e-06, -9.3889e-08],
          [-7.6028e-06,  5.0707e-06, -4.4500e-06,  ...,  3.4211e-07,
            2.3246e-06, -1.6601e-06]],

         [[ 6.9568e-06,  1.0924e-06,  3.5798e-06,  ...,  1.3307e-06,
           -2.9697e-07, -2.0772e-07],
          [ 6.7794e-06, -5.4534e-06,  8.9283e-06,  ...,  3.8358e-06,
            2.7684e-06,  1.5694e-06],
          [ 1.2503e-07,  6.1354e-06, -1.5318e-07,  ...,  6.8233e-06,
           -5.3218e-06, -1.3392e-06],
          ...,
          [-1.6507e-06, -1.1520e-05, -4.3208e-06,  ..., -1.7556e-06,
            1.8321e-06, -6.9067e-07],
          [-1.3207e-06,  1.9356e-06, -1.9133e-06,  ...,  3.3169e-06,
           -3.2120e-06,  3.9523e-07],
          [-5.8014e-06,  6.1782e-06, -2.9935e-06,  ..., -7.5843e-08,
            8.6034e-07, -2.0522e-06]]],


        [[[ 3.2680e-07,  4.3634e-06,  2.2426e-06,  ..., -9.8696e-07,
            2.2967e-07, -5.4805e-07],
          [ 4.0904e-06,  9.7250e-06,  6.9659e-06,  ...,  1.0349e-06,
            1.0674e-06,  2.0384e-06],
          [-3.4943e-06, -3.6595e-06, -1.6569e-07,  ...,  3.5343e-06,
            2.8139e-06,  2.3450e-06],
          ...,
          [ 6.6830e-06, -7.3164e-07,  1.4373e-05,  ..., -1.3186e-06,
           -1.6171e-06, -1.8791e-06],
          [ 3.4642e-07, -6.2480e-06,  7.5133e-06,  ...,  2.2709e-07,
            8.2162e-06,  2.3978e-06],
          [-5.0643e-07,  4.2849e-06,  2.6100e-06,  ...,  6.1428e-06,
            5.6938e-06,  1.2317e-06]],

         [[-2.0195e-06, -4.6458e-07,  2.9471e-06,  ..., -9.2950e-07,
            3.5279e-07,  7.3866e-07],
          [ 3.5168e-07, -1.6075e-06, -3.5340e-06,  ...,  2.8262e-07,
           -1.2111e-06,  5.1872e-07],
          [-2.8478e-06, -8.2904e-06, -7.1965e-06,  ..., -4.7775e-07,
           -1.6246e-06,  6.1100e-07],
          ...,
          [ 2.7377e-06, -1.3716e-05, -4.6540e-06,  ...,  8.4202e-07,
            1.8898e-06, -5.1693e-06],
          [ 4.0216e-06, -1.0494e-05,  1.3981e-07,  ..., -3.7710e-06,
            4.7856e-06, -1.4602e-06],
          [ 5.8686e-07,  4.5665e-07, -3.4618e-07,  ..., -9.8188e-07,
           -6.8059e-10,  5.1591e-07]],

         [[-1.6739e-06,  8.3527e-07,  4.9337e-06,  ...,  9.0712e-08,
           -4.0415e-08,  1.0814e-06],
          [ 1.9172e-06,  9.8478e-07,  5.2754e-07,  ...,  1.0168e-06,
           -1.9147e-06, -4.3092e-07],
          [ 3.6497e-07, -3.0959e-06, -4.1065e-07,  ..., -2.8220e-07,
           -2.8307e-06, -1.4244e-07],
          ...,
          [ 3.8517e-06, -1.3431e-05, -1.1923e-05,  ...,  5.1140e-06,
            3.0980e-06, -1.7417e-06],
          [ 5.1304e-06, -8.2683e-06, -8.8918e-07,  ..., -5.3927e-06,
            2.2900e-06, -2.6144e-06],
          [ 3.1444e-07, -2.4901e-06, -3.6178e-06,  ..., -7.2394e-06,
           -5.1381e-06, -7.5252e-07]]]], device='cuda:0')
Data Grad - min: tensor(-0.0054, device='cuda:0') max: tensor(0.0044, device='cuda:0')
Perturbed Inputs - requires_grad: False
Perturbed Inputs - min: tensor(0., device='cuda:0') max: tensor(1., device='cuda:0')
Inputs - grad before returning loss: tensor([[[[-2.1512e-06,  2.8287e-06, -3.3407e-06,  ...,  6.0189e-06,
            1.8084e-06,  4.3603e-06],
          [-5.8186e-06, -1.7706e-06, -2.7371e-06,  ..., -4.8828e-06,
           -3.0431e-06,  1.2227e-06],
          [-2.1422e-06,  4.1199e-06,  4.2103e-06,  ...,  3.3389e-06,
           -1.1824e-07,  1.4595e-06],
          ...,
          [ 8.4691e-06,  5.7489e-06,  2.8141e-06,  ...,  5.8971e-06,
           -1.0612e-06,  9.5661e-07],
          [ 3.6019e-06, -3.7523e-06,  6.8529e-06,  ..., -4.7366e-06,
           -2.2108e-06, -1.5325e-06],
          [-4.1337e-06,  7.0930e-07,  5.8726e-06,  ...,  1.3254e-06,
            3.6886e-06,  1.0068e-06]],

         [[-4.5846e-07,  6.3606e-06, -2.5098e-06,  ...,  3.4542e-06,
            1.1542e-06,  3.7096e-06],
          [-4.1187e-06,  3.8142e-06, -3.6203e-07,  ..., -4.3181e-06,
           -9.9437e-07,  3.5363e-07],
          [-2.3192e-06,  1.9925e-06, -2.7153e-07,  ...,  3.4895e-06,
            2.9030e-06,  7.6561e-07],
          ...,
          [ 7.6960e-06, -7.0835e-06, -5.0998e-06,  ...,  7.0015e-06,
           -1.7403e-07,  5.5255e-07],
          [ 2.2070e-06, -1.1526e-05, -1.5246e-06,  ..., -2.8131e-06,
           -1.5893e-06, -1.2206e-06],
          [-1.7410e-06,  1.5567e-06, -2.7718e-07,  ...,  2.1445e-06,
            6.3117e-07,  2.9301e-07]],

         [[ 1.8426e-07,  6.2857e-06, -1.6761e-06,  ...,  3.1605e-06,
            2.8253e-06,  3.7402e-06],
          [-3.9078e-06,  4.4028e-06, -3.5092e-07,  ..., -1.5531e-06,
            2.9770e-06,  1.3022e-06],
          [-5.6650e-07,  6.6415e-06,  2.2140e-06,  ...,  2.8427e-06,
            5.2394e-06,  1.1789e-06],
          ...,
          [ 1.1590e-05,  4.5618e-07, -3.6163e-07,  ...,  6.0349e-06,
            5.4833e-07,  6.9817e-07],
          [ 5.1222e-06, -6.5149e-06, -1.8294e-06,  ..., -2.5102e-06,
            6.7315e-07, -1.5125e-07],
          [-9.8361e-07,  2.1987e-06, -1.2930e-06,  ...,  5.6294e-07,
           -6.0945e-07,  3.4754e-08]]],


        [[[-1.1879e-06, -2.5323e-06,  2.8674e-06,  ..., -1.6927e-07,
            1.6285e-06,  8.4087e-06],
          [-6.7606e-07,  1.6780e-06,  4.0217e-06,  ..., -4.7153e-06,
            1.3308e-06,  2.3025e-06],
          [-1.0227e-05, -4.0075e-07,  9.0239e-06,  ..., -7.4269e-06,
           -4.8843e-06,  1.1924e-06],
          ...,
          [ 1.2869e-06,  3.7957e-06, -1.6271e-06,  ...,  1.0399e-06,
            2.8523e-06,  5.2521e-06],
          [-1.5934e-06,  1.7541e-07, -3.7398e-06,  ..., -3.2448e-06,
           -9.5414e-07,  1.2110e-07],
          [-3.0616e-06,  1.7083e-06,  5.3844e-06,  ...,  8.0810e-07,
            2.1375e-06,  4.7250e-07]],

         [[-2.5728e-06, -1.0624e-05, -1.0126e-05,  ...,  2.5635e-06,
            3.2369e-06,  5.8317e-06],
          [ 3.2233e-06,  1.2609e-06, -2.7240e-06,  ...,  2.0060e-06,
            5.4302e-06,  2.0432e-07],
          [-4.0551e-06,  4.0047e-06, -1.1691e-06,  ..., -1.2857e-07,
           -4.0635e-07,  1.7372e-07],
          ...,
          [-2.6305e-06,  7.0173e-08, -3.2197e-06,  ..., -3.2324e-07,
           -3.7694e-08,  4.1693e-06],
          [-3.5151e-06, -3.3081e-06, -6.8035e-06,  ..., -4.9276e-06,
           -2.1826e-06,  1.2477e-08],
          [-2.9828e-06,  4.0796e-07,  2.0815e-06,  ...,  1.5588e-06,
            1.0438e-06, -6.7832e-08]],

         [[ 1.1029e-06, -1.7777e-06,  1.7077e-06,  ...,  1.2219e-06,
            1.2418e-06,  3.9124e-06],
          [ 3.1573e-06,  5.8064e-06,  1.1427e-05,  ...,  2.4119e-06,
            4.8645e-06,  5.9860e-08],
          [-6.3332e-06,  2.5641e-06,  1.2666e-05,  ..., -9.9691e-07,
            1.1059e-06,  5.7117e-07],
          ...,
          [-1.0285e-06,  2.9067e-06, -4.4927e-07,  ...,  1.4394e-06,
            4.0387e-07,  3.3237e-06],
          [-1.2480e-06, -1.0100e-07, -3.7401e-06,  ..., -3.4576e-06,
           -1.3569e-06,  2.7938e-07],
          [-2.9428e-06,  5.5012e-07,  5.1237e-07,  ...,  6.7230e-07,
           -1.1969e-07, -3.3969e-07]]],


        [[[-3.1523e-06, -9.5493e-06, -3.9723e-06,  ..., -6.8391e-06,
            1.3740e-06,  3.3698e-07],
          [-7.1349e-06, -1.3837e-05, -2.8104e-05,  ..., -5.0424e-06,
           -1.5754e-06, -2.6650e-07],
          [-1.4294e-05, -1.2351e-05, -1.7558e-05,  ...,  2.6042e-06,
           -6.8724e-06,  3.6668e-06],
          ...,
          [ 3.1372e-06, -8.6740e-06,  1.2905e-06,  ...,  2.0158e-06,
           -1.4626e-06, -1.2001e-06],
          [ 5.7802e-06,  7.1777e-06,  2.1542e-05,  ...,  1.2679e-07,
            1.4713e-06,  2.5024e-07],
          [ 7.4320e-07, -6.5848e-07,  1.3347e-05,  ...,  4.7243e-06,
            3.2018e-06, -5.4037e-07]],

         [[ 1.0357e-06,  1.9500e-06, -1.8524e-07,  ..., -2.1185e-07,
            4.7984e-06,  2.0160e-06],
          [ 4.1207e-06,  8.8092e-06, -3.8029e-06,  ...,  4.9527e-06,
            3.2138e-06,  1.1885e-06],
          [-7.1484e-07,  1.1594e-05,  1.7233e-06,  ...,  4.8676e-06,
           -3.3688e-06,  3.7031e-06],
          ...,
          [-2.5292e-06, -5.2858e-06,  1.2440e-05,  ...,  5.9908e-07,
           -1.4469e-06, -1.7563e-06],
          [-5.5099e-06, -4.8245e-06,  1.4802e-05,  ...,  1.8293e-06,
            3.0912e-06, -2.0176e-06],
          [-4.3930e-06, -3.2644e-06,  5.0291e-07,  ...,  2.4883e-06,
            2.2094e-06, -1.9852e-06]],

         [[ 4.4144e-08,  1.3924e-06, -4.8131e-06,  ..., -4.1655e-06,
            4.1025e-06,  1.4860e-06],
          [ 1.6434e-06,  6.3736e-06, -2.7099e-06,  ...,  4.1419e-06,
            3.5354e-06,  3.5747e-10],
          [-2.9740e-06,  7.5732e-06, -3.9124e-06,  ...,  5.6468e-06,
            5.1436e-07,  1.9015e-06],
          ...,
          [-3.8857e-06, -2.7283e-06,  6.4194e-06,  ..., -8.3351e-07,
           -1.6069e-06, -1.0738e-06],
          [-7.4254e-06, -8.5256e-06,  1.9477e-06,  ...,  2.5198e-06,
            3.4487e-06, -1.8869e-06],
          [-3.2547e-06, -2.1377e-06, -6.8055e-06,  ...,  2.1126e-06,
            2.7912e-06, -1.9193e-06]]],


        ...,


        [[[ 9.2521e-07,  6.1521e-06,  2.1807e-06,  ...,  2.3901e-06,
            1.9228e-06,  1.9904e-06],
          [ 4.8527e-06, -2.5392e-07,  3.1092e-06,  ...,  2.7883e-06,
           -2.7369e-06, -8.1032e-07],
          [-3.1936e-06,  7.2225e-06,  7.8171e-06,  ..., -1.9206e-07,
           -4.4206e-06, -7.6897e-07],
          ...,
          [-6.6911e-06,  5.2517e-06,  6.5081e-06,  ...,  3.1046e-06,
           -4.6049e-07,  2.4321e-06],
          [-4.4951e-06,  3.0749e-06,  2.9464e-06,  ...,  1.3043e-06,
            6.9173e-06,  5.6054e-06],
          [-1.8641e-06,  5.7689e-07,  1.6520e-06,  ...,  6.6072e-06,
            4.0433e-06, -3.1383e-07]],

         [[-8.0783e-07,  4.4732e-06,  1.2890e-06,  ...,  1.3044e-06,
            6.8014e-07,  1.4188e-06],
          [ 8.9288e-07, -6.5674e-06, -1.1939e-06,  ..., -4.8840e-07,
           -4.4821e-06, -2.3606e-06],
          [ 6.8826e-07,  4.2442e-06,  2.6229e-06,  ..., -1.5265e-06,
           -1.9125e-06,  1.1083e-06],
          ...,
          [-5.1709e-06,  1.2992e-06, -3.2309e-06,  ..., -3.3630e-06,
           -9.7785e-06, -2.5378e-06],
          [-4.9448e-06, -2.0307e-08, -2.8821e-06,  ..., -8.3425e-06,
           -3.1171e-06,  1.8735e-06],
          [-1.3767e-06, -1.1827e-06, -1.1067e-06,  ...,  1.1993e-06,
           -1.4635e-06, -2.2150e-06]],

         [[-1.1296e-06,  4.3960e-06,  1.8397e-06,  ...,  3.3022e-06,
            1.6226e-06,  1.4090e-06],
          [ 8.1896e-07, -7.4738e-06, -2.5203e-06,  ...,  3.1829e-06,
           -5.1000e-07, -1.6546e-06],
          [ 2.6643e-06,  3.1548e-06,  5.4138e-07,  ...,  2.6541e-06,
            2.1338e-06,  1.9508e-06],
          ...,
          [-2.6608e-06,  2.6336e-06, -4.4141e-06,  ...,  5.2570e-06,
           -3.2931e-06,  1.2501e-06],
          [-2.6554e-06,  3.1397e-06, -1.7394e-06,  ..., -2.7053e-06,
           -9.0141e-07,  3.1452e-06],
          [ 5.4442e-07,  3.0922e-07, -1.1806e-06,  ...,  1.4102e-06,
           -1.0670e-06, -2.5743e-06]]],


        [[[-1.3168e-06, -8.3377e-06,  3.9679e-06,  ..., -1.2869e-06,
           -1.3114e-06,  1.0925e-06],
          [-7.1526e-06, -1.6040e-05,  1.2895e-05,  ..., -2.8513e-07,
           -9.2848e-07,  3.8173e-06],
          [-9.2187e-06, -4.1217e-06,  8.9547e-07,  ...,  3.8958e-06,
           -7.4361e-06, -2.7331e-06],
          ...,
          [-1.8343e-07, -9.4197e-06, -4.2814e-06,  ..., -3.6212e-06,
            2.2529e-06, -1.5683e-06],
          [ 1.1088e-06,  2.7129e-06, -4.5800e-06,  ...,  2.6758e-06,
           -3.6978e-06, -1.8244e-06],
          [-4.9167e-06,  6.0045e-06, -3.7760e-06,  ..., -1.3404e-07,
            1.9758e-06, -1.0769e-06]],

         [[ 4.5329e-06, -2.8285e-06,  2.4425e-06,  ...,  1.2329e-06,
            1.9453e-07,  8.7679e-07],
          [ 2.6134e-06, -7.3990e-06,  8.1711e-06,  ...,  3.6121e-06,
            2.2652e-06,  3.2361e-06],
          [-2.5442e-06,  7.4728e-06,  1.3012e-06,  ...,  5.2628e-06,
           -7.9843e-06, -3.5974e-06],
          ...,
          [-2.9389e-06, -1.7360e-05, -1.0456e-05,  ..., -1.6519e-06,
            2.4520e-06, -1.1759e-06],
          [ 3.4436e-07,  8.5822e-07, -6.1154e-06,  ...,  4.6380e-06,
           -2.1874e-06, -9.3889e-08],
          [-7.6028e-06,  5.0707e-06, -4.4500e-06,  ...,  3.4211e-07,
            2.3246e-06, -1.6601e-06]],

         [[ 6.9568e-06,  1.0924e-06,  3.5798e-06,  ...,  1.3307e-06,
           -2.9697e-07, -2.0772e-07],
          [ 6.7794e-06, -5.4534e-06,  8.9283e-06,  ...,  3.8358e-06,
            2.7684e-06,  1.5694e-06],
          [ 1.2503e-07,  6.1354e-06, -1.5318e-07,  ...,  6.8233e-06,
           -5.3218e-06, -1.3392e-06],
          ...,
          [-1.6507e-06, -1.1520e-05, -4.3208e-06,  ..., -1.7556e-06,
            1.8321e-06, -6.9067e-07],
          [-1.3207e-06,  1.9356e-06, -1.9133e-06,  ...,  3.3169e-06,
           -3.2120e-06,  3.9523e-07],
          [-5.8014e-06,  6.1782e-06, -2.9935e-06,  ..., -7.5843e-08,
            8.6034e-07, -2.0522e-06]]],


        [[[ 3.2680e-07,  4.3634e-06,  2.2426e-06,  ..., -9.8696e-07,
            2.2967e-07, -5.4805e-07],
          [ 4.0904e-06,  9.7250e-06,  6.9659e-06,  ...,  1.0349e-06,
            1.0674e-06,  2.0384e-06],
          [-3.4943e-06, -3.6595e-06, -1.6569e-07,  ...,  3.5343e-06,
            2.8139e-06,  2.3450e-06],
          ...,
          [ 6.6830e-06, -7.3164e-07,  1.4373e-05,  ..., -1.3186e-06,
           -1.6171e-06, -1.8791e-06],
          [ 3.4642e-07, -6.2480e-06,  7.5133e-06,  ...,  2.2709e-07,
            8.2162e-06,  2.3978e-06],
          [-5.0643e-07,  4.2849e-06,  2.6100e-06,  ...,  6.1428e-06,
            5.6938e-06,  1.2317e-06]],

         [[-2.0195e-06, -4.6458e-07,  2.9471e-06,  ..., -9.2950e-07,
            3.5279e-07,  7.3866e-07],
          [ 3.5168e-07, -1.6075e-06, -3.5340e-06,  ...,  2.8262e-07,
           -1.2111e-06,  5.1872e-07],
          [-2.8478e-06, -8.2904e-06, -7.1965e-06,  ..., -4.7775e-07,
           -1.6246e-06,  6.1100e-07],
          ...,
          [ 2.7377e-06, -1.3716e-05, -4.6540e-06,  ...,  8.4202e-07,
            1.8898e-06, -5.1693e-06],
          [ 4.0216e-06, -1.0494e-05,  1.3981e-07,  ..., -3.7710e-06,
            4.7856e-06, -1.4602e-06],
          [ 5.8686e-07,  4.5665e-07, -3.4618e-07,  ..., -9.8188e-07,
           -6.8059e-10,  5.1591e-07]],

         [[-1.6739e-06,  8.3527e-07,  4.9337e-06,  ...,  9.0712e-08,
           -4.0415e-08,  1.0814e-06],
          [ 1.9172e-06,  9.8478e-07,  5.2754e-07,  ...,  1.0168e-06,
           -1.9147e-06, -4.3092e-07],
          [ 3.6497e-07, -3.0959e-06, -4.1065e-07,  ..., -2.8220e-07,
           -2.8307e-06, -1.4244e-07],
          ...,
          [ 3.8517e-06, -1.3431e-05, -1.1923e-05,  ...,  5.1140e-06,
            3.0980e-06, -1.7417e-06],
          [ 5.1304e-06, -8.2683e-06, -8.8918e-07,  ..., -5.3927e-06,
            2.2900e-06, -2.6144e-06],
          [ 3.1444e-07, -2.4901e-06, -3.6178e-06,  ..., -7.2394e-06,
           -5.1381e-06, -7.5252e-07]]]], device='cuda:0')
Inputs - grad after reset: None
Loss from FGSM Loss: 0.715618908405304
Inputs - grad after FGSM Loss: None
Traceback (most recent call last):
  File "/gpfs/home6/scur2773/uvadlc_practicals_2024/assignment3/part2/train.py", line 92, in <module>
    main(args)
  File "/gpfs/home6/scur2773/uvadlc_practicals_2024/assignment3/part2/train.py", line 32, in main
    model = train(model, trainloader, validloader, num_epochs=args.num_epochs, 
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home6/scur2773/uvadlc_practicals_2024/assignment3/part2/utils.py", line 119, in train
    loss.backward()
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Trying to backward through the graph a second time (or directly access saved tensors after they have already been freed). Saved intermediate values of the graph are freed when you call .backward() or autograd.grad(). Specify retain_graph=True if you need to backward through the graph a second time or if you need to access saved tensors after calling backward.
srun: error: gcn4: task 0: Exited with exit code 1
srun: Terminating StepId=9051693.0

JOB STATISTICS
==============
Job ID: 9051693
Cluster: snellius
User/Group: scur2773/scur2773
State: FAILED (exit code 1)
Nodes: 1
Cores per node: 9
CPU Utilized: 00:00:12
CPU Efficiency: 6.35% of 00:03:09 core-walltime
Job Wall-clock time: 00:00:21
Memory Utilized: 2.08 MB
Memory Efficiency: 0.01% of 31.25 GB
