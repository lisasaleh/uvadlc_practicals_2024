============================================================================================== 
Warning! Mixing Conda and module environments may lead to corruption of the
user environment. 
We do not recommend users mixing those two environments unless absolutely
necessary. Note that 
SURF does not provide any support for Conda environment.
For more information, please refer to our software policy page:
https://servicedesk.surf.nl/wiki/display/WIKI/Software+policy+Snellius#SoftwarepolicySnellius-UseofAnacondaandMinicondaenvironmentsonSnellius 

Remember that many packages have already been installed on the system and can
be loaded using 
the 'module load <package__name>' command. If you are uncertain if a package is
already available 
on the system, please use 'module avail' or 'module spider' to search for it.
============================================================================================== 
[rank: 0] Seed set to 0
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA A100-SXM4-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Namespace(txt_file='./assets/book_EN_grimms_fairy_tales.txt', model_type='gpt-mini', block_size=128, use_pretrained=False, abs_emb=False, train_batch_size=128, generate_batch_size=5, generate_every_n_steps=1000, learning_rate=0.0005, weight_decay=0.1, betas=(0.9, 0.95), num_epochs=5, clip_grad_norm=1.0, log_dir='./logs', seed=0, num_workers=8, progress_bar=False, use_flash_attn=False, precision='32', compile=True, pretrained_tokenizer=False, device='cuda')
data has 540241 characters, 87 unique.
True False
number of parameters: 10.73M
running on device cuda
Finding best initial lr:   0%|          | 0/100 [00:00<?, ?it/s]/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/torch/_inductor/compile_fx.py:167: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Logits before softmax and clamp: tensor([[ 0.8105,  0.2482,  0.1133, -0.4395, -0.2884, -0.1488,  0.0928,  0.2500,
          0.0032, -0.5701, -0.5696,  0.1143, -0.1613,  0.2422, -0.2610, -0.0812,
          0.3112,  0.4328, -0.2348,  0.0988, -0.2224, -0.5017, -0.3062, -0.5509,
         -0.1036, -0.1591, -0.0207,  0.1674, -0.1512, -0.2148, -0.1904,  0.1666,
          0.3858,  0.1483,  0.0537,  0.5575, -0.4850, -0.1113,  0.0217, -0.0779,
          0.0669,  0.2118,  0.0783, -0.4173,  0.2977, -0.1746, -0.7741, -0.1964,
         -0.3214,  0.0318, -0.6448,  0.4550, -0.2144, -0.4103, -0.3199,  0.1782,
         -0.0829, -0.7098,  0.3249, -0.0193,  0.1371, -0.1258, -0.2136, -0.5594,
          0.1930,  0.2993,  0.6463,  0.2753, -0.1824,  0.3502,  0.5733,  0.3875,
          0.3072,  0.1921, -0.3399,  0.0174,  0.0830,  0.1279, -0.4177,  0.0697,
         -0.1656,  0.1896,  0.5830, -0.6573,  0.2973, -0.6392, -0.1778]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.8105,  0.2482,  0.1133, -0.4395, -0.2884, -0.1488,  0.0928,  0.2500,
          0.0032, -0.5701, -0.5696,  0.1143, -0.1613,  0.2422, -0.2610, -0.0812,
          0.3112,  0.4328, -0.2348,  0.0988, -0.2224, -0.5017, -0.3062, -0.5509,
         -0.1036, -0.1591, -0.0207,  0.1674, -0.1512, -0.2148, -0.1904,  0.1666,
          0.3858,  0.1483,  0.0537,  0.5575, -0.4850, -0.1113,  0.0217, -0.0779,
          0.0669,  0.2118,  0.0783, -0.4173,  0.2977, -0.1746, -0.7741, -0.1964,
         -0.3214,  0.0318, -0.6448,  0.4550, -0.2144, -0.4103, -0.3199,  0.1782,
         -0.0829, -0.7098,  0.3249, -0.0193,  0.1371, -0.1258, -0.2136, -0.5594,
          0.1930,  0.2993,  0.6463,  0.2753, -0.1824,  0.3502,  0.5733,  0.3875,
          0.3072,  0.1921, -0.3399,  0.0174,  0.0830,  0.1279, -0.4177,  0.0697,
         -0.1656,  0.1896,  0.5830, -0.6573,  0.2973, -0.6392, -0.1778]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0253, 0.0144, 0.0126, 0.0072, 0.0084, 0.0097, 0.0123, 0.0144, 0.0113,
         0.0064, 0.0064, 0.0126, 0.0096, 0.0143, 0.0087, 0.0104, 0.0153, 0.0173,
         0.0089, 0.0124, 0.0090, 0.0068, 0.0083, 0.0065, 0.0101, 0.0096, 0.0110,
         0.0133, 0.0097, 0.0091, 0.0093, 0.0133, 0.0165, 0.0130, 0.0119, 0.0196,
         0.0069, 0.0101, 0.0115, 0.0104, 0.0120, 0.0139, 0.0122, 0.0074, 0.0151,
         0.0094, 0.0052, 0.0092, 0.0082, 0.0116, 0.0059, 0.0177, 0.0091, 0.0075,
         0.0082, 0.0134, 0.0104, 0.0055, 0.0156, 0.0110, 0.0129, 0.0099, 0.0091,
         0.0064, 0.0136, 0.0152, 0.0215, 0.0148, 0.0094, 0.0160, 0.0199, 0.0166,
         0.0153, 0.0136, 0.0080, 0.0114, 0.0122, 0.0128, 0.0074, 0.0121, 0.0095,
         0.0136, 0.0201, 0.0058, 0.0151, 0.0059, 0.0094]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 2.8002e-01,  5.4789e-01, -6.6707e-02, -3.8245e-01, -4.7189e-01,
         -3.3238e-01,  4.8660e-01, -6.5974e-01, -6.0427e-01,  3.3384e-01,
          2.2602e-01,  3.4690e-01,  6.4464e-02,  3.6875e-01, -4.6421e-01,
         -4.5021e-01, -1.4716e-01, -3.2377e-01,  2.0551e-02,  5.5414e-01,
         -1.0573e+00,  1.2101e-01,  7.8645e-02, -1.0736e-01, -5.0612e-01,
         -1.1722e-01,  1.9597e-02,  2.6775e-02,  2.8705e-01, -4.9468e-01,
         -2.2616e-01,  2.0849e-01,  4.4960e-01,  3.4452e-01,  5.0356e-02,
          5.3206e-02,  6.9097e-02,  8.4818e-02, -1.6909e-01,  1.1538e+00,
          3.1292e-02,  4.5064e-01, -8.0084e-01, -1.9139e-01,  1.3743e-01,
          3.2861e-01, -6.4984e-02, -5.6003e-01,  3.7923e-02, -3.1075e-01,
         -1.2619e-02,  4.0215e-01,  1.2677e-01, -6.9895e-02, -5.9953e-01,
          3.9513e-01, -2.4450e-01, -8.8683e-01,  4.9413e-02,  3.7288e-01,
         -3.7208e-01,  1.8962e-02,  1.7992e-01, -2.9545e-01,  1.1117e-03,
         -8.8391e-02,  7.7869e-01, -2.4069e-01,  1.3981e-01, -4.9378e-01,
          7.0138e-01, -2.9902e-01,  3.3931e-02,  4.5397e-01,  6.8466e-02,
         -7.4293e-01,  4.0158e-01,  8.3395e-01, -6.8394e-02,  3.5246e-01,
         -7.0995e-02,  3.5082e-01,  5.6174e-01, -1.2449e-01,  1.9238e-01,
         -1.0491e-01, -2.1600e-02]], device='cuda:0')
Logits before softmax and after clamp: tensor([[ 2.8002e-01,  5.4789e-01, -6.6707e-02, -3.8245e-01, -4.7189e-01,
         -3.3238e-01,  4.8660e-01, -6.5974e-01, -6.0427e-01,  3.3384e-01,
          2.2602e-01,  3.4690e-01,  6.4464e-02,  3.6875e-01, -4.6421e-01,
         -4.5021e-01, -1.4716e-01, -3.2377e-01,  2.0551e-02,  5.5414e-01,
         -1.0573e+00,  1.2101e-01,  7.8645e-02, -1.0736e-01, -5.0612e-01,
         -1.1722e-01,  1.9597e-02,  2.6775e-02,  2.8705e-01, -4.9468e-01,
         -2.2616e-01,  2.0849e-01,  4.4960e-01,  3.4452e-01,  5.0356e-02,
          5.3206e-02,  6.9097e-02,  8.4818e-02, -1.6909e-01,  1.1538e+00,
          3.1292e-02,  4.5064e-01, -8.0084e-01, -1.9139e-01,  1.3743e-01,
          3.2861e-01, -6.4984e-02, -5.6003e-01,  3.7923e-02, -3.1075e-01,
         -1.2619e-02,  4.0215e-01,  1.2677e-01, -6.9895e-02, -5.9953e-01,
          3.9513e-01, -2.4450e-01, -8.8683e-01,  4.9413e-02,  3.7288e-01,
         -3.7208e-01,  1.8962e-02,  1.7992e-01, -2.9545e-01,  1.1117e-03,
         -8.8391e-02,  7.7869e-01, -2.4069e-01,  1.3981e-01, -4.9378e-01,
          7.0138e-01, -2.9902e-01,  3.3931e-02,  4.5397e-01,  6.8466e-02,
         -7.4293e-01,  4.0158e-01,  8.3395e-01, -6.8394e-02,  3.5246e-01,
         -7.0995e-02,  3.5082e-01,  5.6174e-01, -1.2449e-01,  1.9238e-01,
         -1.0491e-01, -2.1600e-02]], device='cuda:0')
Probabilities after softmax: tensor([[0.0140, 0.0183, 0.0099, 0.0072, 0.0066, 0.0076, 0.0172, 0.0055, 0.0058,
         0.0148, 0.0133, 0.0150, 0.0113, 0.0153, 0.0067, 0.0067, 0.0091, 0.0077,
         0.0108, 0.0184, 0.0037, 0.0119, 0.0114, 0.0095, 0.0064, 0.0094, 0.0108,
         0.0109, 0.0141, 0.0065, 0.0084, 0.0130, 0.0166, 0.0149, 0.0111, 0.0112,
         0.0113, 0.0115, 0.0089, 0.0335, 0.0109, 0.0166, 0.0047, 0.0087, 0.0121,
         0.0147, 0.0099, 0.0060, 0.0110, 0.0078, 0.0104, 0.0158, 0.0120, 0.0099,
         0.0058, 0.0157, 0.0083, 0.0044, 0.0111, 0.0154, 0.0073, 0.0108, 0.0127,
         0.0079, 0.0106, 0.0097, 0.0230, 0.0083, 0.0122, 0.0065, 0.0213, 0.0078,
         0.0109, 0.0167, 0.0113, 0.0050, 0.0158, 0.0244, 0.0099, 0.0150, 0.0099,
         0.0150, 0.0186, 0.0093, 0.0128, 0.0095, 0.0104]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.8371, -0.4350, -0.1203,  0.1388,  0.2623, -0.1381,  0.1425, -0.1709,
         -0.1245, -0.0888,  0.5167, -0.0503,  0.2070, -0.6021,  0.0608, -0.1987,
         -0.3646, -0.0531, -0.1138, -0.5104, -0.0767,  0.5058, -0.1982,  0.0588,
          0.3791, -0.4993, -0.5901, -1.0961, -0.6493,  0.0908, -0.2391,  0.1073,
         -0.7489,  0.7295,  0.2596,  0.3267, -0.1047,  0.7996, -0.8613,  0.3686,
          0.4203, -0.4423,  0.5707,  0.1610,  0.3555,  0.3345, -1.0478, -0.3713,
         -0.5038,  0.0863, -0.1419, -0.4934, -0.8673,  0.3705, -0.3195, -0.6735,
         -0.2469,  0.2001,  0.3033, -0.9335,  0.0545, -0.2929, -0.3618,  0.1377,
         -0.0103,  0.7534,  0.1869,  0.5583,  0.3193,  0.4176, -0.4250, -0.1492,
         -0.4287, -0.1259, -0.3941,  0.0423,  0.3032,  0.6204, -0.5682,  0.5055,
         -0.0112, -0.2261, -0.3014,  0.0365, -0.0724, -0.0967, -0.2771]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.8371, -0.4350, -0.1203,  0.1388,  0.2623, -0.1381,  0.1425, -0.1709,
         -0.1245, -0.0888,  0.5167, -0.0503,  0.2070, -0.6021,  0.0608, -0.1987,
         -0.3646, -0.0531, -0.1138, -0.5104, -0.0767,  0.5058, -0.1982,  0.0588,
          0.3791, -0.4993, -0.5901, -1.0961, -0.6493,  0.0908, -0.2391,  0.1073,
         -0.7489,  0.7295,  0.2596,  0.3267, -0.1047,  0.7996, -0.8613,  0.3686,
          0.4203, -0.4423,  0.5707,  0.1610,  0.3555,  0.3345, -1.0478, -0.3713,
         -0.5038,  0.0863, -0.1419, -0.4934, -0.8673,  0.3705, -0.3195, -0.6735,
         -0.2469,  0.2001,  0.3033, -0.9335,  0.0545, -0.2929, -0.3618,  0.1377,
         -0.0103,  0.7534,  0.1869,  0.5583,  0.3193,  0.4176, -0.4250, -0.1492,
         -0.4287, -0.1259, -0.3941,  0.0423,  0.3032,  0.6204, -0.5682,  0.5055,
         -0.0112, -0.2261, -0.3014,  0.0365, -0.0724, -0.0967, -0.2771]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0258, 0.0072, 0.0099, 0.0128, 0.0145, 0.0097, 0.0129, 0.0094, 0.0099,
         0.0102, 0.0187, 0.0106, 0.0137, 0.0061, 0.0119, 0.0092, 0.0078, 0.0106,
         0.0100, 0.0067, 0.0103, 0.0185, 0.0092, 0.0118, 0.0163, 0.0068, 0.0062,
         0.0037, 0.0058, 0.0122, 0.0088, 0.0124, 0.0053, 0.0232, 0.0145, 0.0155,
         0.0101, 0.0249, 0.0047, 0.0161, 0.0170, 0.0072, 0.0198, 0.0131, 0.0159,
         0.0156, 0.0039, 0.0077, 0.0067, 0.0122, 0.0097, 0.0068, 0.0047, 0.0162,
         0.0081, 0.0057, 0.0087, 0.0136, 0.0151, 0.0044, 0.0118, 0.0083, 0.0078,
         0.0128, 0.0111, 0.0237, 0.0135, 0.0195, 0.0154, 0.0170, 0.0073, 0.0096,
         0.0073, 0.0098, 0.0075, 0.0117, 0.0151, 0.0208, 0.0063, 0.0185, 0.0110,
         0.0089, 0.0083, 0.0116, 0.0104, 0.0101, 0.0085]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.1059,  0.4204, -0.0871, -0.0223,  0.5913,  0.4600,  0.0750, -0.3833,
         -0.5282, -0.3295, -0.1655, -0.0531, -0.3723, -0.4410, -0.1994, -0.4021,
          0.2468,  0.9976,  0.0042,  0.1281,  0.1438,  0.0852, -0.3632, -0.1089,
         -0.6019,  0.6493,  0.4552, -0.3914, -0.3568,  0.1243, -0.6291,  0.6348,
         -0.4925,  0.2659, -0.0345, -0.0702, -0.2178,  0.1542, -0.2590, -0.3578,
          0.6005, -0.0854,  0.2678, -0.2066, -0.5568,  0.0215, -0.3391,  0.1590,
          0.2220,  0.5461,  0.2280, -0.3645, -0.0856, -0.0292, -0.1523,  0.2141,
         -0.3563, -0.0663,  0.1054, -0.0945,  0.3674,  0.2956,  0.1259, -0.3520,
          0.1927, -0.0413, -0.6210, -0.0731,  0.4858, -0.2010, -0.4369,  0.4468,
          0.3842, -0.6813,  0.0715, -0.4760,  0.0262, -0.6545,  0.1117,  0.4472,
         -0.5833, -0.4730,  0.5079, -0.4464,  0.5492, -0.6725, -0.7793]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.1059,  0.4204, -0.0871, -0.0223,  0.5913,  0.4600,  0.0750, -0.3833,
         -0.5282, -0.3295, -0.1655, -0.0531, -0.3723, -0.4410, -0.1994, -0.4021,
          0.2468,  0.9976,  0.0042,  0.1281,  0.1438,  0.0852, -0.3632, -0.1089,
         -0.6019,  0.6493,  0.4552, -0.3914, -0.3568,  0.1243, -0.6291,  0.6348,
         -0.4925,  0.2659, -0.0345, -0.0702, -0.2178,  0.1542, -0.2590, -0.3578,
          0.6005, -0.0854,  0.2678, -0.2066, -0.5568,  0.0215, -0.3391,  0.1590,
          0.2220,  0.5461,  0.2280, -0.3645, -0.0856, -0.0292, -0.1523,  0.2141,
         -0.3563, -0.0663,  0.1054, -0.0945,  0.3674,  0.2956,  0.1259, -0.3520,
          0.1927, -0.0413, -0.6210, -0.0731,  0.4858, -0.2010, -0.4369,  0.4468,
          0.3842, -0.6813,  0.0715, -0.4760,  0.0262, -0.6545,  0.1117,  0.4472,
         -0.5833, -0.4730,  0.5079, -0.4464,  0.5492, -0.6725, -0.7793]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0124, 0.0170, 0.0102, 0.0109, 0.0201, 0.0177, 0.0120, 0.0076, 0.0066,
         0.0080, 0.0094, 0.0106, 0.0077, 0.0072, 0.0091, 0.0075, 0.0143, 0.0302,
         0.0112, 0.0127, 0.0129, 0.0121, 0.0078, 0.0100, 0.0061, 0.0213, 0.0176,
         0.0075, 0.0078, 0.0126, 0.0059, 0.0210, 0.0068, 0.0145, 0.0108, 0.0104,
         0.0090, 0.0130, 0.0086, 0.0078, 0.0203, 0.0102, 0.0146, 0.0091, 0.0064,
         0.0114, 0.0079, 0.0131, 0.0139, 0.0192, 0.0140, 0.0077, 0.0102, 0.0108,
         0.0096, 0.0138, 0.0078, 0.0104, 0.0124, 0.0101, 0.0161, 0.0150, 0.0126,
         0.0078, 0.0135, 0.0107, 0.0060, 0.0104, 0.0181, 0.0091, 0.0072, 0.0174,
         0.0164, 0.0056, 0.0120, 0.0069, 0.0114, 0.0058, 0.0125, 0.0174, 0.0062,
         0.0069, 0.0185, 0.0071, 0.0193, 0.0057, 0.0051]], device='cuda:0')
Sum of probabilities per row: tensor([1.0000], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.5982,  0.3179, -0.1302, -0.7965, -0.5944,  0.1717,  0.2126, -0.5083,
          0.0463, -0.6043,  0.0543,  0.3430, -0.1288,  0.2615, -0.3374, -0.4700,
          0.3524,  0.1642, -0.2123,  0.0539, -0.3237, -0.5490,  0.0389,  0.0720,
         -0.5873, -0.3180,  0.2163, -0.0934,  0.0802, -0.0937, -0.1802, -0.0716,
         -0.8391,  0.4593,  0.7078,  0.4970, -0.5993,  0.4482, -0.3120,  0.5874,
          0.1106,  0.1752,  0.2233, -0.1584,  0.0308,  0.3950, -0.0262, -0.6809,
          0.1228,  0.1666, -0.0641,  0.2356, -0.3583, -0.1469, -0.2865, -0.1627,
         -0.3222, -0.9550, -0.3464,  0.1246,  0.3789, -0.3599, -0.3727, -0.3860,
          0.4832,  0.3874,  0.3958, -0.1239, -0.0233,  0.1329,  0.2427,  0.5799,
         -0.0297,  0.1680,  0.1450, -0.1802,  0.3256,  0.4333, -0.0354, -0.2512,
         -0.3287,  0.2266,  0.2996, -0.5896,  0.2498, -0.3854,  0.2225]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.5982,  0.3179, -0.1302, -0.7965, -0.5944,  0.1717,  0.2126, -0.5083,
          0.0463, -0.6043,  0.0543,  0.3430, -0.1288,  0.2615, -0.3374, -0.4700,
          0.3524,  0.1642, -0.2123,  0.0539, -0.3237, -0.5490,  0.0389,  0.0720,
         -0.5873, -0.3180,  0.2163, -0.0934,  0.0802, -0.0937, -0.1802, -0.0716,
         -0.8391,  0.4593,  0.7078,  0.4970, -0.5993,  0.4482, -0.3120,  0.5874,
          0.1106,  0.1752,  0.2233, -0.1584,  0.0308,  0.3950, -0.0262, -0.6809,
          0.1228,  0.1666, -0.0641,  0.2356, -0.3583, -0.1469, -0.2865, -0.1627,
         -0.3222, -0.9550, -0.3464,  0.1246,  0.3789, -0.3599, -0.3727, -0.3860,
          0.4832,  0.3874,  0.3958, -0.1239, -0.0233,  0.1329,  0.2427,  0.5799,
         -0.0297,  0.1680,  0.1450, -0.1802,  0.3256,  0.4333, -0.0354, -0.2512,
         -0.3287,  0.2266,  0.2996, -0.5896,  0.2498, -0.3854,  0.2225]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0202, 0.0152, 0.0097, 0.0050, 0.0061, 0.0132, 0.0137, 0.0067, 0.0116,
         0.0061, 0.0117, 0.0156, 0.0097, 0.0144, 0.0079, 0.0069, 0.0158, 0.0131,
         0.0090, 0.0117, 0.0080, 0.0064, 0.0115, 0.0119, 0.0062, 0.0081, 0.0138,
         0.0101, 0.0120, 0.0101, 0.0093, 0.0103, 0.0048, 0.0176, 0.0225, 0.0182,
         0.0061, 0.0174, 0.0081, 0.0199, 0.0124, 0.0132, 0.0139, 0.0095, 0.0114,
         0.0165, 0.0108, 0.0056, 0.0125, 0.0131, 0.0104, 0.0140, 0.0077, 0.0096,
         0.0083, 0.0094, 0.0080, 0.0043, 0.0078, 0.0126, 0.0162, 0.0077, 0.0076,
         0.0075, 0.0180, 0.0163, 0.0165, 0.0098, 0.0108, 0.0127, 0.0141, 0.0198,
         0.0108, 0.0131, 0.0128, 0.0093, 0.0154, 0.0171, 0.0107, 0.0086, 0.0080,
         0.0139, 0.0150, 0.0061, 0.0142, 0.0075, 0.0139]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.5293, -0.3280,  0.3551, -0.4330, -0.0907, -0.0739,  0.3556, -0.4806,
         -0.0358,  0.0846, -0.0351,  0.1131, -0.1929, -0.4329,  0.0674, -1.0566,
         -0.4907,  0.5761,  0.4809, -0.4987, -0.2166, -0.4750, -0.3618, -0.1107,
         -0.8267, -0.0217,  0.0991, -0.2940, -0.3927, -0.6058, -0.3584, -0.2813,
         -0.5047,  0.6569, -0.4417, -0.0450, -0.2032,  0.4794, -0.4062,  1.0199,
          0.2724, -0.2458, -0.9941, -0.1609, -0.3032, -0.2190, -0.2946, -0.0596,
          0.0966,  0.2436,  0.6503, -0.0040,  0.2623,  0.2742, -0.1343,  0.0825,
         -0.0734, -0.8412,  0.4371, -0.6269,  0.0857,  0.0257, -0.5933, -0.2291,
          0.1101,  0.1865, -0.2054,  0.1673,  0.5241, -0.5246, -0.2273,  0.1725,
          0.2854, -0.0933, -0.1129,  0.2587,  0.0204,  0.2465, -0.1532, -0.1014,
         -0.1766,  0.2409, -0.1770,  0.1384, -0.6605,  0.0553, -0.1618]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.5293, -0.3280,  0.3551, -0.4330, -0.0907, -0.0739,  0.3556, -0.4806,
         -0.0358,  0.0846, -0.0351,  0.1131, -0.1929, -0.4329,  0.0674, -1.0566,
         -0.4907,  0.5761,  0.4809, -0.4987, -0.2166, -0.4750, -0.3618, -0.1107,
         -0.8267, -0.0217,  0.0991, -0.2940, -0.3927, -0.6058, -0.3584, -0.2813,
         -0.5047,  0.6569, -0.4417, -0.0450, -0.2032,  0.4794, -0.4062,  1.0199,
          0.2724, -0.2458, -0.9941, -0.1609, -0.3032, -0.2190, -0.2946, -0.0596,
          0.0966,  0.2436,  0.6503, -0.0040,  0.2623,  0.2742, -0.1343,  0.0825,
         -0.0734, -0.8412,  0.4371, -0.6269,  0.0857,  0.0257, -0.5933, -0.2291,
          0.1101,  0.1865, -0.2054,  0.1673,  0.5241, -0.5246, -0.2273,  0.1725,
          0.2854, -0.0933, -0.1129,  0.2587,  0.0204,  0.2465, -0.1532, -0.1014,
         -0.1766,  0.2409, -0.1770,  0.1384, -0.6605,  0.0553, -0.1618]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0198, 0.0084, 0.0166, 0.0076, 0.0106, 0.0108, 0.0166, 0.0072, 0.0112,
         0.0127, 0.0112, 0.0130, 0.0096, 0.0076, 0.0125, 0.0040, 0.0071, 0.0207,
         0.0188, 0.0071, 0.0094, 0.0072, 0.0081, 0.0104, 0.0051, 0.0114, 0.0129,
         0.0087, 0.0079, 0.0064, 0.0081, 0.0088, 0.0070, 0.0225, 0.0075, 0.0111,
         0.0095, 0.0188, 0.0078, 0.0323, 0.0153, 0.0091, 0.0043, 0.0099, 0.0086,
         0.0094, 0.0087, 0.0110, 0.0128, 0.0149, 0.0223, 0.0116, 0.0151, 0.0153,
         0.0102, 0.0126, 0.0108, 0.0050, 0.0180, 0.0062, 0.0127, 0.0119, 0.0064,
         0.0093, 0.0130, 0.0140, 0.0095, 0.0138, 0.0197, 0.0069, 0.0093, 0.0138,
         0.0155, 0.0106, 0.0104, 0.0151, 0.0119, 0.0149, 0.0100, 0.0105, 0.0098,
         0.0148, 0.0098, 0.0134, 0.0060, 0.0123, 0.0099]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.4196, -0.0169,  0.4898, -0.0493, -0.0923,  0.0188,  0.2358, -0.4845,
         -0.0163, -0.5974,  0.4402, -0.1826, -0.0871,  0.1503, -0.2091, -0.1203,
         -0.1964,  0.1086, -0.9508, -0.4215, -0.2874, -0.0190,  0.2537, -0.1526,
         -0.5017,  0.6803,  0.2507, -0.6295, -0.2342,  0.1482, -0.3761, -0.4649,
         -0.4332,  0.4148,  0.1152,  0.2411, -0.3578,  0.4235, -1.1139,  0.8757,
          0.9410,  0.1610, -0.2251, -0.5605, -0.1818,  0.3468, -0.2982,  0.0213,
         -0.2149, -0.4899,  0.2437, -0.4789, -0.1439,  0.3844, -0.6921,  0.2670,
         -0.2103, -0.6308,  0.1346, -0.1148,  0.3485,  0.0623, -0.4332,  0.0082,
         -0.2625,  0.0464, -0.2912,  0.0920,  0.1377, -0.1518, -0.5644,  0.0070,
         -0.1943,  0.1001, -0.2911, -0.1097,  0.4367, -0.0633, -0.0569,  0.1411,
          0.0487,  0.1740,  0.1289, -0.4355,  0.2878, -0.7495,  0.3629]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.4196, -0.0169,  0.4898, -0.0493, -0.0923,  0.0188,  0.2358, -0.4845,
         -0.0163, -0.5974,  0.4402, -0.1826, -0.0871,  0.1503, -0.2091, -0.1203,
         -0.1964,  0.1086, -0.9508, -0.4215, -0.2874, -0.0190,  0.2537, -0.1526,
         -0.5017,  0.6803,  0.2507, -0.6295, -0.2342,  0.1482, -0.3761, -0.4649,
         -0.4332,  0.4148,  0.1152,  0.2411, -0.3578,  0.4235, -1.1139,  0.8757,
          0.9410,  0.1610, -0.2251, -0.5605, -0.1818,  0.3468, -0.2982,  0.0213,
         -0.2149, -0.4899,  0.2437, -0.4789, -0.1439,  0.3844, -0.6921,  0.2670,
         -0.2103, -0.6308,  0.1346, -0.1148,  0.3485,  0.0623, -0.4332,  0.0082,
         -0.2625,  0.0464, -0.2912,  0.0920,  0.1377, -0.1518, -0.5644,  0.0070,
         -0.1943,  0.1001, -0.2911, -0.1097,  0.4367, -0.0633, -0.0569,  0.1411,
          0.0487,  0.1740,  0.1289, -0.4355,  0.2878, -0.7495,  0.3629]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0174, 0.0113, 0.0187, 0.0109, 0.0104, 0.0117, 0.0145, 0.0070, 0.0113,
         0.0063, 0.0178, 0.0095, 0.0105, 0.0133, 0.0093, 0.0101, 0.0094, 0.0128,
         0.0044, 0.0075, 0.0086, 0.0112, 0.0147, 0.0098, 0.0069, 0.0226, 0.0147,
         0.0061, 0.0091, 0.0133, 0.0079, 0.0072, 0.0074, 0.0173, 0.0128, 0.0146,
         0.0080, 0.0175, 0.0038, 0.0275, 0.0293, 0.0134, 0.0091, 0.0065, 0.0095,
         0.0162, 0.0085, 0.0117, 0.0092, 0.0070, 0.0146, 0.0071, 0.0099, 0.0168,
         0.0057, 0.0149, 0.0093, 0.0061, 0.0131, 0.0102, 0.0162, 0.0122, 0.0074,
         0.0115, 0.0088, 0.0120, 0.0086, 0.0125, 0.0131, 0.0098, 0.0065, 0.0115,
         0.0094, 0.0126, 0.0086, 0.0103, 0.0177, 0.0107, 0.0108, 0.0132, 0.0120,
         0.0136, 0.0130, 0.0074, 0.0153, 0.0054, 0.0164]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.0882, -0.3607,  0.2138, -0.2238,  0.8242,  0.2122,  0.3614, -0.1232,
         -0.5046, -0.3817,  0.7220,  1.0241, -0.4126,  0.2517, -0.5131, -0.9059,
         -0.0147,  0.2053, -0.2083, -0.2697, -0.6288,  0.0883, -0.6477, -0.3637,
         -0.4762, -0.0419,  0.2472, -0.8501,  0.4870, -0.3198, -0.0053,  0.5284,
         -0.3154, -0.4213,  0.1522,  0.2256,  0.1894,  0.6477, -0.1419,  0.7160,
          0.4280,  0.1555, -0.2712, -0.4135,  0.2740,  0.1668,  0.2005, -0.6031,
         -0.0609,  0.4744, -0.3849,  0.4070, -0.1257,  0.1849, -0.0795,  0.1894,
         -0.1914,  0.1604,  0.1000, -0.8775,  0.2330, -0.0713, -0.3150, -0.3477,
         -0.1761,  0.2078,  0.0496, -0.4656,  0.2824,  0.4434, -0.4312, -0.1721,
         -0.1229,  0.0401, -0.0741, -0.6541,  0.3125,  0.6669, -0.1658, -0.4399,
          0.0468, -0.2967,  0.2869,  0.3324,  0.5901, -0.4967,  0.7278]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.0882, -0.3607,  0.2138, -0.2238,  0.8242,  0.2122,  0.3614, -0.1232,
         -0.5046, -0.3817,  0.7220,  1.0241, -0.4126,  0.2517, -0.5131, -0.9059,
         -0.0147,  0.2053, -0.2083, -0.2697, -0.6288,  0.0883, -0.6477, -0.3637,
         -0.4762, -0.0419,  0.2472, -0.8501,  0.4870, -0.3198, -0.0053,  0.5284,
         -0.3154, -0.4213,  0.1522,  0.2256,  0.1894,  0.6477, -0.1419,  0.7160,
          0.4280,  0.1555, -0.2712, -0.4135,  0.2740,  0.1668,  0.2005, -0.6031,
         -0.0609,  0.4744, -0.3849,  0.4070, -0.1257,  0.1849, -0.0795,  0.1894,
         -0.1914,  0.1604,  0.1000, -0.8775,  0.2330, -0.0713, -0.3150, -0.3477,
         -0.1761,  0.2078,  0.0496, -0.4656,  0.2824,  0.4434, -0.4312, -0.1721,
         -0.1229,  0.0401, -0.0741, -0.6541,  0.3125,  0.6669, -0.1658, -0.4399,
          0.0468, -0.2967,  0.2869,  0.3324,  0.5901, -0.4967,  0.7278]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0117, 0.0075, 0.0133, 0.0086, 0.0244, 0.0132, 0.0154, 0.0095, 0.0065,
         0.0073, 0.0221, 0.0298, 0.0071, 0.0138, 0.0064, 0.0043, 0.0106, 0.0132,
         0.0087, 0.0082, 0.0057, 0.0117, 0.0056, 0.0074, 0.0067, 0.0103, 0.0137,
         0.0046, 0.0174, 0.0078, 0.0107, 0.0182, 0.0078, 0.0070, 0.0125, 0.0134,
         0.0129, 0.0205, 0.0093, 0.0219, 0.0164, 0.0125, 0.0082, 0.0071, 0.0141,
         0.0127, 0.0131, 0.0059, 0.0101, 0.0172, 0.0073, 0.0161, 0.0094, 0.0129,
         0.0099, 0.0129, 0.0088, 0.0126, 0.0118, 0.0045, 0.0135, 0.0100, 0.0078,
         0.0076, 0.0090, 0.0132, 0.0113, 0.0067, 0.0142, 0.0167, 0.0070, 0.0090,
         0.0095, 0.0112, 0.0099, 0.0056, 0.0146, 0.0209, 0.0091, 0.0069, 0.0112,
         0.0080, 0.0143, 0.0149, 0.0193, 0.0065, 0.0222]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.8263,  0.5038,  0.3565, -1.1717, -0.1760,  0.1094, -0.0655, -0.5467,
          0.0428, -0.0485,  0.2690,  0.4369,  0.0904,  0.1847, -0.3908, -1.0476,
          0.0522, -0.0114, -0.1171,  0.6127,  0.1479, -0.0764, -0.3400,  0.3441,
         -0.3888, -0.1614, -0.0271,  0.2651, -0.3731, -0.4615, -0.4317,  0.0632,
         -0.3937,  0.3188,  0.6835,  0.1572, -0.2554, -0.0289,  0.1371,  0.2426,
          0.2879, -0.5085,  0.0616, -0.0502,  0.1651,  0.1102, -0.4191,  0.1152,
         -0.3280, -0.1059,  0.0260,  0.2142, -0.5704,  0.1966,  0.2564, -0.1349,
         -0.2228, -0.0318,  0.1184, -0.0563,  0.0703, -0.3984, -0.4320, -0.4672,
          0.5872,  0.3424,  0.2357,  0.0429, -0.1772, -0.0903,  0.0558, -0.1160,
          0.1919,  0.2606, -0.0092,  0.0228,  0.5044,  0.3176, -0.5240,  0.2777,
          0.1740,  0.0616,  0.1940, -0.2246,  0.3640, -0.0680,  0.6793]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.8263,  0.5038,  0.3565, -1.1717, -0.1760,  0.1094, -0.0655, -0.5467,
          0.0428, -0.0485,  0.2690,  0.4369,  0.0904,  0.1847, -0.3908, -1.0476,
          0.0522, -0.0114, -0.1171,  0.6127,  0.1479, -0.0764, -0.3400,  0.3441,
         -0.3888, -0.1614, -0.0271,  0.2651, -0.3731, -0.4615, -0.4317,  0.0632,
         -0.3937,  0.3188,  0.6835,  0.1572, -0.2554, -0.0289,  0.1371,  0.2426,
          0.2879, -0.5085,  0.0616, -0.0502,  0.1651,  0.1102, -0.4191,  0.1152,
         -0.3280, -0.1059,  0.0260,  0.2142, -0.5704,  0.1966,  0.2564, -0.1349,
         -0.2228, -0.0318,  0.1184, -0.0563,  0.0703, -0.3984, -0.4320, -0.4672,
          0.5872,  0.3424,  0.2357,  0.0429, -0.1772, -0.0903,  0.0558, -0.1160,
          0.1919,  0.2606, -0.0092,  0.0228,  0.5044,  0.3176, -0.5240,  0.2777,
          0.1740,  0.0616,  0.1940, -0.2246,  0.3640, -0.0680,  0.6793]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0247, 0.0179, 0.0154, 0.0033, 0.0091, 0.0121, 0.0101, 0.0063, 0.0113,
         0.0103, 0.0141, 0.0167, 0.0118, 0.0130, 0.0073, 0.0038, 0.0114, 0.0107,
         0.0096, 0.0199, 0.0125, 0.0100, 0.0077, 0.0152, 0.0073, 0.0092, 0.0105,
         0.0141, 0.0074, 0.0068, 0.0070, 0.0115, 0.0073, 0.0149, 0.0214, 0.0126,
         0.0084, 0.0105, 0.0124, 0.0138, 0.0144, 0.0065, 0.0115, 0.0103, 0.0127,
         0.0121, 0.0071, 0.0121, 0.0078, 0.0097, 0.0111, 0.0134, 0.0061, 0.0132,
         0.0140, 0.0094, 0.0086, 0.0105, 0.0122, 0.0102, 0.0116, 0.0073, 0.0070,
         0.0068, 0.0194, 0.0152, 0.0137, 0.0113, 0.0091, 0.0099, 0.0114, 0.0096,
         0.0131, 0.0140, 0.0107, 0.0111, 0.0179, 0.0148, 0.0064, 0.0143, 0.0129,
         0.0115, 0.0131, 0.0086, 0.0156, 0.0101, 0.0213]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.4572,  0.0757,  0.1249,  0.0794,  0.0873,  0.0172,  0.1135, -0.1534,
          0.1680, -0.7389,  0.1652,  0.6341, -0.0301, -0.1006, -0.9112, -0.9173,
         -0.4404,  0.9134, -0.4431,  0.5590, -0.3181, -0.0017, -0.0567,  0.2051,
         -0.1893, -0.2942, -0.3024, -0.4441, -0.0149,  0.0391,  0.3606,  0.6224,
         -1.2392,  0.0173,  0.0505,  0.3368, -0.1098,  1.0047, -0.4505, -0.2772,
          0.9691,  0.0047, -0.1924, -0.2190, -0.1924,  0.2927, -0.0527, -0.7302,
         -0.2102, -0.0424, -0.4694,  0.2594, -0.1694,  0.4553, -0.6466, -0.2229,
         -0.4827, -0.1770,  0.6195, -0.4697, -0.2648,  0.3228,  0.5995, -0.2331,
          0.5371,  0.3078,  0.1009, -0.1619,  0.2004, -0.5042,  0.2907,  0.3514,
          0.1369,  0.3429,  0.4104, -0.0954,  0.6522,  0.5408, -0.5224,  0.2341,
         -0.3090, -0.2865,  0.1272, -0.3818,  0.8208, -0.8778,  0.0488]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.4572,  0.0757,  0.1249,  0.0794,  0.0873,  0.0172,  0.1135, -0.1534,
          0.1680, -0.7389,  0.1652,  0.6341, -0.0301, -0.1006, -0.9112, -0.9173,
         -0.4404,  0.9134, -0.4431,  0.5590, -0.3181, -0.0017, -0.0567,  0.2051,
         -0.1893, -0.2942, -0.3024, -0.4441, -0.0149,  0.0391,  0.3606,  0.6224,
         -1.2392,  0.0173,  0.0505,  0.3368, -0.1098,  1.0047, -0.4505, -0.2772,
          0.9691,  0.0047, -0.1924, -0.2190, -0.1924,  0.2927, -0.0527, -0.7302,
         -0.2102, -0.0424, -0.4694,  0.2594, -0.1694,  0.4553, -0.6466, -0.2229,
         -0.4827, -0.1770,  0.6195, -0.4697, -0.2648,  0.3228,  0.5995, -0.2331,
          0.5371,  0.3078,  0.1009, -0.1619,  0.2004, -0.5042,  0.2907,  0.3514,
          0.1369,  0.3429,  0.4104, -0.0954,  0.6522,  0.5408, -0.5224,  0.2341,
         -0.3090, -0.2865,  0.1272, -0.3818,  0.8208, -0.8778,  0.0488]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0166, 0.0114, 0.0119, 0.0114, 0.0115, 0.0107, 0.0118, 0.0090, 0.0125,
         0.0050, 0.0124, 0.0199, 0.0102, 0.0095, 0.0042, 0.0042, 0.0068, 0.0263,
         0.0068, 0.0184, 0.0077, 0.0105, 0.0099, 0.0129, 0.0087, 0.0078, 0.0078,
         0.0068, 0.0104, 0.0110, 0.0151, 0.0196, 0.0030, 0.0107, 0.0111, 0.0147,
         0.0094, 0.0288, 0.0067, 0.0080, 0.0278, 0.0106, 0.0087, 0.0085, 0.0087,
         0.0141, 0.0100, 0.0051, 0.0085, 0.0101, 0.0066, 0.0136, 0.0089, 0.0166,
         0.0055, 0.0084, 0.0065, 0.0088, 0.0196, 0.0066, 0.0081, 0.0145, 0.0192,
         0.0083, 0.0180, 0.0143, 0.0116, 0.0090, 0.0129, 0.0064, 0.0141, 0.0150,
         0.0121, 0.0148, 0.0159, 0.0096, 0.0202, 0.0181, 0.0062, 0.0133, 0.0077,
         0.0079, 0.0120, 0.0072, 0.0239, 0.0044, 0.0111]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.1174, -0.4832,  0.4540, -0.5447,  0.3064,  0.2616,  0.4658,  0.1769,
          0.1447, -0.1924, -0.1151, -0.1179,  0.5554,  0.0468, -0.1637, -0.8486,
         -0.0933, -0.0765, -0.1945,  0.3231, -0.4754,  0.1660, -0.2056, -0.3380,
         -0.8220, -0.0977, -0.1506,  0.0761,  0.1335,  0.4785,  0.0420,  0.8850,
          0.2047,  0.2241,  0.3004, -0.2084,  0.5453,  0.2247,  0.1191, -0.0208,
         -0.0426,  0.5676,  0.3622,  0.1548, -0.1908,  0.2865, -0.5459, -0.3651,
          0.3619, -0.4418,  0.3610,  0.5508, -0.4586,  0.3184, -0.1847, -0.0011,
         -0.5904,  0.2676,  0.1975,  0.3048, -1.0090, -0.2201,  0.1195,  0.0286,
         -0.1407, -0.3105,  0.2733,  0.0347,  0.3389, -0.5952, -0.0248,  0.9653,
         -0.1438,  0.3284, -0.5079, -0.0110,  0.2508,  0.4343,  0.0463,  0.5406,
          0.4858, -0.0861,  0.2570, -0.1180,  0.6731, -1.0033,  0.2312]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.1174, -0.4832,  0.4540, -0.5447,  0.3064,  0.2616,  0.4658,  0.1769,
          0.1447, -0.1924, -0.1151, -0.1179,  0.5554,  0.0468, -0.1637, -0.8486,
         -0.0933, -0.0765, -0.1945,  0.3231, -0.4754,  0.1660, -0.2056, -0.3380,
         -0.8220, -0.0977, -0.1506,  0.0761,  0.1335,  0.4785,  0.0420,  0.8850,
          0.2047,  0.2241,  0.3004, -0.2084,  0.5453,  0.2247,  0.1191, -0.0208,
         -0.0426,  0.5676,  0.3622,  0.1548, -0.1908,  0.2865, -0.5459, -0.3651,
          0.3619, -0.4418,  0.3610,  0.5508, -0.4586,  0.3184, -0.1847, -0.0011,
         -0.5904,  0.2676,  0.1975,  0.3048, -1.0090, -0.2201,  0.1195,  0.0286,
         -0.1407, -0.3105,  0.2733,  0.0347,  0.3389, -0.5952, -0.0248,  0.9653,
         -0.1438,  0.3284, -0.5079, -0.0110,  0.2508,  0.4343,  0.0463,  0.5406,
          0.4858, -0.0861,  0.2570, -0.1180,  0.6731, -1.0033,  0.2312]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0116, 0.0064, 0.0163, 0.0060, 0.0141, 0.0134, 0.0165, 0.0124, 0.0120,
         0.0085, 0.0092, 0.0092, 0.0180, 0.0108, 0.0088, 0.0044, 0.0094, 0.0096,
         0.0085, 0.0143, 0.0064, 0.0122, 0.0084, 0.0074, 0.0045, 0.0094, 0.0089,
         0.0112, 0.0118, 0.0167, 0.0108, 0.0251, 0.0127, 0.0129, 0.0140, 0.0084,
         0.0179, 0.0130, 0.0117, 0.0101, 0.0099, 0.0183, 0.0149, 0.0121, 0.0086,
         0.0138, 0.0060, 0.0072, 0.0149, 0.0067, 0.0148, 0.0180, 0.0065, 0.0142,
         0.0086, 0.0103, 0.0057, 0.0135, 0.0126, 0.0140, 0.0038, 0.0083, 0.0117,
         0.0106, 0.0090, 0.0076, 0.0136, 0.0107, 0.0145, 0.0057, 0.0101, 0.0272,
         0.0090, 0.0144, 0.0062, 0.0102, 0.0133, 0.0160, 0.0108, 0.0178, 0.0168,
         0.0095, 0.0134, 0.0092, 0.0203, 0.0038, 0.0130]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.5442, -0.4113,  0.4042, -0.0600, -0.0212,  0.0947,  0.0086,  0.2233,
         -0.1332,  0.1505, -0.2939,  0.2530,  0.2214,  0.2190, -0.2210, -0.4286,
         -0.5261, -0.0133, -0.0607, -0.0924, -0.5481, -0.1495, -0.0600, -0.4370,
          0.4662,  0.0412, -0.2303, -0.4233, -0.0235,  0.4915,  0.3886, -0.7203,
         -0.1258,  0.2393, -0.2728,  0.0356, -0.0935,  0.6401, -0.5610,  0.2640,
          0.2076, -0.0677, -0.3585,  0.1390, -0.0084, -0.2073, -0.1278, -0.9362,
         -0.3586,  0.5172, -0.1849, -0.5806, -0.3976, -0.3504,  0.3562, -0.2295,
          0.0598, -0.0909,  0.3786, -0.2411,  0.2678, -0.3365,  0.0514, -0.4370,
          0.0363,  0.2190,  0.2033, -0.6389,  0.0542, -0.1986, -0.5045,  0.2743,
          0.0403,  0.2795,  0.2004, -0.8024, -0.0641, -0.2014,  0.2005,  0.1177,
         -0.5772,  0.6279, -0.3522, -0.1053, -0.1522, -0.7177,  0.6214]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.5442, -0.4113,  0.4042, -0.0600, -0.0212,  0.0947,  0.0086,  0.2233,
         -0.1332,  0.1505, -0.2939,  0.2530,  0.2214,  0.2190, -0.2210, -0.4286,
         -0.5261, -0.0133, -0.0607, -0.0924, -0.5481, -0.1495, -0.0600, -0.4370,
          0.4662,  0.0412, -0.2303, -0.4233, -0.0235,  0.4915,  0.3886, -0.7203,
         -0.1258,  0.2393, -0.2728,  0.0356, -0.0935,  0.6401, -0.5610,  0.2640,
          0.2076, -0.0677, -0.3585,  0.1390, -0.0084, -0.2073, -0.1278, -0.9362,
         -0.3586,  0.5172, -0.1849, -0.5806, -0.3976, -0.3504,  0.3562, -0.2295,
          0.0598, -0.0909,  0.3786, -0.2411,  0.2678, -0.3365,  0.0514, -0.4370,
          0.0363,  0.2190,  0.2033, -0.6389,  0.0542, -0.1986, -0.5045,  0.2743,
          0.0403,  0.2795,  0.2004, -0.8024, -0.0641, -0.2014,  0.2005,  0.1177,
         -0.5772,  0.6279, -0.3522, -0.1053, -0.1522, -0.7177,  0.6214]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0199, 0.0077, 0.0173, 0.0109, 0.0113, 0.0127, 0.0117, 0.0144, 0.0101,
         0.0134, 0.0086, 0.0149, 0.0144, 0.0144, 0.0093, 0.0075, 0.0068, 0.0114,
         0.0109, 0.0105, 0.0067, 0.0100, 0.0109, 0.0075, 0.0184, 0.0120, 0.0092,
         0.0076, 0.0113, 0.0189, 0.0170, 0.0056, 0.0102, 0.0147, 0.0088, 0.0120,
         0.0105, 0.0219, 0.0066, 0.0150, 0.0142, 0.0108, 0.0081, 0.0133, 0.0115,
         0.0094, 0.0102, 0.0045, 0.0081, 0.0194, 0.0096, 0.0065, 0.0078, 0.0081,
         0.0165, 0.0092, 0.0123, 0.0106, 0.0169, 0.0091, 0.0151, 0.0083, 0.0122,
         0.0075, 0.0120, 0.0144, 0.0142, 0.0061, 0.0122, 0.0095, 0.0070, 0.0152,
         0.0120, 0.0153, 0.0141, 0.0052, 0.0108, 0.0094, 0.0141, 0.0130, 0.0065,
         0.0217, 0.0081, 0.0104, 0.0099, 0.0056, 0.0215]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 3.7928e-01,  4.6109e-01,  2.7011e-01, -1.0448e+00, -5.0115e-01,
          1.5729e-01, -1.0933e-01, -6.6826e-01, -4.3564e-01,  2.3590e-03,
          5.0653e-01,  3.5622e-01,  2.0589e-01,  3.2480e-01, -1.0494e-01,
         -5.2791e-01,  3.3188e-01, -4.5211e-02,  1.1635e-01,  6.1676e-02,
         -2.3238e-01, -3.5127e-02, -5.9228e-01,  2.2874e-01, -3.2755e-01,
          7.7143e-02, -2.1076e-01, -4.7638e-02, -3.6307e-01, -9.8347e-01,
         -5.6164e-01, -1.2578e-01,  7.0266e-02, -8.3107e-02,  8.0140e-01,
          1.0227e-01, -5.5979e-02, -1.9560e-01,  5.4227e-01,  2.0843e-01,
          1.5604e-01, -2.9558e-02, -6.1429e-02, -2.2572e-01,  5.8741e-02,
          1.1115e-01, -2.0111e-01, -7.3743e-02, -2.5706e-01, -3.9020e-01,
          5.2259e-01, -2.0861e-01, -2.6416e-01,  6.1430e-02,  3.2901e-01,
         -2.5028e-01,  2.9186e-02, -3.2822e-01, -8.7200e-02, -2.8203e-01,
          7.5372e-02, -5.5340e-01, -2.3307e-01, -3.5834e-01,  5.2107e-01,
          1.2574e-01,  3.0753e-01,  3.3083e-01, -3.7404e-01, -2.3823e-01,
          2.5062e-01,  2.0209e-01,  3.1340e-01, -4.1931e-02, -4.4078e-02,
         -2.2951e-01,  7.4944e-01,  3.1055e-01, -7.3999e-03,  3.8398e-02,
          2.0705e-01,  9.2065e-02,  2.7502e-01, -1.4987e-01, -6.5321e-04,
         -2.5461e-01,  7.0930e-01]], device='cuda:0')
Logits before softmax and after clamp: tensor([[ 3.7928e-01,  4.6109e-01,  2.7011e-01, -1.0448e+00, -5.0115e-01,
          1.5729e-01, -1.0933e-01, -6.6826e-01, -4.3564e-01,  2.3590e-03,
          5.0653e-01,  3.5622e-01,  2.0589e-01,  3.2480e-01, -1.0494e-01,
         -5.2791e-01,  3.3188e-01, -4.5211e-02,  1.1635e-01,  6.1676e-02,
         -2.3238e-01, -3.5127e-02, -5.9228e-01,  2.2874e-01, -3.2755e-01,
          7.7143e-02, -2.1076e-01, -4.7638e-02, -3.6307e-01, -9.8347e-01,
         -5.6164e-01, -1.2578e-01,  7.0266e-02, -8.3107e-02,  8.0140e-01,
          1.0227e-01, -5.5979e-02, -1.9560e-01,  5.4227e-01,  2.0843e-01,
          1.5604e-01, -2.9558e-02, -6.1429e-02, -2.2572e-01,  5.8741e-02,
          1.1115e-01, -2.0111e-01, -7.3743e-02, -2.5706e-01, -3.9020e-01,
          5.2259e-01, -2.0861e-01, -2.6416e-01,  6.1430e-02,  3.2901e-01,
         -2.5028e-01,  2.9186e-02, -3.2822e-01, -8.7200e-02, -2.8203e-01,
          7.5372e-02, -5.5340e-01, -2.3307e-01, -3.5834e-01,  5.2107e-01,
          1.2574e-01,  3.0753e-01,  3.3083e-01, -3.7404e-01, -2.3823e-01,
          2.5062e-01,  2.0209e-01,  3.1340e-01, -4.1931e-02, -4.4078e-02,
         -2.2951e-01,  7.4944e-01,  3.1055e-01, -7.3999e-03,  3.8398e-02,
          2.0705e-01,  9.2065e-02,  2.7502e-01, -1.4987e-01, -6.5321e-04,
         -2.5461e-01,  7.0930e-01]], device='cuda:0')
Probabilities after softmax: tensor([[0.0161, 0.0175, 0.0144, 0.0039, 0.0067, 0.0129, 0.0099, 0.0056, 0.0071,
         0.0110, 0.0183, 0.0157, 0.0135, 0.0152, 0.0099, 0.0065, 0.0154, 0.0105,
         0.0124, 0.0117, 0.0087, 0.0106, 0.0061, 0.0139, 0.0079, 0.0119, 0.0089,
         0.0105, 0.0077, 0.0041, 0.0063, 0.0097, 0.0118, 0.0101, 0.0246, 0.0122,
         0.0104, 0.0091, 0.0190, 0.0136, 0.0129, 0.0107, 0.0104, 0.0088, 0.0117,
         0.0123, 0.0090, 0.0102, 0.0085, 0.0075, 0.0186, 0.0089, 0.0085, 0.0117,
         0.0153, 0.0086, 0.0113, 0.0079, 0.0101, 0.0083, 0.0119, 0.0063, 0.0087,
         0.0077, 0.0186, 0.0125, 0.0150, 0.0153, 0.0076, 0.0087, 0.0142, 0.0135,
         0.0151, 0.0106, 0.0105, 0.0088, 0.0233, 0.0150, 0.0109, 0.0115, 0.0136,
         0.0121, 0.0145, 0.0095, 0.0110, 0.0085, 0.0224]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.5646,  0.3920, -0.0981,  0.2160,  1.0517,  0.3207,  0.0420, -0.0320,
         -0.1097, -0.4028,  0.0325,  0.1914,  0.0275, -0.1950, -0.6947, -0.5893,
          0.0980, -0.2943,  0.0220,  0.1158, -0.3104, -0.2505,  0.3255, -0.0707,
         -0.2476, -0.5331, -0.1288,  0.1413,  0.6407, -0.4370,  0.0258,  0.8118,
         -0.4375, -0.1351,  0.5375, -0.0453,  0.1602,  0.5079,  0.2439, -0.4231,
         -0.6002, -0.0623,  0.3752,  0.0068,  0.6924,  0.0484,  0.0414,  0.3893,
         -0.3205, -0.0575, -0.3747,  0.6404, -0.2267, -0.2372, -0.0045, -0.0265,
         -0.4397, -0.0529, -0.4221,  0.2218, -0.2070,  0.0767,  0.1124, -0.2124,
          0.3575,  0.0033,  0.3693, -0.3954, -0.2656, -0.0657, -0.0529,  0.2592,
         -0.1894,  0.3250, -0.5775, -0.0678,  0.2615,  0.2640, -0.1111, -0.0295,
         -0.0796,  0.3253,  0.2914,  0.4859,  0.5804, -0.3704, -0.1030]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.5646,  0.3920, -0.0981,  0.2160,  1.0517,  0.3207,  0.0420, -0.0320,
         -0.1097, -0.4028,  0.0325,  0.1914,  0.0275, -0.1950, -0.6947, -0.5893,
          0.0980, -0.2943,  0.0220,  0.1158, -0.3104, -0.2505,  0.3255, -0.0707,
         -0.2476, -0.5331, -0.1288,  0.1413,  0.6407, -0.4370,  0.0258,  0.8118,
         -0.4375, -0.1351,  0.5375, -0.0453,  0.1602,  0.5079,  0.2439, -0.4231,
         -0.6002, -0.0623,  0.3752,  0.0068,  0.6924,  0.0484,  0.0414,  0.3893,
         -0.3205, -0.0575, -0.3747,  0.6404, -0.2267, -0.2372, -0.0045, -0.0265,
         -0.4397, -0.0529, -0.4221,  0.2218, -0.2070,  0.0767,  0.1124, -0.2124,
          0.3575,  0.0033,  0.3693, -0.3954, -0.2656, -0.0657, -0.0529,  0.2592,
         -0.1894,  0.3250, -0.5775, -0.0678,  0.2615,  0.2640, -0.1111, -0.0295,
         -0.0796,  0.3253,  0.2914,  0.4859,  0.5804, -0.3704, -0.1030]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0186, 0.0157, 0.0096, 0.0132, 0.0304, 0.0146, 0.0111, 0.0103, 0.0095,
         0.0071, 0.0110, 0.0128, 0.0109, 0.0087, 0.0053, 0.0059, 0.0117, 0.0079,
         0.0108, 0.0119, 0.0078, 0.0083, 0.0147, 0.0099, 0.0083, 0.0062, 0.0093,
         0.0122, 0.0201, 0.0068, 0.0109, 0.0239, 0.0068, 0.0093, 0.0181, 0.0101,
         0.0124, 0.0176, 0.0135, 0.0069, 0.0058, 0.0100, 0.0154, 0.0107, 0.0212,
         0.0111, 0.0111, 0.0156, 0.0077, 0.0100, 0.0073, 0.0201, 0.0085, 0.0084,
         0.0106, 0.0103, 0.0068, 0.0101, 0.0070, 0.0132, 0.0086, 0.0114, 0.0119,
         0.0086, 0.0152, 0.0106, 0.0153, 0.0071, 0.0081, 0.0099, 0.0101, 0.0137,
         0.0088, 0.0147, 0.0060, 0.0099, 0.0138, 0.0138, 0.0095, 0.0103, 0.0098,
         0.0147, 0.0142, 0.0172, 0.0189, 0.0073, 0.0096]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.2068, -0.5563, -0.2496, -0.3469, -0.2447,  0.6327,  0.2944, -0.4012,
         -0.8901, -0.6810,  0.5242, -0.0912,  0.3105, -0.2992, -0.5330, -0.2900,
         -0.1191,  0.7531, -0.2611, -0.1327, -0.5578,  0.2044, -0.4234, -0.2082,
         -0.2341, -0.6246, -0.0448,  0.1444, -0.1871,  0.1681,  0.2802, -0.0153,
          0.4106,  0.3737, -0.0453, -0.6854, -0.0852,  0.3754, -0.7055,  0.4967,
          0.1857,  0.2592,  0.6170,  0.5717,  0.1817,  0.1949, -0.4587, -0.2918,
         -0.4163,  0.1459,  0.0789,  0.4302, -0.2788,  0.5995, -0.4627, -0.1162,
         -0.0511, -0.1830, -0.0683, -0.0265,  0.4832, -0.0611,  0.2471, -0.3965,
         -0.0645,  0.0981, -0.4494, -0.7035,  0.0932,  0.2071, -0.7001,  0.2562,
         -0.7010, -0.3663, -0.2668, -0.4855,  0.1803, -0.2326,  0.6327,  0.0169,
         -0.2580, -0.2749,  1.0223,  0.1242,  0.2980, -0.8699,  0.1629]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.2068, -0.5563, -0.2496, -0.3469, -0.2447,  0.6327,  0.2944, -0.4012,
         -0.8901, -0.6810,  0.5242, -0.0912,  0.3105, -0.2992, -0.5330, -0.2900,
         -0.1191,  0.7531, -0.2611, -0.1327, -0.5578,  0.2044, -0.4234, -0.2082,
         -0.2341, -0.6246, -0.0448,  0.1444, -0.1871,  0.1681,  0.2802, -0.0153,
          0.4106,  0.3737, -0.0453, -0.6854, -0.0852,  0.3754, -0.7055,  0.4967,
          0.1857,  0.2592,  0.6170,  0.5717,  0.1817,  0.1949, -0.4587, -0.2918,
         -0.4163,  0.1459,  0.0789,  0.4302, -0.2788,  0.5995, -0.4627, -0.1162,
         -0.0511, -0.1830, -0.0683, -0.0265,  0.4832, -0.0611,  0.2471, -0.3965,
         -0.0645,  0.0981, -0.4494, -0.7035,  0.0932,  0.2071, -0.7001,  0.2562,
         -0.7010, -0.3663, -0.2668, -0.4855,  0.1803, -0.2326,  0.6327,  0.0169,
         -0.2580, -0.2749,  1.0223,  0.1242,  0.2980, -0.8699,  0.1629]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0138, 0.0064, 0.0087, 0.0079, 0.0088, 0.0211, 0.0150, 0.0075, 0.0046,
         0.0057, 0.0189, 0.0102, 0.0153, 0.0083, 0.0066, 0.0084, 0.0099, 0.0238,
         0.0086, 0.0098, 0.0064, 0.0137, 0.0073, 0.0091, 0.0089, 0.0060, 0.0107,
         0.0129, 0.0093, 0.0132, 0.0148, 0.0110, 0.0169, 0.0163, 0.0107, 0.0056,
         0.0103, 0.0163, 0.0055, 0.0184, 0.0135, 0.0145, 0.0207, 0.0198, 0.0134,
         0.0136, 0.0071, 0.0084, 0.0074, 0.0130, 0.0121, 0.0172, 0.0085, 0.0204,
         0.0070, 0.0100, 0.0106, 0.0093, 0.0105, 0.0109, 0.0181, 0.0105, 0.0143,
         0.0075, 0.0105, 0.0123, 0.0071, 0.0055, 0.0123, 0.0138, 0.0056, 0.0145,
         0.0056, 0.0078, 0.0086, 0.0069, 0.0134, 0.0089, 0.0211, 0.0114, 0.0086,
         0.0085, 0.0311, 0.0127, 0.0151, 0.0047, 0.0132]], device='cuda:0')
Sum of probabilities per row: tensor([1.0000], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.0083, -0.1892,  0.0678,  0.1501,  0.3181, -0.2960, -0.3243,  0.2681,
         -0.1904, -0.4074,  0.5161,  0.3238, -0.0771,  0.3844,  0.2880,  0.1226,
          0.4050, -0.3639,  0.0360, -0.0077, -0.2150,  0.2630, -0.0153, -0.7720,
         -0.3489, -0.1908,  0.2336, -0.6299,  0.5464, -0.3986, -0.2062,  0.0038,
         -0.2731,  0.0275,  0.0073, -0.5111,  0.7251, -0.0667, -0.0475,  0.4462,
          0.2515,  0.2672,  0.1706, -0.2941,  0.3101,  0.5798, -0.4708,  0.5910,
         -0.1571, -0.6502,  0.2047, -0.2204, -0.5131,  0.4049,  0.1425,  0.3075,
          0.0847, -0.4573,  0.2888, -0.4147,  0.0907, -0.0783, -0.1404,  0.1134,
          0.1326, -0.1630,  0.2677, -0.0627,  0.2778,  0.1624,  0.2789,  0.4097,
          0.6125,  0.1535,  0.1596, -0.0449,  0.4924, -0.1966, -0.2821, -0.4339,
         -0.5822, -0.0076, -0.2237, -0.1186, -0.2590, -0.4206,  0.0303]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.0083, -0.1892,  0.0678,  0.1501,  0.3181, -0.2960, -0.3243,  0.2681,
         -0.1904, -0.4074,  0.5161,  0.3238, -0.0771,  0.3844,  0.2880,  0.1226,
          0.4050, -0.3639,  0.0360, -0.0077, -0.2150,  0.2630, -0.0153, -0.7720,
         -0.3489, -0.1908,  0.2336, -0.6299,  0.5464, -0.3986, -0.2062,  0.0038,
         -0.2731,  0.0275,  0.0073, -0.5111,  0.7251, -0.0667, -0.0475,  0.4462,
          0.2515,  0.2672,  0.1706, -0.2941,  0.3101,  0.5798, -0.4708,  0.5910,
         -0.1571, -0.6502,  0.2047, -0.2204, -0.5131,  0.4049,  0.1425,  0.3075,
          0.0847, -0.4573,  0.2888, -0.4147,  0.0907, -0.0783, -0.1404,  0.1134,
          0.1326, -0.1630,  0.2677, -0.0627,  0.2778,  0.1624,  0.2789,  0.4097,
          0.6125,  0.1535,  0.1596, -0.0449,  0.4924, -0.1966, -0.2821, -0.4339,
         -0.5822, -0.0076, -0.2237, -0.1186, -0.2590, -0.4206,  0.0303]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0110, 0.0090, 0.0116, 0.0126, 0.0149, 0.0081, 0.0079, 0.0142, 0.0090,
         0.0072, 0.0182, 0.0150, 0.0101, 0.0160, 0.0145, 0.0123, 0.0163, 0.0076,
         0.0113, 0.0108, 0.0088, 0.0141, 0.0107, 0.0050, 0.0077, 0.0090, 0.0137,
         0.0058, 0.0188, 0.0073, 0.0088, 0.0109, 0.0083, 0.0112, 0.0110, 0.0065,
         0.0225, 0.0102, 0.0104, 0.0170, 0.0140, 0.0142, 0.0129, 0.0081, 0.0148,
         0.0194, 0.0068, 0.0196, 0.0093, 0.0057, 0.0133, 0.0087, 0.0065, 0.0163,
         0.0125, 0.0148, 0.0118, 0.0069, 0.0145, 0.0072, 0.0119, 0.0101, 0.0094,
         0.0122, 0.0124, 0.0092, 0.0142, 0.0102, 0.0144, 0.0128, 0.0144, 0.0164,
         0.0201, 0.0127, 0.0128, 0.0104, 0.0178, 0.0089, 0.0082, 0.0070, 0.0061,
         0.0108, 0.0087, 0.0097, 0.0084, 0.0071, 0.0112]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.4587, -0.5903, -0.2823, -0.7116, -0.5662,  0.0358, -0.5878,  0.3237,
         -0.0287, -1.1039,  0.3342, -0.0574, -0.2192, -0.4379, -0.0361, -0.0597,
         -0.1334,  0.9425, -0.3344, -1.0244,  0.0050,  0.0966, -0.4504, -0.1586,
         -0.0241,  0.3499, -0.4067, -0.1388,  0.2255, -0.6993, -0.1220, -0.2175,
         -0.8342,  0.0078,  0.0031, -0.0930, -0.0737,  0.1460, -0.1709,  0.4030,
          0.4827,  0.1273,  0.1590,  0.1176, -0.4331,  0.0755,  0.3366, -0.0900,
         -0.3846,  0.3256, -0.1326,  0.0327, -0.1278,  0.2444, -0.4276, -0.5777,
          0.0973, -0.3252, -0.0512,  0.5597,  0.8368,  0.1587, -0.3135, -0.1623,
          0.0026,  0.0196, -0.2049, -0.3460,  0.3692, -0.1060, -0.1067,  0.3928,
          0.0912,  0.4995, -0.0515, -0.5214,  0.3618, -0.1392, -0.5208,  0.2672,
         -0.2387,  0.2497, -0.0726,  0.2600, -0.3172, -0.8649,  0.3578]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.4587, -0.5903, -0.2823, -0.7116, -0.5662,  0.0358, -0.5878,  0.3237,
         -0.0287, -1.1039,  0.3342, -0.0574, -0.2192, -0.4379, -0.0361, -0.0597,
         -0.1334,  0.9425, -0.3344, -1.0244,  0.0050,  0.0966, -0.4504, -0.1586,
         -0.0241,  0.3499, -0.4067, -0.1388,  0.2255, -0.6993, -0.1220, -0.2175,
         -0.8342,  0.0078,  0.0031, -0.0930, -0.0737,  0.1460, -0.1709,  0.4030,
          0.4827,  0.1273,  0.1590,  0.1176, -0.4331,  0.0755,  0.3366, -0.0900,
         -0.3846,  0.3256, -0.1326,  0.0327, -0.1278,  0.2444, -0.4276, -0.5777,
          0.0973, -0.3252, -0.0512,  0.5597,  0.8368,  0.1587, -0.3135, -0.1623,
          0.0026,  0.0196, -0.2049, -0.3460,  0.3692, -0.1060, -0.1067,  0.3928,
          0.0912,  0.4995, -0.0515, -0.5214,  0.3618, -0.1392, -0.5208,  0.2672,
         -0.2387,  0.2497, -0.0726,  0.2600, -0.3172, -0.8649,  0.3578]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0182, 0.0064, 0.0087, 0.0057, 0.0065, 0.0119, 0.0064, 0.0159, 0.0112,
         0.0038, 0.0161, 0.0109, 0.0092, 0.0074, 0.0111, 0.0108, 0.0101, 0.0295,
         0.0082, 0.0041, 0.0116, 0.0127, 0.0073, 0.0098, 0.0112, 0.0163, 0.0077,
         0.0100, 0.0144, 0.0057, 0.0102, 0.0093, 0.0050, 0.0116, 0.0115, 0.0105,
         0.0107, 0.0133, 0.0097, 0.0172, 0.0187, 0.0131, 0.0135, 0.0130, 0.0075,
         0.0124, 0.0161, 0.0105, 0.0078, 0.0159, 0.0101, 0.0119, 0.0101, 0.0147,
         0.0075, 0.0065, 0.0127, 0.0083, 0.0109, 0.0202, 0.0266, 0.0135, 0.0084,
         0.0098, 0.0115, 0.0117, 0.0094, 0.0081, 0.0167, 0.0104, 0.0103, 0.0171,
         0.0126, 0.0190, 0.0109, 0.0068, 0.0165, 0.0100, 0.0068, 0.0150, 0.0091,
         0.0148, 0.0107, 0.0149, 0.0084, 0.0048, 0.0165]], device='cuda:0')
Sum of probabilities per row: tensor([1.0000], device='cuda:0')
Logits before softmax and clamp: tensor([[-0.0348, -0.9196,  0.0808,  0.5434, -0.6625,  0.7008,  0.1665, -0.6509,
         -0.3696, -0.1447,  0.7139,  0.9924, -0.2162,  0.3330,  0.2758, -0.4832,
          0.3624,  0.4611, -0.2321,  0.3340,  0.1091,  0.7477,  0.1033,  0.1295,
         -0.4270,  0.1445, -0.4402, -0.3360,  0.0535, -1.1868, -0.1915,  0.0642,
         -0.2210,  0.3629, -0.0123,  0.0566,  0.3728, -0.3454,  0.0759, -0.2871,
         -0.1124,  0.0152,  0.1783, -0.3285,  0.2064, -0.2465, -0.0266, -0.9991,
         -0.0572,  0.2706, -0.2926,  0.2163,  0.1260,  0.2200,  0.1923, -0.1743,
          0.0621,  0.1164,  0.1023, -0.1493, -0.1170, -0.8591,  0.3789, -0.1338,
         -0.1564,  0.0702, -0.1564, -0.0863,  0.8733,  0.3378,  0.2212,  0.7898,
          0.3150, -0.5929, -0.3526, -0.4245, -0.3690,  0.5548, -1.1211,  1.1332,
         -0.6217, -0.1918,  0.1878,  0.3375,  0.6857, -0.7994,  0.3912]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[-0.0348, -0.9196,  0.0808,  0.5434, -0.6625,  0.7008,  0.1665, -0.6509,
         -0.3696, -0.1447,  0.7139,  0.9924, -0.2162,  0.3330,  0.2758, -0.4832,
          0.3624,  0.4611, -0.2321,  0.3340,  0.1091,  0.7477,  0.1033,  0.1295,
         -0.4270,  0.1445, -0.4402, -0.3360,  0.0535, -1.1868, -0.1915,  0.0642,
         -0.2210,  0.3629, -0.0123,  0.0566,  0.3728, -0.3454,  0.0759, -0.2871,
         -0.1124,  0.0152,  0.1783, -0.3285,  0.2064, -0.2465, -0.0266, -0.9991,
         -0.0572,  0.2706, -0.2926,  0.2163,  0.1260,  0.2200,  0.1923, -0.1743,
          0.0621,  0.1164,  0.1023, -0.1493, -0.1170, -0.8591,  0.3789, -0.1338,
         -0.1564,  0.0702, -0.1564, -0.0863,  0.8733,  0.3378,  0.2212,  0.7898,
          0.3150, -0.5929, -0.3526, -0.4245, -0.3690,  0.5548, -1.1211,  1.1332,
         -0.6217, -0.1918,  0.1878,  0.3375,  0.6857, -0.7994,  0.3912]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0101, 0.0042, 0.0113, 0.0180, 0.0054, 0.0210, 0.0123, 0.0054, 0.0072,
         0.0090, 0.0213, 0.0281, 0.0084, 0.0146, 0.0137, 0.0064, 0.0150, 0.0165,
         0.0083, 0.0146, 0.0116, 0.0220, 0.0116, 0.0119, 0.0068, 0.0121, 0.0067,
         0.0075, 0.0110, 0.0032, 0.0086, 0.0111, 0.0084, 0.0150, 0.0103, 0.0110,
         0.0151, 0.0074, 0.0113, 0.0078, 0.0093, 0.0106, 0.0125, 0.0075, 0.0128,
         0.0082, 0.0102, 0.0038, 0.0099, 0.0137, 0.0078, 0.0130, 0.0118, 0.0130,
         0.0126, 0.0088, 0.0111, 0.0117, 0.0116, 0.0090, 0.0093, 0.0044, 0.0152,
         0.0091, 0.0089, 0.0112, 0.0089, 0.0096, 0.0250, 0.0146, 0.0130, 0.0230,
         0.0143, 0.0058, 0.0073, 0.0068, 0.0072, 0.0182, 0.0034, 0.0324, 0.0056,
         0.0086, 0.0126, 0.0146, 0.0207, 0.0047, 0.0154]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.1257, -0.1900, -0.2987,  0.1957,  0.2510,  0.6447, -0.2235, -0.4785,
         -0.0070, -1.3307, -0.2434, -0.0542,  0.6429, -0.3563, -0.1076, -0.9517,
         -0.0664,  0.5707, -0.3229,  0.0051, -0.4851,  0.3102, -0.2083,  0.0954,
          0.0060,  0.2944, -0.6287, -0.5592, -0.4367, -0.4506, -0.4508,  0.4161,
         -0.5774, -0.1178,  0.3054, -0.1704, -0.1434,  0.2978,  0.3729, -0.7418,
         -0.0115,  0.4398,  0.3200, -0.3069,  0.0367,  0.5891, -0.5742, -0.4121,
          0.3760,  0.3468, -0.2760,  0.2261, -0.2514, -0.4510, -0.0562, -0.0694,
         -0.1593, -0.3365,  0.2156, -0.5760,  0.0120, -0.2612,  0.2822, -0.3533,
          0.3266,  0.4010, -0.3465, -0.2164,  0.0608,  0.5944,  0.3682,  0.3935,
         -0.2378,  0.0587,  0.1514,  0.0377,  0.4804,  0.4092, -0.0227,  0.8545,
         -0.3915, -0.4738,  0.9494, -0.0908,  0.6649, -0.9561,  0.4298]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.1257, -0.1900, -0.2987,  0.1957,  0.2510,  0.6447, -0.2235, -0.4785,
         -0.0070, -1.3307, -0.2434, -0.0542,  0.6429, -0.3563, -0.1076, -0.9517,
         -0.0664,  0.5707, -0.3229,  0.0051, -0.4851,  0.3102, -0.2083,  0.0954,
          0.0060,  0.2944, -0.6287, -0.5592, -0.4367, -0.4506, -0.4508,  0.4161,
         -0.5774, -0.1178,  0.3054, -0.1704, -0.1434,  0.2978,  0.3729, -0.7418,
         -0.0115,  0.4398,  0.3200, -0.3069,  0.0367,  0.5891, -0.5742, -0.4121,
          0.3760,  0.3468, -0.2760,  0.2261, -0.2514, -0.4510, -0.0562, -0.0694,
         -0.1593, -0.3365,  0.2156, -0.5760,  0.0120, -0.2612,  0.2822, -0.3533,
          0.3266,  0.4010, -0.3465, -0.2164,  0.0608,  0.5944,  0.3682,  0.3935,
         -0.2378,  0.0587,  0.1514,  0.0377,  0.4804,  0.4092, -0.0227,  0.8545,
         -0.3915, -0.4738,  0.9494, -0.0908,  0.6649, -0.9561,  0.4298]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0123, 0.0090, 0.0081, 0.0132, 0.0140, 0.0207, 0.0087, 0.0067, 0.0108,
         0.0029, 0.0085, 0.0103, 0.0207, 0.0076, 0.0098, 0.0042, 0.0102, 0.0193,
         0.0079, 0.0109, 0.0067, 0.0148, 0.0088, 0.0120, 0.0110, 0.0146, 0.0058,
         0.0062, 0.0070, 0.0069, 0.0069, 0.0165, 0.0061, 0.0097, 0.0148, 0.0092,
         0.0094, 0.0147, 0.0158, 0.0052, 0.0108, 0.0169, 0.0150, 0.0080, 0.0113,
         0.0196, 0.0061, 0.0072, 0.0159, 0.0154, 0.0083, 0.0137, 0.0085, 0.0069,
         0.0103, 0.0102, 0.0093, 0.0078, 0.0135, 0.0061, 0.0110, 0.0084, 0.0144,
         0.0076, 0.0151, 0.0163, 0.0077, 0.0088, 0.0116, 0.0197, 0.0157, 0.0161,
         0.0086, 0.0115, 0.0127, 0.0113, 0.0176, 0.0164, 0.0106, 0.0256, 0.0074,
         0.0068, 0.0281, 0.0099, 0.0212, 0.0042, 0.0167]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.5228, -0.2326, -0.2461, -0.1204,  0.3244,  0.3805, -0.1366,  0.1166,
         -0.5883, -0.5710, -0.0980, -0.2466, -0.2264, -0.1964, -0.2028, -0.6943,
         -0.0076,  0.5849, -0.2114, -0.2180, -0.6514, -0.3822, -0.2000, -0.4977,
         -0.4435, -0.4162,  0.3898,  0.4939, -0.2015,  0.7356, -0.1662, -0.1458,
         -0.4933,  0.3642,  0.4717, -0.0690, -0.3595, -0.0976, -0.4295, -0.0863,
          1.0669, -0.2551,  0.3143,  0.4452, -0.3402, -0.1644, -0.3427,  0.1874,
         -0.0801,  0.2936,  0.2977, -0.8609, -0.1840, -0.0254, -0.4724, -0.4608,
         -0.2339, -0.1888, -0.2080,  0.0347,  0.0291,  0.4111,  0.4751, -0.1728,
          0.3986,  0.1898,  0.1104, -0.0483,  0.2683, -0.1011,  0.1558,  0.1541,
         -0.5403,  0.5114,  0.6275, -0.4141, -0.1099,  0.1029,  0.1391,  0.0755,
         -0.4685,  0.0948, -0.2084, -0.1218, -0.2184,  0.1056, -0.0797]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.5228, -0.2326, -0.2461, -0.1204,  0.3244,  0.3805, -0.1366,  0.1166,
         -0.5883, -0.5710, -0.0980, -0.2466, -0.2264, -0.1964, -0.2028, -0.6943,
         -0.0076,  0.5849, -0.2114, -0.2180, -0.6514, -0.3822, -0.2000, -0.4977,
         -0.4435, -0.4162,  0.3898,  0.4939, -0.2015,  0.7356, -0.1662, -0.1458,
         -0.4933,  0.3642,  0.4717, -0.0690, -0.3595, -0.0976, -0.4295, -0.0863,
          1.0669, -0.2551,  0.3143,  0.4452, -0.3402, -0.1644, -0.3427,  0.1874,
         -0.0801,  0.2936,  0.2977, -0.8609, -0.1840, -0.0254, -0.4724, -0.4608,
         -0.2339, -0.1888, -0.2080,  0.0347,  0.0291,  0.4111,  0.4751, -0.1728,
          0.3986,  0.1898,  0.1104, -0.0483,  0.2683, -0.1011,  0.1558,  0.1541,
         -0.5403,  0.5114,  0.6275, -0.4141, -0.1099,  0.1029,  0.1391,  0.0755,
         -0.4685,  0.0948, -0.2084, -0.1218, -0.2184,  0.1056, -0.0797]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0190, 0.0089, 0.0088, 0.0100, 0.0156, 0.0165, 0.0098, 0.0127, 0.0063,
         0.0064, 0.0102, 0.0088, 0.0090, 0.0093, 0.0092, 0.0056, 0.0112, 0.0202,
         0.0091, 0.0091, 0.0059, 0.0077, 0.0092, 0.0068, 0.0072, 0.0074, 0.0166,
         0.0185, 0.0092, 0.0235, 0.0095, 0.0097, 0.0069, 0.0162, 0.0181, 0.0105,
         0.0079, 0.0102, 0.0073, 0.0103, 0.0327, 0.0087, 0.0154, 0.0176, 0.0080,
         0.0096, 0.0080, 0.0136, 0.0104, 0.0151, 0.0152, 0.0048, 0.0094, 0.0110,
         0.0070, 0.0071, 0.0089, 0.0093, 0.0091, 0.0117, 0.0116, 0.0170, 0.0181,
         0.0095, 0.0168, 0.0136, 0.0126, 0.0107, 0.0147, 0.0102, 0.0132, 0.0131,
         0.0066, 0.0188, 0.0211, 0.0074, 0.0101, 0.0125, 0.0129, 0.0121, 0.0071,
         0.0124, 0.0091, 0.0100, 0.0091, 0.0125, 0.0104]], device='cuda:0')
Sum of probabilities per row: tensor([1.0000], device='cuda:0')
Logits before softmax and clamp: tensor([[-0.6226, -0.7442,  0.1657,  0.0332,  1.1750,  0.0892,  0.3244,  0.1712,
         -0.0616, -0.7253, -0.5217, -0.8862,  0.5152,  0.0132, -0.6914, -0.8242,
         -0.7836, -0.1810, -0.9916, -0.1494, -0.7668, -0.5016,  0.1706, -0.9551,
         -0.6267,  0.4177, -0.2179, -0.0074, -0.0026,  0.1257,  0.1460,  0.1585,
          0.1145, -0.0657,  0.1322,  0.2327,  0.0896, -0.2309, -0.1500,  0.0357,
          0.3457,  0.0506,  0.6471,  0.1688, -0.2701,  0.1999, -0.3486, -0.6580,
          0.7634,  0.2005, -0.0673,  0.7578,  0.0296, -0.4294, -0.4116, -0.0139,
         -0.0366,  0.3725,  0.6387, -0.3861,  0.1336,  0.2905, -0.2102, -0.1716,
         -0.2497, -0.0143, -0.1533, -0.2195, -0.1611,  0.1723, -0.9431,  0.4259,
         -0.5879, -0.0790, -0.0304, -0.3435, -0.0402,  0.6134, -0.1197, -0.1582,
         -0.1046, -0.4504, -0.1058, -0.2599,  0.3085, -0.6338,  0.1235]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[-0.6226, -0.7442,  0.1657,  0.0332,  1.1750,  0.0892,  0.3244,  0.1712,
         -0.0616, -0.7253, -0.5217, -0.8862,  0.5152,  0.0132, -0.6914, -0.8242,
         -0.7836, -0.1810, -0.9916, -0.1494, -0.7668, -0.5016,  0.1706, -0.9551,
         -0.6267,  0.4177, -0.2179, -0.0074, -0.0026,  0.1257,  0.1460,  0.1585,
          0.1145, -0.0657,  0.1322,  0.2327,  0.0896, -0.2309, -0.1500,  0.0357,
          0.3457,  0.0506,  0.6471,  0.1688, -0.2701,  0.1999, -0.3486, -0.6580,
          0.7634,  0.2005, -0.0673,  0.7578,  0.0296, -0.4294, -0.4116, -0.0139,
         -0.0366,  0.3725,  0.6387, -0.3861,  0.1336,  0.2905, -0.2102, -0.1716,
         -0.2497, -0.0143, -0.1533, -0.2195, -0.1611,  0.1723, -0.9431,  0.4259,
         -0.5879, -0.0790, -0.0304, -0.3435, -0.0402,  0.6134, -0.1197, -0.1582,
         -0.1046, -0.4504, -0.1058, -0.2599,  0.3085, -0.6338,  0.1235]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0062, 0.0055, 0.0136, 0.0119, 0.0373, 0.0126, 0.0159, 0.0137, 0.0108,
         0.0056, 0.0068, 0.0047, 0.0193, 0.0117, 0.0058, 0.0050, 0.0053, 0.0096,
         0.0043, 0.0099, 0.0053, 0.0070, 0.0137, 0.0044, 0.0062, 0.0175, 0.0093,
         0.0114, 0.0115, 0.0131, 0.0133, 0.0135, 0.0129, 0.0108, 0.0131, 0.0145,
         0.0126, 0.0091, 0.0099, 0.0119, 0.0163, 0.0121, 0.0220, 0.0136, 0.0088,
         0.0141, 0.0081, 0.0060, 0.0247, 0.0141, 0.0108, 0.0246, 0.0119, 0.0075,
         0.0076, 0.0114, 0.0111, 0.0167, 0.0218, 0.0078, 0.0132, 0.0154, 0.0093,
         0.0097, 0.0090, 0.0113, 0.0099, 0.0092, 0.0098, 0.0137, 0.0045, 0.0176,
         0.0064, 0.0106, 0.0112, 0.0082, 0.0111, 0.0213, 0.0102, 0.0098, 0.0104,
         0.0073, 0.0104, 0.0089, 0.0157, 0.0061, 0.0130]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 1.1253, -0.0172, -0.3335,  0.1635,  0.0549,  0.4416, -0.1508, -0.3482,
          0.3968, -0.1687, -0.2158,  0.6536,  0.1094, -0.0549, -0.5976, -0.3674,
          0.2914,  0.2732, -0.3469, -0.3182, -0.0756, -0.1729, -0.2212,  0.2276,
         -0.2863,  0.1944,  0.0118,  0.3799,  0.1210, -0.4121, -0.1319, -0.0445,
          0.0332,  0.2520, -0.1024, -0.0654,  0.5118,  0.0199, -0.7501, -0.5642,
         -0.8139, -0.7754,  0.1073, -0.3459,  0.3160,  0.7945, -0.2574,  0.9366,
          0.4364, -0.2435, -0.2171, -0.0227, -0.3208,  0.7510,  0.0901,  0.0725,
         -0.3657,  0.2509,  0.0989,  0.4399, -0.2706, -0.2077,  0.6548,  0.3327,
         -0.0805,  0.1124, -0.0793, -0.2248, -0.2831,  1.0628, -0.1543,  0.3908,
          0.0965, -0.1256, -0.0438, -0.4412, -0.0352, -0.6415, -0.0659,  0.2259,
         -0.0901, -0.4180,  0.9834, -0.2836,  0.9756, -0.0042,  0.4790]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 1.1253, -0.0172, -0.3335,  0.1635,  0.0549,  0.4416, -0.1508, -0.3482,
          0.3968, -0.1687, -0.2158,  0.6536,  0.1094, -0.0549, -0.5976, -0.3674,
          0.2914,  0.2732, -0.3469, -0.3182, -0.0756, -0.1729, -0.2212,  0.2276,
         -0.2863,  0.1944,  0.0118,  0.3799,  0.1210, -0.4121, -0.1319, -0.0445,
          0.0332,  0.2520, -0.1024, -0.0654,  0.5118,  0.0199, -0.7501, -0.5642,
         -0.8139, -0.7754,  0.1073, -0.3459,  0.3160,  0.7945, -0.2574,  0.9366,
          0.4364, -0.2435, -0.2171, -0.0227, -0.3208,  0.7510,  0.0901,  0.0725,
         -0.3657,  0.2509,  0.0989,  0.4399, -0.2706, -0.2077,  0.6548,  0.3327,
         -0.0805,  0.1124, -0.0793, -0.2248, -0.2831,  1.0628, -0.1543,  0.3908,
          0.0965, -0.1256, -0.0438, -0.4412, -0.0352, -0.6415, -0.0659,  0.2259,
         -0.0901, -0.4180,  0.9834, -0.2836,  0.9756, -0.0042,  0.4790]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0315, 0.0100, 0.0073, 0.0120, 0.0108, 0.0159, 0.0088, 0.0072, 0.0152,
         0.0086, 0.0082, 0.0196, 0.0114, 0.0097, 0.0056, 0.0071, 0.0137, 0.0134,
         0.0072, 0.0074, 0.0095, 0.0086, 0.0082, 0.0128, 0.0077, 0.0124, 0.0103,
         0.0149, 0.0115, 0.0068, 0.0089, 0.0098, 0.0106, 0.0131, 0.0092, 0.0096,
         0.0170, 0.0104, 0.0048, 0.0058, 0.0045, 0.0047, 0.0114, 0.0072, 0.0140,
         0.0226, 0.0079, 0.0261, 0.0158, 0.0080, 0.0082, 0.0100, 0.0074, 0.0216,
         0.0112, 0.0110, 0.0071, 0.0131, 0.0113, 0.0159, 0.0078, 0.0083, 0.0197,
         0.0142, 0.0094, 0.0114, 0.0094, 0.0082, 0.0077, 0.0296, 0.0088, 0.0151,
         0.0112, 0.0090, 0.0098, 0.0066, 0.0099, 0.0054, 0.0096, 0.0128, 0.0093,
         0.0067, 0.0273, 0.0077, 0.0271, 0.0102, 0.0165]], device='cuda:0')
Sum of probabilities per row: tensor([1.0000], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.1386, -0.1233, -0.0270,  0.7907,  0.4259,  0.0617, -0.1106,  0.0171,
         -0.1976,  0.3523, -0.5146,  0.3190, -0.3394,  0.2145, -0.3360,  0.2965,
          0.5227,  0.1441, -0.6886, -0.1550, -0.2135,  0.3981, -0.3876,  0.1340,
          0.3347,  0.0743, -0.0825, -0.2282,  0.6982,  0.3204,  0.3918,  0.2323,
          0.3129, -0.4694, -0.1511, -0.2191,  0.1574,  0.1839, -0.2735, -0.6502,
          0.2989, -0.3247, -0.1003, -0.5791,  0.6077,  0.1762,  0.3847,  0.2231,
         -0.7466, -0.1611,  0.0512, -0.4907, -0.1883,  0.4963,  0.2752, -0.2048,
         -0.6750,  0.3578, -0.1550,  0.2155,  0.3533,  0.3126,  0.0524, -0.2213,
         -0.0085, -0.6429, -1.4313, -0.2095,  0.5628, -0.5494, -0.9051,  0.3978,
         -0.3080, -0.0744, -0.2317, -1.1240,  0.1298,  0.2605,  0.3648,  0.5553,
         -0.6212, -0.1226,  0.6313,  0.3440,  1.1837, -0.1146, -0.3080]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.1386, -0.1233, -0.0270,  0.7907,  0.4259,  0.0617, -0.1106,  0.0171,
         -0.1976,  0.3523, -0.5146,  0.3190, -0.3394,  0.2145, -0.3360,  0.2965,
          0.5227,  0.1441, -0.6886, -0.1550, -0.2135,  0.3981, -0.3876,  0.1340,
          0.3347,  0.0743, -0.0825, -0.2282,  0.6982,  0.3204,  0.3918,  0.2323,
          0.3129, -0.4694, -0.1511, -0.2191,  0.1574,  0.1839, -0.2735, -0.6502,
          0.2989, -0.3247, -0.1003, -0.5791,  0.6077,  0.1762,  0.3847,  0.2231,
         -0.7466, -0.1611,  0.0512, -0.4907, -0.1883,  0.4963,  0.2752, -0.2048,
         -0.6750,  0.3578, -0.1550,  0.2155,  0.3533,  0.3126,  0.0524, -0.2213,
         -0.0085, -0.6429, -1.4313, -0.2095,  0.5628, -0.5494, -0.9051,  0.3978,
         -0.3080, -0.0744, -0.2317, -1.1240,  0.1298,  0.2605,  0.3648,  0.5553,
         -0.6212, -0.1226,  0.6313,  0.3440,  1.1837, -0.1146, -0.3080]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0122, 0.0094, 0.0103, 0.0234, 0.0162, 0.0113, 0.0095, 0.0108, 0.0087,
         0.0151, 0.0063, 0.0146, 0.0076, 0.0131, 0.0076, 0.0143, 0.0179, 0.0123,
         0.0053, 0.0091, 0.0086, 0.0158, 0.0072, 0.0121, 0.0148, 0.0114, 0.0098,
         0.0084, 0.0213, 0.0146, 0.0157, 0.0134, 0.0145, 0.0066, 0.0091, 0.0085,
         0.0124, 0.0128, 0.0081, 0.0055, 0.0143, 0.0077, 0.0096, 0.0059, 0.0195,
         0.0127, 0.0156, 0.0133, 0.0050, 0.0090, 0.0112, 0.0065, 0.0088, 0.0174,
         0.0140, 0.0086, 0.0054, 0.0152, 0.0091, 0.0132, 0.0151, 0.0145, 0.0112,
         0.0085, 0.0105, 0.0056, 0.0025, 0.0086, 0.0186, 0.0061, 0.0043, 0.0158,
         0.0078, 0.0098, 0.0084, 0.0034, 0.0121, 0.0138, 0.0153, 0.0185, 0.0057,
         0.0094, 0.0199, 0.0150, 0.0347, 0.0095, 0.0078]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[-0.0051,  0.0178,  0.1028, -0.0587,  0.3410, -0.0387,  0.1911, -0.5432,
         -0.4566, -0.0295,  0.3384,  0.7740, -0.1520,  0.0598, -0.2611, -0.0685,
          0.4488,  0.3677,  0.2530, -0.0638, -0.8573,  0.5372, -0.7756, -0.0739,
         -0.1016, -0.3336, -0.0061,  0.2466, -0.1520, -0.4665, -0.3074, -0.0154,
          0.1263,  0.8109, -0.4362, -0.3110, -0.2772, -0.3435, -0.4542,  0.5097,
          0.2363,  0.1294, -0.7314,  0.6770, -0.1366,  0.1250,  0.1437, -0.0286,
          0.1467,  0.0916,  0.3946, -0.5049, -0.5640,  0.2146, -0.6064,  0.2775,
          0.1520, -0.2235,  0.2954, -0.5435,  0.3525,  0.1379,  0.1516, -0.5674,
          0.1486, -0.3031,  0.2041, -0.0966,  0.2755, -0.2588, -0.2142, -0.3765,
          0.0691,  0.5333, -0.5608,  0.0172,  0.0473, -0.2765,  0.0321, -0.3971,
         -0.8702, -0.2661,  1.0595, -0.1307, -0.1874,  0.0309, -0.7185]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[-0.0051,  0.0178,  0.1028, -0.0587,  0.3410, -0.0387,  0.1911, -0.5432,
         -0.4566, -0.0295,  0.3384,  0.7740, -0.1520,  0.0598, -0.2611, -0.0685,
          0.4488,  0.3677,  0.2530, -0.0638, -0.8573,  0.5372, -0.7756, -0.0739,
         -0.1016, -0.3336, -0.0061,  0.2466, -0.1520, -0.4665, -0.3074, -0.0154,
          0.1263,  0.8109, -0.4362, -0.3110, -0.2772, -0.3435, -0.4542,  0.5097,
          0.2363,  0.1294, -0.7314,  0.6770, -0.1366,  0.1250,  0.1437, -0.0286,
          0.1467,  0.0916,  0.3946, -0.5049, -0.5640,  0.2146, -0.6064,  0.2775,
          0.1520, -0.2235,  0.2954, -0.5435,  0.3525,  0.1379,  0.1516, -0.5674,
          0.1486, -0.3031,  0.2041, -0.0966,  0.2755, -0.2588, -0.2142, -0.3765,
          0.0691,  0.5333, -0.5608,  0.0172,  0.0473, -0.2765,  0.0321, -0.3971,
         -0.8702, -0.2661,  1.0595, -0.1307, -0.1874,  0.0309, -0.7185]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0111, 0.0114, 0.0124, 0.0105, 0.0157, 0.0108, 0.0135, 0.0065, 0.0071,
         0.0109, 0.0157, 0.0243, 0.0096, 0.0119, 0.0086, 0.0104, 0.0175, 0.0162,
         0.0144, 0.0105, 0.0047, 0.0191, 0.0052, 0.0104, 0.0101, 0.0080, 0.0111,
         0.0143, 0.0096, 0.0070, 0.0082, 0.0110, 0.0127, 0.0252, 0.0072, 0.0082,
         0.0085, 0.0079, 0.0071, 0.0186, 0.0142, 0.0127, 0.0054, 0.0220, 0.0098,
         0.0127, 0.0129, 0.0109, 0.0130, 0.0123, 0.0166, 0.0068, 0.0064, 0.0139,
         0.0061, 0.0148, 0.0130, 0.0089, 0.0150, 0.0065, 0.0159, 0.0128, 0.0130,
         0.0063, 0.0130, 0.0083, 0.0137, 0.0102, 0.0147, 0.0086, 0.0090, 0.0077,
         0.0120, 0.0191, 0.0064, 0.0114, 0.0117, 0.0085, 0.0116, 0.0075, 0.0047,
         0.0086, 0.0323, 0.0098, 0.0093, 0.0115, 0.0055]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 2.3205e-01, -1.7112e-02,  2.3593e-01, -2.1213e-01,  5.5191e-01,
          2.4906e-01,  2.7096e-01, -7.2969e-02, -1.3650e-02,  1.7700e-01,
          1.1942e-01, -9.0755e-03, -4.8940e-01, -4.4819e-01, -2.7452e-01,
          4.8934e-02,  3.3835e-01,  5.5818e-02,  1.7347e-01, -3.5713e-01,
          3.2934e-01,  1.8836e-01, -2.3534e-03, -4.7546e-01,  5.9761e-02,
          1.7354e-01, -2.8448e-01,  1.6282e-01,  5.0024e-01,  6.5215e-02,
          3.0511e-02, -5.5649e-01,  3.9164e-01,  5.8936e-01,  2.4108e-01,
          1.3512e-01,  4.5429e-01,  9.2261e-02, -3.1306e-01,  2.8177e-01,
         -5.3798e-01, -1.6839e-01, -4.5488e-01, -5.5601e-01, -2.0500e-01,
          1.9000e-01, -3.1167e-01,  1.8516e-01, -6.2753e-01, -1.0697e-02,
          2.1228e-01, -2.3828e-01, -8.4662e-02,  4.7176e-04, -1.0907e-02,
          4.4994e-01,  8.6791e-01,  1.3672e-01,  5.1238e-01, -2.5031e-01,
         -1.6263e-01, -4.0424e-01,  7.2790e-02,  1.4195e-01, -3.6164e-01,
          2.1616e-01,  8.1086e-02, -5.6708e-01,  2.6649e-01,  5.8793e-01,
          2.4991e-02, -3.0875e-01,  2.1083e-01, -3.8639e-01,  3.8817e-01,
          1.1091e-01, -1.4683e-02,  3.1624e-01,  1.4652e-01, -1.3006e-01,
          3.4304e-01,  2.2086e-01,  8.6591e-01,  3.3812e-02, -1.7214e-01,
          2.5317e-01, -1.8571e-01]], device='cuda:0')
Logits before softmax and after clamp: tensor([[ 2.3205e-01, -1.7112e-02,  2.3593e-01, -2.1213e-01,  5.5191e-01,
          2.4906e-01,  2.7096e-01, -7.2969e-02, -1.3650e-02,  1.7700e-01,
          1.1942e-01, -9.0755e-03, -4.8940e-01, -4.4819e-01, -2.7452e-01,
          4.8934e-02,  3.3835e-01,  5.5818e-02,  1.7347e-01, -3.5713e-01,
          3.2934e-01,  1.8836e-01, -2.3534e-03, -4.7546e-01,  5.9761e-02,
          1.7354e-01, -2.8448e-01,  1.6282e-01,  5.0024e-01,  6.5215e-02,
          3.0511e-02, -5.5649e-01,  3.9164e-01,  5.8936e-01,  2.4108e-01,
          1.3512e-01,  4.5429e-01,  9.2261e-02, -3.1306e-01,  2.8177e-01,
         -5.3798e-01, -1.6839e-01, -4.5488e-01, -5.5601e-01, -2.0500e-01,
          1.9000e-01, -3.1167e-01,  1.8516e-01, -6.2753e-01, -1.0697e-02,
          2.1228e-01, -2.3828e-01, -8.4662e-02,  4.7176e-04, -1.0907e-02,
          4.4994e-01,  8.6791e-01,  1.3672e-01,  5.1238e-01, -2.5031e-01,
         -1.6263e-01, -4.0424e-01,  7.2790e-02,  1.4195e-01, -3.6164e-01,
          2.1616e-01,  8.1086e-02, -5.6708e-01,  2.6649e-01,  5.8793e-01,
          2.4991e-02, -3.0875e-01,  2.1083e-01, -3.8639e-01,  3.8817e-01,
          1.1091e-01, -1.4683e-02,  3.1624e-01,  1.4652e-01, -1.3006e-01,
          3.4304e-01,  2.2086e-01,  8.6591e-01,  3.3812e-02, -1.7214e-01,
          2.5317e-01, -1.8571e-01]], device='cuda:0')
Probabilities after softmax: tensor([[0.0133, 0.0103, 0.0133, 0.0085, 0.0182, 0.0135, 0.0138, 0.0098, 0.0104,
         0.0125, 0.0118, 0.0104, 0.0064, 0.0067, 0.0080, 0.0110, 0.0147, 0.0111,
         0.0125, 0.0074, 0.0146, 0.0127, 0.0105, 0.0065, 0.0112, 0.0125, 0.0079,
         0.0124, 0.0173, 0.0112, 0.0108, 0.0060, 0.0155, 0.0189, 0.0134, 0.0120,
         0.0166, 0.0115, 0.0077, 0.0139, 0.0061, 0.0089, 0.0067, 0.0060, 0.0086,
         0.0127, 0.0077, 0.0126, 0.0056, 0.0104, 0.0130, 0.0083, 0.0097, 0.0105,
         0.0104, 0.0165, 0.0250, 0.0120, 0.0175, 0.0082, 0.0089, 0.0070, 0.0113,
         0.0121, 0.0073, 0.0130, 0.0114, 0.0060, 0.0137, 0.0189, 0.0108, 0.0077,
         0.0130, 0.0071, 0.0155, 0.0117, 0.0104, 0.0144, 0.0122, 0.0092, 0.0148,
         0.0131, 0.0250, 0.0109, 0.0088, 0.0135, 0.0087]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.0668, -0.3083,  0.1441, -0.1486, -0.0590,  0.6044,  0.3166, -0.9673,
         -0.6508, -0.6970,  0.3121,  0.7257,  0.1642,  0.1764, -0.2264, -0.5847,
         -0.5854,  0.1385,  0.5232, -0.1358, -1.1622,  0.0141,  0.2546, -0.8066,
         -0.6053, -0.3502,  0.3443, -0.8526,  0.5785,  0.0790,  0.2162,  0.1694,
         -0.5521,  0.1885, -0.1365,  0.0465, -0.0572,  0.2873,  0.1643,  0.9667,
          0.1513,  0.7409, -0.7360, -0.3332, -0.2315,  0.2826, -0.0063, -0.5680,
          0.0485,  0.2560, -0.2827, -0.2454, -0.3763, -0.7140,  0.1923,  0.4538,
         -0.3265,  0.0280, -0.4607, -0.7616,  0.2609,  0.0306, -0.2545, -0.3457,
          0.0363, -0.3856,  0.2322,  0.0845,  0.0235, -0.1356,  0.2392, -0.2162,
          0.1762, -0.1295,  0.1878, -0.9550, -0.0188,  0.1250, -0.0551,  0.1793,
          0.0971, -0.1184, -0.2965,  0.3840,  0.1699, -0.2662,  0.0192]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.0668, -0.3083,  0.1441, -0.1486, -0.0590,  0.6044,  0.3166, -0.9673,
         -0.6508, -0.6970,  0.3121,  0.7257,  0.1642,  0.1764, -0.2264, -0.5847,
         -0.5854,  0.1385,  0.5232, -0.1358, -1.1622,  0.0141,  0.2546, -0.8066,
         -0.6053, -0.3502,  0.3443, -0.8526,  0.5785,  0.0790,  0.2162,  0.1694,
         -0.5521,  0.1885, -0.1365,  0.0465, -0.0572,  0.2873,  0.1643,  0.9667,
          0.1513,  0.7409, -0.7360, -0.3332, -0.2315,  0.2826, -0.0063, -0.5680,
          0.0485,  0.2560, -0.2827, -0.2454, -0.3763, -0.7140,  0.1923,  0.4538,
         -0.3265,  0.0280, -0.4607, -0.7616,  0.2609,  0.0306, -0.2545, -0.3457,
          0.0363, -0.3856,  0.2322,  0.0845,  0.0235, -0.1356,  0.2392, -0.2162,
          0.1762, -0.1295,  0.1878, -0.9550, -0.0188,  0.1250, -0.0551,  0.1793,
          0.0971, -0.1184, -0.2965,  0.3840,  0.1699, -0.2662,  0.0192]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0122, 0.0084, 0.0132, 0.0098, 0.0107, 0.0208, 0.0156, 0.0043, 0.0059,
         0.0057, 0.0156, 0.0235, 0.0134, 0.0136, 0.0091, 0.0063, 0.0063, 0.0131,
         0.0192, 0.0099, 0.0036, 0.0116, 0.0147, 0.0051, 0.0062, 0.0080, 0.0161,
         0.0049, 0.0203, 0.0123, 0.0141, 0.0135, 0.0066, 0.0138, 0.0099, 0.0119,
         0.0108, 0.0152, 0.0134, 0.0299, 0.0133, 0.0239, 0.0055, 0.0082, 0.0090,
         0.0151, 0.0113, 0.0065, 0.0120, 0.0147, 0.0086, 0.0089, 0.0078, 0.0056,
         0.0138, 0.0179, 0.0082, 0.0117, 0.0072, 0.0053, 0.0148, 0.0117, 0.0088,
         0.0081, 0.0118, 0.0077, 0.0144, 0.0124, 0.0117, 0.0099, 0.0145, 0.0092,
         0.0136, 0.0100, 0.0137, 0.0044, 0.0112, 0.0129, 0.0108, 0.0136, 0.0126,
         0.0101, 0.0085, 0.0167, 0.0135, 0.0087, 0.0116]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.8925,  0.0168, -0.1317, -0.2699, -0.1915, -0.0833, -0.2628, -0.7962,
          0.1294, -0.5624,  0.4630,  0.1136,  0.1787, -0.3960, -0.1068, -0.1467,
          0.6314,  0.3088, -0.1718, -0.3751, -0.2166, -0.1436, -0.7136, -0.1927,
         -0.3544,  0.3533,  0.0489, -0.0535, -0.3469, -0.1531, -0.2931,  0.1533,
          0.0594, -0.1391,  0.5168, -0.3533,  0.1041, -0.4054,  0.0801, -0.1351,
          0.0624,  0.0112,  0.6923, -1.0442,  0.1286,  0.2139, -0.3245, -0.2579,
          0.0438, -0.0197,  0.0105, -0.0659,  0.0273, -0.1240, -0.0378, -0.7896,
         -0.6183, -0.5704, -0.1401,  0.1603,  0.6176, -0.3296,  0.3148, -0.0960,
          0.5542,  0.1906, -0.7809,  0.0608,  0.0798, -0.5564,  0.2388,  0.3888,
          0.1926, -0.2116,  0.4944,  0.0815,  0.1668,  0.9202, -0.3405, -0.5917,
         -0.3339,  0.4578,  0.7212, -0.0078, -0.2165,  0.5117, -0.2703]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.8925,  0.0168, -0.1317, -0.2699, -0.1915, -0.0833, -0.2628, -0.7962,
          0.1294, -0.5624,  0.4630,  0.1136,  0.1787, -0.3960, -0.1068, -0.1467,
          0.6314,  0.3088, -0.1718, -0.3751, -0.2166, -0.1436, -0.7136, -0.1927,
         -0.3544,  0.3533,  0.0489, -0.0535, -0.3469, -0.1531, -0.2931,  0.1533,
          0.0594, -0.1391,  0.5168, -0.3533,  0.1041, -0.4054,  0.0801, -0.1351,
          0.0624,  0.0112,  0.6923, -1.0442,  0.1286,  0.2139, -0.3245, -0.2579,
          0.0438, -0.0197,  0.0105, -0.0659,  0.0273, -0.1240, -0.0378, -0.7896,
         -0.6183, -0.5704, -0.1401,  0.1603,  0.6176, -0.3296,  0.3148, -0.0960,
          0.5542,  0.1906, -0.7809,  0.0608,  0.0798, -0.5564,  0.2388,  0.3888,
          0.1926, -0.2116,  0.4944,  0.0815,  0.1668,  0.9202, -0.3405, -0.5917,
         -0.3339,  0.4578,  0.7212, -0.0078, -0.2165,  0.5117, -0.2703]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0270, 0.0113, 0.0097, 0.0085, 0.0091, 0.0102, 0.0085, 0.0050, 0.0126,
         0.0063, 0.0176, 0.0124, 0.0132, 0.0075, 0.0100, 0.0096, 0.0208, 0.0151,
         0.0093, 0.0076, 0.0089, 0.0096, 0.0054, 0.0091, 0.0078, 0.0158, 0.0116,
         0.0105, 0.0078, 0.0095, 0.0083, 0.0129, 0.0118, 0.0096, 0.0186, 0.0078,
         0.0123, 0.0074, 0.0120, 0.0097, 0.0118, 0.0112, 0.0221, 0.0039, 0.0126,
         0.0137, 0.0080, 0.0086, 0.0116, 0.0109, 0.0112, 0.0104, 0.0114, 0.0098,
         0.0107, 0.0050, 0.0060, 0.0063, 0.0096, 0.0130, 0.0205, 0.0080, 0.0152,
         0.0101, 0.0193, 0.0134, 0.0051, 0.0118, 0.0120, 0.0064, 0.0141, 0.0163,
         0.0134, 0.0090, 0.0182, 0.0120, 0.0131, 0.0278, 0.0079, 0.0061, 0.0079,
         0.0175, 0.0228, 0.0110, 0.0089, 0.0185, 0.0085]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.0858,  0.1289,  0.4058, -0.4584,  0.4789,  0.7469, -0.2545,  0.1129,
         -0.4519,  0.0371, -0.3905, -0.3832, -0.6123, -0.2455, -0.7272, -0.6876,
          0.2193,  0.4639, -0.5450, -0.8154, -0.7614, -0.2079, -0.1591, -0.7094,
         -0.2999, -0.3333,  0.0563,  0.2061,  0.2279, -0.4286,  0.4357,  0.1936,
         -0.1621,  0.3875,  0.2644, -0.1543, -0.1790, -0.2181, -0.1876,  0.3105,
          0.2562,  0.6863, -0.6767,  0.2073, -0.1520,  0.0396,  0.0148, -0.0622,
         -0.1660,  0.1903,  0.0909, -0.7143, -0.0425,  0.2658, -0.4675,  0.5980,
          0.3591,  0.0914,  0.2724,  0.7385,  0.6347,  0.1894, -0.6474,  0.2046,
          0.2172,  0.2583, -0.2792, -0.8565,  0.1077, -0.4507, -0.1267,  0.0713,
         -0.1911,  0.3032,  0.1009, -0.5291,  0.0417, -0.1259,  0.5141,  0.0048,
         -0.5958,  0.3540,  0.4675,  0.0654,  0.1560, -0.7988, -0.1566]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.0858,  0.1289,  0.4058, -0.4584,  0.4789,  0.7469, -0.2545,  0.1129,
         -0.4519,  0.0371, -0.3905, -0.3832, -0.6123, -0.2455, -0.7272, -0.6876,
          0.2193,  0.4639, -0.5450, -0.8154, -0.7614, -0.2079, -0.1591, -0.7094,
         -0.2999, -0.3333,  0.0563,  0.2061,  0.2279, -0.4286,  0.4357,  0.1936,
         -0.1621,  0.3875,  0.2644, -0.1543, -0.1790, -0.2181, -0.1876,  0.3105,
          0.2562,  0.6863, -0.6767,  0.2073, -0.1520,  0.0396,  0.0148, -0.0622,
         -0.1660,  0.1903,  0.0909, -0.7143, -0.0425,  0.2658, -0.4675,  0.5980,
          0.3591,  0.0914,  0.2724,  0.7385,  0.6347,  0.1894, -0.6474,  0.2046,
          0.2172,  0.2583, -0.2792, -0.8565,  0.1077, -0.4507, -0.1267,  0.0713,
         -0.1911,  0.3032,  0.1009, -0.5291,  0.0417, -0.1259,  0.5141,  0.0048,
         -0.5958,  0.3540,  0.4675,  0.0654,  0.1560, -0.7988, -0.1566]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0122, 0.0127, 0.0168, 0.0071, 0.0180, 0.0236, 0.0087, 0.0125, 0.0071,
         0.0116, 0.0076, 0.0076, 0.0061, 0.0087, 0.0054, 0.0056, 0.0139, 0.0178,
         0.0065, 0.0049, 0.0052, 0.0091, 0.0095, 0.0055, 0.0083, 0.0080, 0.0118,
         0.0137, 0.0140, 0.0073, 0.0173, 0.0136, 0.0095, 0.0165, 0.0145, 0.0096,
         0.0093, 0.0090, 0.0093, 0.0152, 0.0144, 0.0222, 0.0057, 0.0137, 0.0096,
         0.0116, 0.0113, 0.0105, 0.0095, 0.0135, 0.0122, 0.0055, 0.0107, 0.0146,
         0.0070, 0.0203, 0.0160, 0.0122, 0.0147, 0.0234, 0.0211, 0.0135, 0.0058,
         0.0137, 0.0139, 0.0145, 0.0084, 0.0047, 0.0124, 0.0071, 0.0098, 0.0120,
         0.0092, 0.0151, 0.0124, 0.0066, 0.0116, 0.0098, 0.0187, 0.0112, 0.0062,
         0.0159, 0.0178, 0.0119, 0.0131, 0.0050, 0.0095]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.0837,  0.0485, -0.1748,  0.0752,  0.8425,  0.0398, -0.1904, -0.4615,
          0.4124,  0.1234, -0.7368,  0.3814, -0.1175,  0.0854, -0.3218, -0.7216,
          0.0113, -0.1088,  0.4831,  0.0341, -0.5247, -0.3025,  0.0105,  0.5228,
         -0.0477,  0.1377, -0.9319, -0.2086,  0.5417,  0.4602, -0.0421,  0.3107,
         -0.1637, -0.1760,  0.1052,  0.6743,  0.3219,  0.3696, -0.0419,  0.2111,
         -0.1909, -0.8087,  0.3074, -0.4823, -0.6737,  0.0978, -0.2415, -0.6179,
          0.0390,  0.0496,  0.2923,  0.7311, -0.4859, -0.4535,  0.0856,  0.2873,
         -1.0009, -0.2632,  0.3452, -0.0500, -0.3265, -0.7774, -0.1348,  0.0964,
          0.0674, -0.1651,  0.1983, -0.2222,  0.1573, -0.2902,  0.3826, -0.2259,
         -0.1109,  0.1762,  0.1986,  0.2001, -0.3975, -0.0658, -0.1126,  0.0950,
         -0.2403, -0.0086,  0.0831, -0.2449,  0.5593,  0.3388, -0.1955]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.0837,  0.0485, -0.1748,  0.0752,  0.8425,  0.0398, -0.1904, -0.4615,
          0.4124,  0.1234, -0.7368,  0.3814, -0.1175,  0.0854, -0.3218, -0.7216,
          0.0113, -0.1088,  0.4831,  0.0341, -0.5247, -0.3025,  0.0105,  0.5228,
         -0.0477,  0.1377, -0.9319, -0.2086,  0.5417,  0.4602, -0.0421,  0.3107,
         -0.1637, -0.1760,  0.1052,  0.6743,  0.3219,  0.3696, -0.0419,  0.2111,
         -0.1909, -0.8087,  0.3074, -0.4823, -0.6737,  0.0978, -0.2415, -0.6179,
          0.0390,  0.0496,  0.2923,  0.7311, -0.4859, -0.4535,  0.0856,  0.2873,
         -1.0009, -0.2632,  0.3452, -0.0500, -0.3265, -0.7774, -0.1348,  0.0964,
          0.0674, -0.1651,  0.1983, -0.2222,  0.1573, -0.2902,  0.3826, -0.2259,
         -0.1109,  0.1762,  0.1986,  0.2001, -0.3975, -0.0658, -0.1126,  0.0950,
         -0.2403, -0.0086,  0.0831, -0.2449,  0.5593,  0.3388, -0.1955]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0121, 0.0117, 0.0093, 0.0120, 0.0258, 0.0116, 0.0092, 0.0070, 0.0168,
         0.0126, 0.0053, 0.0163, 0.0099, 0.0121, 0.0081, 0.0054, 0.0113, 0.0100,
         0.0180, 0.0115, 0.0066, 0.0082, 0.0112, 0.0188, 0.0106, 0.0128, 0.0044,
         0.0090, 0.0191, 0.0176, 0.0107, 0.0152, 0.0094, 0.0093, 0.0124, 0.0218,
         0.0154, 0.0161, 0.0107, 0.0137, 0.0092, 0.0050, 0.0151, 0.0069, 0.0057,
         0.0123, 0.0087, 0.0060, 0.0116, 0.0117, 0.0149, 0.0231, 0.0068, 0.0071,
         0.0121, 0.0148, 0.0041, 0.0086, 0.0157, 0.0106, 0.0080, 0.0051, 0.0097,
         0.0123, 0.0119, 0.0094, 0.0136, 0.0089, 0.0130, 0.0083, 0.0163, 0.0089,
         0.0100, 0.0133, 0.0136, 0.0136, 0.0075, 0.0104, 0.0099, 0.0122, 0.0088,
Finding best initial lr:   1%|          | 1/100 [00:24<40:33, 24.58s/it]Finding best initial lr:   2%|         | 2/100 [00:24<16:39, 10.19s/it]Finding best initial lr:   3%|         | 3/100 [00:24<09:02,  5.59s/it]Finding best initial lr:   4%|         | 4/100 [00:24<05:29,  3.43s/it]Finding best initial lr:   5%|         | 5/100 [00:25<03:32,  2.24s/it]Finding best initial lr:   6%|         | 6/100 [00:25<02:22,  1.52s/it]Finding best initial lr:   7%|         | 7/100 [00:25<01:38,  1.06s/it]Finding best initial lr:   8%|         | 8/100 [00:25<01:10,  1.31it/s]Finding best initial lr:   9%|         | 9/100 [00:25<00:51,  1.78it/s]Finding best initial lr:  10%|         | 10/100 [00:25<00:38,  2.35it/s]Finding best initial lr:  11%|         | 11/100 [00:25<00:29,  3.01it/s]Finding best initial lr:  12%|        | 12/100 [00:25<00:23,  3.73it/s]Finding best initial lr:  13%|        | 13/100 [00:26<00:19,  4.47it/s]Finding best initial lr:  14%|        | 14/100 [00:26<00:16,  5.19it/s]Finding best initial lr:  15%|        | 15/100 [00:26<00:14,  5.85it/s]Finding best initial lr:  16%|        | 16/100 [00:26<00:13,  6.41it/s]Finding best initial lr:  17%|        | 17/100 [00:26<00:12,  6.87it/s]Finding best initial lr:  18%|        | 18/100 [00:26<00:11,  7.24it/s]Finding best initial lr:  19%|        | 19/100 [00:26<00:10,  7.52it/s]Finding best initial lr:  20%|        | 20/100 [00:26<00:10,  7.73it/s]Finding best initial lr:  21%|        | 21/100 [00:27<00:10,  7.88it/s]Finding best initial lr:  22%|       | 22/100 [00:27<00:09,  7.99it/s]Finding best initial lr:  23%|       | 23/100 [00:27<00:09,  8.07it/s]Finding best initial lr:  24%|       | 24/100 [00:27<00:09,  8.12it/s]Finding best initial lr:  25%|       | 25/100 [00:27<00:09,  8.14it/s]Finding best initial lr:  26%|       | 26/100 [00:27<00:09,  8.18it/s]Finding best initial lr:  27%|       | 27/100 [00:27<00:08,  8.20it/s]Finding best initial lr:  28%|       | 28/100 [00:27<00:08,  8.22it/s]Finding best initial lr:  29%|       | 29/100 [00:27<00:08,  8.23it/s]Finding best initial lr:  30%|       | 30/100 [00:28<00:08,  8.24it/s]Finding best initial lr:  31%|       | 31/100 [00:28<00:08,  8.24it/s]Finding best initial lr:  32%|      | 32/100 [00:28<00:08,  8.25it/s]Finding best initial lr:  33%|      | 33/100 [00:28<00:08,  8.25it/s]Finding best initial lr:  34%|      | 34/100 [00:28<00:07,  8.26it/s]Finding best initial lr:  35%|      | 35/100 [00:28<00:07,  8.26it/s]Finding best initial lr:  36%|      | 36/100 [00:28<00:07,  8.26it/s]Finding best initial lr:  37%|      | 37/100 [00:28<00:07,  8.26it/s]Finding best initial lr:  38%|      | 38/100 [00:29<00:07,  8.26it/s]Finding best initial lr:  39%|      | 39/100 [00:29<00:07,  8.26it/s]Finding best initial lr:  40%|      | 40/100 [00:29<00:07,  8.26it/s]Finding best initial lr:  41%|      | 41/100 [00:29<00:07,  8.26it/s]Finding best initial lr:  42%|     | 42/100 [00:29<00:07,  8.26it/s]Finding best initial lr:  43%|     | 43/100 [00:29<00:06,  8.26it/s]Finding best initial lr:  44%|     | 44/100 [00:29<00:06,  8.26it/s]Finding best initial lr:  45%|     | 45/100 [00:29<00:06,  8.26it/s]Finding best initial lr:  46%|     | 46/100 [00:30<00:06,  8.26it/s]Finding best initial lr:  47%|     | 47/100 [00:30<00:06,  8.26it/s]Finding best initial lr:  48%|     | 48/100 [00:30<00:06,  8.26it/s]Finding best initial lr:  49%|     | 49/100 [00:30<00:06,  8.26it/s]Finding best initial lr:  50%|     | 50/100 [00:30<00:06,  8.26it/s]Finding best initial lr:  51%|     | 51/100 [00:30<00:05,  8.26it/s]Finding best initial lr:  52%|    | 52/100 [00:30<00:05,  8.26it/s]Finding best initial lr:  53%|    | 53/100 [00:30<00:05,  8.26it/s]Finding best initial lr:  54%|    | 54/100 [00:31<00:05,  8.26it/s]Finding best initial lr:  55%|    | 55/100 [00:31<00:05,  8.26it/s]Finding best initial lr:  56%|    | 56/100 [00:31<00:05,  8.26it/s]Finding best initial lr:  57%|    | 57/100 [00:31<00:05,  8.26it/s]Finding best initial lr:  58%|    | 58/100 [00:31<00:05,  8.26it/s]Finding best initial lr:  59%|    | 59/100 [00:31<00:04,  8.26it/s]Finding best initial lr:  60%|    | 60/100 [00:31<00:04,  8.26it/s]Finding best initial lr:  61%|    | 61/100 [00:31<00:04,  8.26it/s]Finding best initial lr:  62%|   | 62/100 [00:31<00:04,  8.26it/s]Finding best initial lr:  63%|   | 63/100 [00:32<00:04,  8.26it/s]Finding best initial lr:  64%|   | 64/100 [00:32<00:04,  8.26it/s]Finding best initial lr:  65%|   | 65/100 [00:32<00:04,  8.26it/s]Finding best initial lr:  66%|   | 66/100 [00:32<00:04,  8.26it/s]Finding best initial lr:  67%|   | 67/100 [00:32<00:03,  8.26it/s]Finding best initial lr:  68%|   | 68/100 [00:32<00:03,  8.26it/s]Finding best initial lr:  69%|   | 69/100 [00:32<00:03,  8.26it/s]Finding best initial lr:  70%|   | 70/100 [00:32<00:03,  8.26it/s]Finding best initial lr:  71%|   | 71/100 [00:33<00:03,  8.26it/s]Finding best initial lr:  72%|  | 72/100 [00:33<00:03,  8.26it/s]Finding best initial lr:  73%|  | 73/100 [00:33<00:03,  8.27it/s]Finding best initial lr:  74%|  | 74/100 [00:33<00:03,  8.27it/s]Finding best initial lr:  75%|  | 75/100 [00:33<00:03,  8.27it/s]Finding best initial lr:  76%|  | 76/100 [00:33<00:02,  8.26it/s]Finding best initial lr:  77%|  | 77/100 [00:33<00:02,  8.26it/s]Finding best initial lr:  78%|  | 78/100 [00:33<00:02,  8.27it/s]Finding best initial lr:  79%|  | 79/100 [00:34<00:02,  8.27it/s]Finding best initial lr:  80%|  | 80/100 [00:34<00:02,  8.27it/s]Finding best initial lr:  81%|  | 81/100 [00:34<00:02,  8.27it/s]Finding best initial lr:  82%| | 82/100 [00:34<00:02,  8.27it/s]Finding best initial lr:  83%| | 83/100 [00:34<00:02,  8.26it/s]Finding best initial lr:  84%| | 84/100 [00:34<00:01,  8.26it/s]Finding best initial lr:  85%| | 85/100 [00:34<00:01,  8.26it/s]Finding best initial lr:  86%| | 86/100 [00:34<00:01,  8.26it/s]Finding best initial lr:  87%| | 87/100 [00:34<00:01,  8.26it/s]Finding best initial lr:  88%| | 88/100 [00:35<00:01,  8.26it/s]Finding best initial lr:  89%| | 89/100 [00:35<00:01,  8.26it/s]Finding best initial lr:  90%| | 90/100 [00:35<00:01,  8.26it/s]Finding best initial lr:  91%| | 91/100 [00:35<00:01,  8.26it/s]Finding best initial lr:  92%|| 92/100 [00:35<00:00,  8.26it/s]Finding best initial lr:  93%|| 93/100 [00:35<00:00,  8.26it/s]Finding best initial lr:  94%|| 94/100 [00:35<00:00,  8.26it/s]Finding best initial lr:  95%|| 95/100 [00:35<00:00,  8.26it/s]Finding best initial lr:  96%|| 96/100 [00:36<00:00,  8.22it/s]Finding best initial lr:  97%|| 97/100 [00:36<00:00,  8.22it/s]Finding best initial lr:  98%|| 98/100 [00:36<00:00,  8.23it/s]Finding best initial lr:  99%|| 99/100 [00:36<00:00,  8.24it/s]Finding best initial lr: 100%|| 100/100 [00:36<00:00,  8.25it/s]`Trainer.fit` stopped: `max_steps=100` reached.
Finding best initial lr: 100%|| 100/100 [00:36<00:00,  2.73it/s]
Learning rate set to 0.0003019951720402019
Restoring states from the checkpoint path at /gpfs/home6/scur2773/uvadlc_practicals_2024/assignment2/part2/.lr_find_b8648a3d-d8b6-4b2b-a173-40ef5c40681e.ckpt
Restored all states from the checkpoint at /gpfs/home6/scur2773/uvadlc_practicals_2024/assignment2/part2/.lr_find_b8648a3d-d8b6-4b2b-a173-40ef5c40681e.ckpt

  | Name  | Type            | Params | Mode 
--------------------------------------------------
0 | model | OptimizedModule | 10.8 M | train
--------------------------------------------------
10.8 M    Trainable params
0         Non-trainable params
10.8 M    Total params
43.053    Total estimated model params size (MB)
87        Modules in train mode
0         Modules in eval mode
Restored all states from the checkpoint at /gpfs/home6/scur2773/uvadlc_practicals_2024/assignment2/part2/.lr_find_b8648a3d-d8b6-4b2b-a173-40ef5c40681e.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
         0.0110, 0.0121, 0.0087, 0.0195, 0.0156, 0.0092]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.7799,  0.2147, -0.1605, -0.6577, -0.0927, -0.1060, -0.0187, -0.3176,
         -0.1590, -0.9936,  0.3863,  0.6169, -0.3319, -0.1994, -0.4203, -0.0268,
          0.0901,  0.4266, -0.3683, -0.4790,  0.1114, -0.1720, -0.8738, -0.4664,
         -0.6335, -0.0057, -0.5099, -0.1602,  0.3523, -0.6019, -0.0636,  0.0201,
         -0.5366,  0.0318,  0.3251,  0.2404,  0.2427, -0.3062, -0.1411, -0.3018,
         -0.1032, -0.0905,  0.4106, -0.1237, -0.4648, -0.1696, -0.4720,  0.1173,
         -0.2106,  0.2425, -0.0926,  0.3824, -0.2839, -0.0375, -0.2674, -0.6634,
          0.5562, -0.0392, -0.2671, -0.2111,  1.2690, -0.1771, -0.0249,  0.0193,
          0.2312,  0.1139, -0.2688, -0.0950,  0.4092, -0.0031,  0.0837,  0.0543,
          0.2153,  0.1927, -0.0584, -0.3084,  0.2139,  0.0571, -0.0157,  0.1236,
          0.3783,  0.1748,  0.6626,  0.2703, -0.2115, -0.5296, -0.0830]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.7799,  0.2147, -0.1605, -0.6577, -0.0927, -0.1060, -0.0187, -0.3176,
         -0.1590, -0.9936,  0.3863,  0.6169, -0.3319, -0.1994, -0.4203, -0.0268,
          0.0901,  0.4266, -0.3683, -0.4790,  0.1114, -0.1720, -0.8738, -0.4664,
         -0.6335, -0.0057, -0.5099, -0.1602,  0.3523, -0.6019, -0.0636,  0.0201,
         -0.5366,  0.0318,  0.3251,  0.2404,  0.2427, -0.3062, -0.1411, -0.3018,
         -0.1032, -0.0905,  0.4106, -0.1237, -0.4648, -0.1696, -0.4720,  0.1173,
         -0.2106,  0.2425, -0.0926,  0.3824, -0.2839, -0.0375, -0.2674, -0.6634,
          0.5562, -0.0392, -0.2671, -0.2111,  1.2690, -0.1771, -0.0249,  0.0193,
          0.2312,  0.1139, -0.2688, -0.0950,  0.4092, -0.0031,  0.0837,  0.0543,
          0.2153,  0.1927, -0.0584, -0.3084,  0.2139,  0.0571, -0.0157,  0.1236,
          0.3783,  0.1748,  0.6626,  0.2703, -0.2115, -0.5296, -0.0830]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0246, 0.0140, 0.0096, 0.0058, 0.0103, 0.0101, 0.0111, 0.0082, 0.0096,
         0.0042, 0.0166, 0.0209, 0.0081, 0.0092, 0.0074, 0.0110, 0.0123, 0.0173,
         0.0078, 0.0070, 0.0126, 0.0095, 0.0047, 0.0071, 0.0060, 0.0112, 0.0068,
         0.0096, 0.0160, 0.0062, 0.0106, 0.0115, 0.0066, 0.0116, 0.0156, 0.0143,
         0.0144, 0.0083, 0.0098, 0.0083, 0.0102, 0.0103, 0.0170, 0.0100, 0.0071,
         0.0095, 0.0070, 0.0127, 0.0091, 0.0144, 0.0103, 0.0165, 0.0085, 0.0108,
         0.0086, 0.0058, 0.0196, 0.0108, 0.0086, 0.0091, 0.0401, 0.0094, 0.0110,
         0.0115, 0.0142, 0.0126, 0.0086, 0.0102, 0.0170, 0.0112, 0.0122, 0.0119,
         0.0140, 0.0137, 0.0106, 0.0083, 0.0139, 0.0119, 0.0111, 0.0127, 0.0164,
         0.0134, 0.0218, 0.0148, 0.0091, 0.0066, 0.0104]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.8105,  0.2482,  0.1133, -0.4395, -0.2884, -0.1488,  0.0928,  0.2500,
          0.0032, -0.5701, -0.5696,  0.1143, -0.1613,  0.2422, -0.2610, -0.0812,
          0.3112,  0.4328, -0.2348,  0.0988, -0.2224, -0.5017, -0.3062, -0.5509,
         -0.1036, -0.1591, -0.0207,  0.1674, -0.1512, -0.2148, -0.1904,  0.1666,
          0.3858,  0.1483,  0.0537,  0.5575, -0.4850, -0.1113,  0.0217, -0.0779,
          0.0669,  0.2118,  0.0783, -0.4173,  0.2977, -0.1746, -0.7741, -0.1964,
         -0.3214,  0.0318, -0.6448,  0.4550, -0.2144, -0.4103, -0.3199,  0.1782,
         -0.0829, -0.7098,  0.3249, -0.0193,  0.1371, -0.1258, -0.2136, -0.5594,
          0.1930,  0.2993,  0.6463,  0.2753, -0.1824,  0.3502,  0.5733,  0.3875,
          0.3072,  0.1921, -0.3399,  0.0174,  0.0830,  0.1279, -0.4177,  0.0697,
         -0.1656,  0.1896,  0.5830, -0.6573,  0.2973, -0.6392, -0.1778]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.8105,  0.2482,  0.1133, -0.4395, -0.2884, -0.1488,  0.0928,  0.2500,
          0.0032, -0.5701, -0.5696,  0.1143, -0.1613,  0.2422, -0.2610, -0.0812,
          0.3112,  0.4328, -0.2348,  0.0988, -0.2224, -0.5017, -0.3062, -0.5509,
         -0.1036, -0.1591, -0.0207,  0.1674, -0.1512, -0.2148, -0.1904,  0.1666,
          0.3858,  0.1483,  0.0537,  0.5575, -0.4850, -0.1113,  0.0217, -0.0779,
          0.0669,  0.2118,  0.0783, -0.4173,  0.2977, -0.1746, -0.7741, -0.1964,
         -0.3214,  0.0318, -0.6448,  0.4550, -0.2144, -0.4103, -0.3199,  0.1782,
         -0.0829, -0.7098,  0.3249, -0.0193,  0.1371, -0.1258, -0.2136, -0.5594,
          0.1930,  0.2993,  0.6463,  0.2753, -0.1824,  0.3502,  0.5733,  0.3875,
          0.3072,  0.1921, -0.3399,  0.0174,  0.0830,  0.1279, -0.4177,  0.0697,
         -0.1656,  0.1896,  0.5830, -0.6573,  0.2973, -0.6392, -0.1778]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0253, 0.0144, 0.0126, 0.0072, 0.0084, 0.0097, 0.0123, 0.0144, 0.0113,
         0.0064, 0.0064, 0.0126, 0.0096, 0.0143, 0.0087, 0.0104, 0.0153, 0.0173,
         0.0089, 0.0124, 0.0090, 0.0068, 0.0083, 0.0065, 0.0101, 0.0096, 0.0110,
         0.0133, 0.0097, 0.0091, 0.0093, 0.0133, 0.0165, 0.0130, 0.0119, 0.0196,
         0.0069, 0.0101, 0.0115, 0.0104, 0.0120, 0.0139, 0.0122, 0.0074, 0.0151,
         0.0094, 0.0052, 0.0092, 0.0082, 0.0116, 0.0059, 0.0177, 0.0091, 0.0075,
         0.0082, 0.0134, 0.0104, 0.0055, 0.0156, 0.0110, 0.0129, 0.0099, 0.0091,
         0.0064, 0.0136, 0.0152, 0.0215, 0.0148, 0.0094, 0.0160, 0.0199, 0.0166,
         0.0153, 0.0136, 0.0080, 0.0114, 0.0122, 0.0128, 0.0074, 0.0121, 0.0095,
         0.0136, 0.0201, 0.0058, 0.0151, 0.0059, 0.0094]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 2.8002e-01,  5.4789e-01, -6.6707e-02, -3.8245e-01, -4.7189e-01,
         -3.3238e-01,  4.8660e-01, -6.5974e-01, -6.0427e-01,  3.3384e-01,
          2.2602e-01,  3.4690e-01,  6.4464e-02,  3.6875e-01, -4.6421e-01,
         -4.5021e-01, -1.4716e-01, -3.2377e-01,  2.0551e-02,  5.5414e-01,
         -1.0573e+00,  1.2101e-01,  7.8645e-02, -1.0736e-01, -5.0612e-01,
         -1.1722e-01,  1.9597e-02,  2.6775e-02,  2.8705e-01, -4.9468e-01,
         -2.2616e-01,  2.0849e-01,  4.4960e-01,  3.4452e-01,  5.0356e-02,
          5.3206e-02,  6.9097e-02,  8.4818e-02, -1.6909e-01,  1.1538e+00,
          3.1292e-02,  4.5064e-01, -8.0084e-01, -1.9139e-01,  1.3743e-01,
          3.2861e-01, -6.4984e-02, -5.6003e-01,  3.7923e-02, -3.1075e-01,
         -1.2619e-02,  4.0215e-01,  1.2677e-01, -6.9895e-02, -5.9953e-01,
          3.9513e-01, -2.4450e-01, -8.8683e-01,  4.9413e-02,  3.7288e-01,
         -3.7208e-01,  1.8962e-02,  1.7992e-01, -2.9545e-01,  1.1117e-03,
         -8.8391e-02,  7.7869e-01, -2.4069e-01,  1.3981e-01, -4.9378e-01,
          7.0138e-01, -2.9902e-01,  3.3931e-02,  4.5397e-01,  6.8466e-02,
         -7.4293e-01,  4.0158e-01,  8.3395e-01, -6.8394e-02,  3.5246e-01,
         -7.0995e-02,  3.5082e-01,  5.6174e-01, -1.2449e-01,  1.9238e-01,
         -1.0491e-01, -2.1600e-02]], device='cuda:0')
Logits before softmax and after clamp: tensor([[ 2.8002e-01,  5.4789e-01, -6.6707e-02, -3.8245e-01, -4.7189e-01,
         -3.3238e-01,  4.8660e-01, -6.5974e-01, -6.0427e-01,  3.3384e-01,
          2.2602e-01,  3.4690e-01,  6.4464e-02,  3.6875e-01, -4.6421e-01,
         -4.5021e-01, -1.4716e-01, -3.2377e-01,  2.0551e-02,  5.5414e-01,
         -1.0573e+00,  1.2101e-01,  7.8645e-02, -1.0736e-01, -5.0612e-01,
         -1.1722e-01,  1.9597e-02,  2.6775e-02,  2.8705e-01, -4.9468e-01,
         -2.2616e-01,  2.0849e-01,  4.4960e-01,  3.4452e-01,  5.0356e-02,
          5.3206e-02,  6.9097e-02,  8.4818e-02, -1.6909e-01,  1.1538e+00,
          3.1292e-02,  4.5064e-01, -8.0084e-01, -1.9139e-01,  1.3743e-01,
          3.2861e-01, -6.4984e-02, -5.6003e-01,  3.7923e-02, -3.1075e-01,
         -1.2619e-02,  4.0215e-01,  1.2677e-01, -6.9895e-02, -5.9953e-01,
          3.9513e-01, -2.4450e-01, -8.8683e-01,  4.9413e-02,  3.7288e-01,
         -3.7208e-01,  1.8962e-02,  1.7992e-01, -2.9545e-01,  1.1117e-03,
         -8.8391e-02,  7.7869e-01, -2.4069e-01,  1.3981e-01, -4.9378e-01,
          7.0138e-01, -2.9902e-01,  3.3931e-02,  4.5397e-01,  6.8466e-02,
         -7.4293e-01,  4.0158e-01,  8.3395e-01, -6.8394e-02,  3.5246e-01,
         -7.0995e-02,  3.5082e-01,  5.6174e-01, -1.2449e-01,  1.9238e-01,
         -1.0491e-01, -2.1600e-02]], device='cuda:0')
Probabilities after softmax: tensor([[0.0140, 0.0183, 0.0099, 0.0072, 0.0066, 0.0076, 0.0172, 0.0055, 0.0058,
         0.0148, 0.0133, 0.0150, 0.0113, 0.0153, 0.0067, 0.0067, 0.0091, 0.0077,
         0.0108, 0.0184, 0.0037, 0.0119, 0.0114, 0.0095, 0.0064, 0.0094, 0.0108,
         0.0109, 0.0141, 0.0065, 0.0084, 0.0130, 0.0166, 0.0149, 0.0111, 0.0112,
         0.0113, 0.0115, 0.0089, 0.0335, 0.0109, 0.0166, 0.0047, 0.0087, 0.0121,
         0.0147, 0.0099, 0.0060, 0.0110, 0.0078, 0.0104, 0.0158, 0.0120, 0.0099,
         0.0058, 0.0157, 0.0083, 0.0044, 0.0111, 0.0154, 0.0073, 0.0108, 0.0127,
         0.0079, 0.0106, 0.0097, 0.0230, 0.0083, 0.0122, 0.0065, 0.0213, 0.0078,
         0.0109, 0.0167, 0.0113, 0.0050, 0.0158, 0.0244, 0.0099, 0.0150, 0.0099,
         0.0150, 0.0186, 0.0093, 0.0128, 0.0095, 0.0104]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.8371, -0.4350, -0.1203,  0.1388,  0.2623, -0.1381,  0.1425, -0.1709,
         -0.1245, -0.0888,  0.5167, -0.0503,  0.2070, -0.6021,  0.0608, -0.1987,
         -0.3646, -0.0531, -0.1138, -0.5104, -0.0767,  0.5058, -0.1982,  0.0588,
          0.3791, -0.4993, -0.5901, -1.0961, -0.6493,  0.0908, -0.2391,  0.1073,
         -0.7489,  0.7295,  0.2596,  0.3267, -0.1047,  0.7996, -0.8613,  0.3686,
          0.4203, -0.4423,  0.5707,  0.1610,  0.3555,  0.3345, -1.0478, -0.3713,
         -0.5038,  0.0863, -0.1419, -0.4934, -0.8673,  0.3705, -0.3195, -0.6735,
         -0.2469,  0.2001,  0.3033, -0.9335,  0.0545, -0.2929, -0.3618,  0.1377,
         -0.0103,  0.7534,  0.1869,  0.5583,  0.3193,  0.4176, -0.4250, -0.1492,
         -0.4287, -0.1259, -0.3941,  0.0423,  0.3032,  0.6204, -0.5682,  0.5055,
         -0.0112, -0.2261, -0.3014,  0.0365, -0.0724, -0.0967, -0.2771]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.8371, -0.4350, -0.1203,  0.1388,  0.2623, -0.1381,  0.1425, -0.1709,
         -0.1245, -0.0888,  0.5167, -0.0503,  0.2070, -0.6021,  0.0608, -0.1987,
         -0.3646, -0.0531, -0.1138, -0.5104, -0.0767,  0.5058, -0.1982,  0.0588,
          0.3791, -0.4993, -0.5901, -1.0961, -0.6493,  0.0908, -0.2391,  0.1073,
         -0.7489,  0.7295,  0.2596,  0.3267, -0.1047,  0.7996, -0.8613,  0.3686,
          0.4203, -0.4423,  0.5707,  0.1610,  0.3555,  0.3345, -1.0478, -0.3713,
         -0.5038,  0.0863, -0.1419, -0.4934, -0.8673,  0.3705, -0.3195, -0.6735,
         -0.2469,  0.2001,  0.3033, -0.9335,  0.0545, -0.2929, -0.3618,  0.1377,
         -0.0103,  0.7534,  0.1869,  0.5583,  0.3193,  0.4176, -0.4250, -0.1492,
         -0.4287, -0.1259, -0.3941,  0.0423,  0.3032,  0.6204, -0.5682,  0.5055,
         -0.0112, -0.2261, -0.3014,  0.0365, -0.0724, -0.0967, -0.2771]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0258, 0.0072, 0.0099, 0.0128, 0.0145, 0.0097, 0.0129, 0.0094, 0.0099,
         0.0102, 0.0187, 0.0106, 0.0137, 0.0061, 0.0119, 0.0092, 0.0078, 0.0106,
         0.0100, 0.0067, 0.0103, 0.0185, 0.0092, 0.0118, 0.0163, 0.0068, 0.0062,
         0.0037, 0.0058, 0.0122, 0.0088, 0.0124, 0.0053, 0.0232, 0.0145, 0.0155,
         0.0101, 0.0249, 0.0047, 0.0161, 0.0170, 0.0072, 0.0198, 0.0131, 0.0159,
         0.0156, 0.0039, 0.0077, 0.0067, 0.0122, 0.0097, 0.0068, 0.0047, 0.0162,
         0.0081, 0.0057, 0.0087, 0.0136, 0.0151, 0.0044, 0.0118, 0.0083, 0.0078,
         0.0128, 0.0111, 0.0237, 0.0135, 0.0195, 0.0154, 0.0170, 0.0073, 0.0096,
         0.0073, 0.0098, 0.0075, 0.0117, 0.0151, 0.0208, 0.0063, 0.0185, 0.0110,
         0.0089, 0.0083, 0.0116, 0.0104, 0.0101, 0.0085]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.1059,  0.4204, -0.0871, -0.0223,  0.5913,  0.4600,  0.0750, -0.3833,
         -0.5282, -0.3295, -0.1655, -0.0531, -0.3723, -0.4410, -0.1994, -0.4021,
          0.2468,  0.9976,  0.0042,  0.1281,  0.1438,  0.0852, -0.3632, -0.1089,
         -0.6019,  0.6493,  0.4552, -0.3914, -0.3568,  0.1243, -0.6291,  0.6348,
         -0.4925,  0.2659, -0.0345, -0.0702, -0.2178,  0.1542, -0.2590, -0.3578,
          0.6005, -0.0854,  0.2678, -0.2066, -0.5568,  0.0215, -0.3391,  0.1590,
          0.2220,  0.5461,  0.2280, -0.3645, -0.0856, -0.0292, -0.1523,  0.2141,
         -0.3563, -0.0663,  0.1054, -0.0945,  0.3674,  0.2956,  0.1259, -0.3520,
          0.1927, -0.0413, -0.6210, -0.0731,  0.4858, -0.2010, -0.4369,  0.4468,
          0.3842, -0.6813,  0.0715, -0.4760,  0.0262, -0.6545,  0.1117,  0.4472,
         -0.5833, -0.4730,  0.5079, -0.4464,  0.5492, -0.6725, -0.7793]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.1059,  0.4204, -0.0871, -0.0223,  0.5913,  0.4600,  0.0750, -0.3833,
         -0.5282, -0.3295, -0.1655, -0.0531, -0.3723, -0.4410, -0.1994, -0.4021,
          0.2468,  0.9976,  0.0042,  0.1281,  0.1438,  0.0852, -0.3632, -0.1089,
         -0.6019,  0.6493,  0.4552, -0.3914, -0.3568,  0.1243, -0.6291,  0.6348,
         -0.4925,  0.2659, -0.0345, -0.0702, -0.2178,  0.1542, -0.2590, -0.3578,
          0.6005, -0.0854,  0.2678, -0.2066, -0.5568,  0.0215, -0.3391,  0.1590,
          0.2220,  0.5461,  0.2280, -0.3645, -0.0856, -0.0292, -0.1523,  0.2141,
         -0.3563, -0.0663,  0.1054, -0.0945,  0.3674,  0.2956,  0.1259, -0.3520,
          0.1927, -0.0413, -0.6210, -0.0731,  0.4858, -0.2010, -0.4369,  0.4468,
          0.3842, -0.6813,  0.0715, -0.4760,  0.0262, -0.6545,  0.1117,  0.4472,
         -0.5833, -0.4730,  0.5079, -0.4464,  0.5492, -0.6725, -0.7793]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0124, 0.0170, 0.0102, 0.0109, 0.0201, 0.0177, 0.0120, 0.0076, 0.0066,
         0.0080, 0.0094, 0.0106, 0.0077, 0.0072, 0.0091, 0.0075, 0.0143, 0.0302,
         0.0112, 0.0127, 0.0129, 0.0121, 0.0078, 0.0100, 0.0061, 0.0213, 0.0176,
         0.0075, 0.0078, 0.0126, 0.0059, 0.0210, 0.0068, 0.0145, 0.0108, 0.0104,
         0.0090, 0.0130, 0.0086, 0.0078, 0.0203, 0.0102, 0.0146, 0.0091, 0.0064,
         0.0114, 0.0079, 0.0131, 0.0139, 0.0192, 0.0140, 0.0077, 0.0102, 0.0108,
         0.0096, 0.0138, 0.0078, 0.0104, 0.0124, 0.0101, 0.0161, 0.0150, 0.0126,
         0.0078, 0.0135, 0.0107, 0.0060, 0.0104, 0.0181, 0.0091, 0.0072, 0.0174,
         0.0164, 0.0056, 0.0120, 0.0069, 0.0114, 0.0058, 0.0125, 0.0174, 0.0062,
         0.0069, 0.0185, 0.0071, 0.0193, 0.0057, 0.0051]], device='cuda:0')
Sum of probabilities per row: tensor([1.0000], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.5982,  0.3179, -0.1302, -0.7965, -0.5944,  0.1717,  0.2126, -0.5083,
          0.0463, -0.6043,  0.0543,  0.3430, -0.1288,  0.2615, -0.3374, -0.4700,
          0.3524,  0.1642, -0.2123,  0.0539, -0.3237, -0.5490,  0.0389,  0.0720,
         -0.5873, -0.3180,  0.2163, -0.0934,  0.0802, -0.0937, -0.1802, -0.0716,
         -0.8391,  0.4593,  0.7078,  0.4970, -0.5993,  0.4482, -0.3120,  0.5874,
          0.1106,  0.1752,  0.2233, -0.1584,  0.0308,  0.3950, -0.0262, -0.6809,
          0.1228,  0.1666, -0.0641,  0.2356, -0.3583, -0.1469, -0.2865, -0.1627,
         -0.3222, -0.9550, -0.3464,  0.1246,  0.3789, -0.3599, -0.3727, -0.3860,
          0.4832,  0.3874,  0.3958, -0.1239, -0.0233,  0.1329,  0.2427,  0.5799,
         -0.0297,  0.1680,  0.1450, -0.1802,  0.3256,  0.4333, -0.0354, -0.2512,
         -0.3287,  0.2266,  0.2996, -0.5896,  0.2498, -0.3854,  0.2225]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.5982,  0.3179, -0.1302, -0.7965, -0.5944,  0.1717,  0.2126, -0.5083,
          0.0463, -0.6043,  0.0543,  0.3430, -0.1288,  0.2615, -0.3374, -0.4700,
          0.3524,  0.1642, -0.2123,  0.0539, -0.3237, -0.5490,  0.0389,  0.0720,
         -0.5873, -0.3180,  0.2163, -0.0934,  0.0802, -0.0937, -0.1802, -0.0716,
         -0.8391,  0.4593,  0.7078,  0.4970, -0.5993,  0.4482, -0.3120,  0.5874,
          0.1106,  0.1752,  0.2233, -0.1584,  0.0308,  0.3950, -0.0262, -0.6809,
          0.1228,  0.1666, -0.0641,  0.2356, -0.3583, -0.1469, -0.2865, -0.1627,
         -0.3222, -0.9550, -0.3464,  0.1246,  0.3789, -0.3599, -0.3727, -0.3860,
          0.4832,  0.3874,  0.3958, -0.1239, -0.0233,  0.1329,  0.2427,  0.5799,
         -0.0297,  0.1680,  0.1450, -0.1802,  0.3256,  0.4333, -0.0354, -0.2512,
         -0.3287,  0.2266,  0.2996, -0.5896,  0.2498, -0.3854,  0.2225]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0202, 0.0152, 0.0097, 0.0050, 0.0061, 0.0132, 0.0137, 0.0067, 0.0116,
         0.0061, 0.0117, 0.0156, 0.0097, 0.0144, 0.0079, 0.0069, 0.0158, 0.0131,
         0.0090, 0.0117, 0.0080, 0.0064, 0.0115, 0.0119, 0.0062, 0.0081, 0.0138,
         0.0101, 0.0120, 0.0101, 0.0093, 0.0103, 0.0048, 0.0176, 0.0225, 0.0182,
         0.0061, 0.0174, 0.0081, 0.0199, 0.0124, 0.0132, 0.0139, 0.0095, 0.0114,
         0.0165, 0.0108, 0.0056, 0.0125, 0.0131, 0.0104, 0.0140, 0.0077, 0.0096,
         0.0083, 0.0094, 0.0080, 0.0043, 0.0078, 0.0126, 0.0162, 0.0077, 0.0076,
         0.0075, 0.0180, 0.0163, 0.0165, 0.0098, 0.0108, 0.0127, 0.0141, 0.0198,
         0.0108, 0.0131, 0.0128, 0.0093, 0.0154, 0.0171, 0.0107, 0.0086, 0.0080,
         0.0139, 0.0150, 0.0061, 0.0142, 0.0075, 0.0139]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.5293, -0.3280,  0.3551, -0.4330, -0.0907, -0.0739,  0.3556, -0.4806,
         -0.0358,  0.0846, -0.0351,  0.1131, -0.1929, -0.4329,  0.0674, -1.0566,
         -0.4907,  0.5761,  0.4809, -0.4987, -0.2166, -0.4750, -0.3618, -0.1107,
         -0.8267, -0.0217,  0.0991, -0.2940, -0.3927, -0.6058, -0.3584, -0.2813,
         -0.5047,  0.6569, -0.4417, -0.0450, -0.2032,  0.4794, -0.4062,  1.0199,
          0.2724, -0.2458, -0.9941, -0.1609, -0.3032, -0.2190, -0.2946, -0.0596,
          0.0966,  0.2436,  0.6503, -0.0040,  0.2623,  0.2742, -0.1343,  0.0825,
         -0.0734, -0.8412,  0.4371, -0.6269,  0.0857,  0.0257, -0.5933, -0.2291,
          0.1101,  0.1865, -0.2054,  0.1673,  0.5241, -0.5246, -0.2273,  0.1725,
          0.2854, -0.0933, -0.1129,  0.2587,  0.0204,  0.2465, -0.1532, -0.1014,
         -0.1766,  0.2409, -0.1770,  0.1384, -0.6605,  0.0553, -0.1618]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.5293, -0.3280,  0.3551, -0.4330, -0.0907, -0.0739,  0.3556, -0.4806,
         -0.0358,  0.0846, -0.0351,  0.1131, -0.1929, -0.4329,  0.0674, -1.0566,
         -0.4907,  0.5761,  0.4809, -0.4987, -0.2166, -0.4750, -0.3618, -0.1107,
         -0.8267, -0.0217,  0.0991, -0.2940, -0.3927, -0.6058, -0.3584, -0.2813,
         -0.5047,  0.6569, -0.4417, -0.0450, -0.2032,  0.4794, -0.4062,  1.0199,
          0.2724, -0.2458, -0.9941, -0.1609, -0.3032, -0.2190, -0.2946, -0.0596,
          0.0966,  0.2436,  0.6503, -0.0040,  0.2623,  0.2742, -0.1343,  0.0825,
         -0.0734, -0.8412,  0.4371, -0.6269,  0.0857,  0.0257, -0.5933, -0.2291,
          0.1101,  0.1865, -0.2054,  0.1673,  0.5241, -0.5246, -0.2273,  0.1725,
          0.2854, -0.0933, -0.1129,  0.2587,  0.0204,  0.2465, -0.1532, -0.1014,
         -0.1766,  0.2409, -0.1770,  0.1384, -0.6605,  0.0553, -0.1618]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0198, 0.0084, 0.0166, 0.0076, 0.0106, 0.0108, 0.0166, 0.0072, 0.0112,
         0.0127, 0.0112, 0.0130, 0.0096, 0.0076, 0.0125, 0.0040, 0.0071, 0.0207,
         0.0188, 0.0071, 0.0094, 0.0072, 0.0081, 0.0104, 0.0051, 0.0114, 0.0129,
         0.0087, 0.0079, 0.0064, 0.0081, 0.0088, 0.0070, 0.0225, 0.0075, 0.0111,
         0.0095, 0.0188, 0.0078, 0.0323, 0.0153, 0.0091, 0.0043, 0.0099, 0.0086,
         0.0094, 0.0087, 0.0110, 0.0128, 0.0149, 0.0223, 0.0116, 0.0151, 0.0153,
         0.0102, 0.0126, 0.0108, 0.0050, 0.0180, 0.0062, 0.0127, 0.0119, 0.0064,
         0.0093, 0.0130, 0.0140, 0.0095, 0.0138, 0.0197, 0.0069, 0.0093, 0.0138,
         0.0155, 0.0106, 0.0104, 0.0151, 0.0119, 0.0149, 0.0100, 0.0105, 0.0098,
         0.0148, 0.0098, 0.0134, 0.0060, 0.0123, 0.0099]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.4196, -0.0169,  0.4898, -0.0493, -0.0923,  0.0188,  0.2358, -0.4845,
         -0.0163, -0.5974,  0.4402, -0.1826, -0.0871,  0.1503, -0.2091, -0.1203,
         -0.1964,  0.1086, -0.9508, -0.4215, -0.2874, -0.0190,  0.2537, -0.1526,
         -0.5017,  0.6803,  0.2507, -0.6295, -0.2342,  0.1482, -0.3761, -0.4649,
         -0.4332,  0.4148,  0.1152,  0.2411, -0.3578,  0.4235, -1.1139,  0.8757,
          0.9410,  0.1610, -0.2251, -0.5605, -0.1818,  0.3468, -0.2982,  0.0213,
         -0.2149, -0.4899,  0.2437, -0.4789, -0.1439,  0.3844, -0.6921,  0.2670,
         -0.2103, -0.6308,  0.1346, -0.1148,  0.3485,  0.0623, -0.4332,  0.0082,
         -0.2625,  0.0464, -0.2912,  0.0920,  0.1377, -0.1518, -0.5644,  0.0070,
         -0.1943,  0.1001, -0.2911, -0.1097,  0.4367, -0.0633, -0.0569,  0.1411,
          0.0487,  0.1740,  0.1289, -0.4355,  0.2878, -0.7495,  0.3629]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.4196, -0.0169,  0.4898, -0.0493, -0.0923,  0.0188,  0.2358, -0.4845,
         -0.0163, -0.5974,  0.4402, -0.1826, -0.0871,  0.1503, -0.2091, -0.1203,
         -0.1964,  0.1086, -0.9508, -0.4215, -0.2874, -0.0190,  0.2537, -0.1526,
         -0.5017,  0.6803,  0.2507, -0.6295, -0.2342,  0.1482, -0.3761, -0.4649,
         -0.4332,  0.4148,  0.1152,  0.2411, -0.3578,  0.4235, -1.1139,  0.8757,
          0.9410,  0.1610, -0.2251, -0.5605, -0.1818,  0.3468, -0.2982,  0.0213,
         -0.2149, -0.4899,  0.2437, -0.4789, -0.1439,  0.3844, -0.6921,  0.2670,
         -0.2103, -0.6308,  0.1346, -0.1148,  0.3485,  0.0623, -0.4332,  0.0082,
         -0.2625,  0.0464, -0.2912,  0.0920,  0.1377, -0.1518, -0.5644,  0.0070,
         -0.1943,  0.1001, -0.2911, -0.1097,  0.4367, -0.0633, -0.0569,  0.1411,
          0.0487,  0.1740,  0.1289, -0.4355,  0.2878, -0.7495,  0.3629]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0174, 0.0113, 0.0187, 0.0109, 0.0104, 0.0117, 0.0145, 0.0070, 0.0113,
         0.0063, 0.0178, 0.0095, 0.0105, 0.0133, 0.0093, 0.0101, 0.0094, 0.0128,
         0.0044, 0.0075, 0.0086, 0.0112, 0.0147, 0.0098, 0.0069, 0.0226, 0.0147,
         0.0061, 0.0091, 0.0133, 0.0079, 0.0072, 0.0074, 0.0173, 0.0128, 0.0146,
         0.0080, 0.0175, 0.0038, 0.0275, 0.0293, 0.0134, 0.0091, 0.0065, 0.0095,
         0.0162, 0.0085, 0.0117, 0.0092, 0.0070, 0.0146, 0.0071, 0.0099, 0.0168,
         0.0057, 0.0149, 0.0093, 0.0061, 0.0131, 0.0102, 0.0162, 0.0122, 0.0074,
         0.0115, 0.0088, 0.0120, 0.0086, 0.0125, 0.0131, 0.0098, 0.0065, 0.0115,
         0.0094, 0.0126, 0.0086, 0.0103, 0.0177, 0.0107, 0.0108, 0.0132, 0.0120,
         0.0136, 0.0130, 0.0074, 0.0153, 0.0054, 0.0164]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.0882, -0.3607,  0.2138, -0.2238,  0.8242,  0.2122,  0.3614, -0.1232,
         -0.5046, -0.3817,  0.7220,  1.0241, -0.4126,  0.2517, -0.5131, -0.9059,
         -0.0147,  0.2053, -0.2083, -0.2697, -0.6288,  0.0883, -0.6477, -0.3637,
         -0.4762, -0.0419,  0.2472, -0.8501,  0.4870, -0.3198, -0.0053,  0.5284,
         -0.3154, -0.4213,  0.1522,  0.2256,  0.1894,  0.6477, -0.1419,  0.7160,
          0.4280,  0.1555, -0.2712, -0.4135,  0.2740,  0.1668,  0.2005, -0.6031,
         -0.0609,  0.4744, -0.3849,  0.4070, -0.1257,  0.1849, -0.0795,  0.1894,
         -0.1914,  0.1604,  0.1000, -0.8775,  0.2330, -0.0713, -0.3150, -0.3477,
         -0.1761,  0.2078,  0.0496, -0.4656,  0.2824,  0.4434, -0.4312, -0.1721,
         -0.1229,  0.0401, -0.0741, -0.6541,  0.3125,  0.6669, -0.1658, -0.4399,
          0.0468, -0.2967,  0.2869,  0.3324,  0.5901, -0.4967,  0.7278]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.0882, -0.3607,  0.2138, -0.2238,  0.8242,  0.2122,  0.3614, -0.1232,
         -0.5046, -0.3817,  0.7220,  1.0241, -0.4126,  0.2517, -0.5131, -0.9059,
         -0.0147,  0.2053, -0.2083, -0.2697, -0.6288,  0.0883, -0.6477, -0.3637,
         -0.4762, -0.0419,  0.2472, -0.8501,  0.4870, -0.3198, -0.0053,  0.5284,
         -0.3154, -0.4213,  0.1522,  0.2256,  0.1894,  0.6477, -0.1419,  0.7160,
          0.4280,  0.1555, -0.2712, -0.4135,  0.2740,  0.1668,  0.2005, -0.6031,
         -0.0609,  0.4744, -0.3849,  0.4070, -0.1257,  0.1849, -0.0795,  0.1894,
         -0.1914,  0.1604,  0.1000, -0.8775,  0.2330, -0.0713, -0.3150, -0.3477,
         -0.1761,  0.2078,  0.0496, -0.4656,  0.2824,  0.4434, -0.4312, -0.1721,
         -0.1229,  0.0401, -0.0741, -0.6541,  0.3125,  0.6669, -0.1658, -0.4399,
          0.0468, -0.2967,  0.2869,  0.3324,  0.5901, -0.4967,  0.7278]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0117, 0.0075, 0.0133, 0.0086, 0.0244, 0.0132, 0.0154, 0.0095, 0.0065,
         0.0073, 0.0221, 0.0298, 0.0071, 0.0138, 0.0064, 0.0043, 0.0106, 0.0132,
         0.0087, 0.0082, 0.0057, 0.0117, 0.0056, 0.0074, 0.0067, 0.0103, 0.0137,
         0.0046, 0.0174, 0.0078, 0.0107, 0.0182, 0.0078, 0.0070, 0.0125, 0.0134,
         0.0129, 0.0205, 0.0093, 0.0219, 0.0164, 0.0125, 0.0082, 0.0071, 0.0141,
         0.0127, 0.0131, 0.0059, 0.0101, 0.0172, 0.0073, 0.0161, 0.0094, 0.0129,
         0.0099, 0.0129, 0.0088, 0.0126, 0.0118, 0.0045, 0.0135, 0.0100, 0.0078,
         0.0076, 0.0090, 0.0132, 0.0113, 0.0067, 0.0142, 0.0167, 0.0070, 0.0090,
         0.0095, 0.0112, 0.0099, 0.0056, 0.0146, 0.0209, 0.0091, 0.0069, 0.0112,
         0.0080, 0.0143, 0.0149, 0.0193, 0.0065, 0.0222]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.8263,  0.5038,  0.3565, -1.1717, -0.1760,  0.1094, -0.0655, -0.5467,
          0.0428, -0.0485,  0.2690,  0.4369,  0.0904,  0.1847, -0.3908, -1.0476,
          0.0522, -0.0114, -0.1171,  0.6127,  0.1479, -0.0764, -0.3400,  0.3441,
         -0.3888, -0.1614, -0.0271,  0.2651, -0.3731, -0.4615, -0.4317,  0.0632,
         -0.3937,  0.3188,  0.6835,  0.1572, -0.2554, -0.0289,  0.1371,  0.2426,
          0.2879, -0.5085,  0.0616, -0.0502,  0.1651,  0.1102, -0.4191,  0.1152,
         -0.3280, -0.1059,  0.0260,  0.2142, -0.5704,  0.1966,  0.2564, -0.1349,
         -0.2228, -0.0318,  0.1184, -0.0563,  0.0703, -0.3984, -0.4320, -0.4672,
          0.5872,  0.3424,  0.2357,  0.0429, -0.1772, -0.0903,  0.0558, -0.1160,
          0.1919,  0.2606, -0.0092,  0.0228,  0.5044,  0.3176, -0.5240,  0.2777,
          0.1740,  0.0616,  0.1940, -0.2246,  0.3640, -0.0680,  0.6793]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.8263,  0.5038,  0.3565, -1.1717, -0.1760,  0.1094, -0.0655, -0.5467,
          0.0428, -0.0485,  0.2690,  0.4369,  0.0904,  0.1847, -0.3908, -1.0476,
          0.0522, -0.0114, -0.1171,  0.6127,  0.1479, -0.0764, -0.3400,  0.3441,
         -0.3888, -0.1614, -0.0271,  0.2651, -0.3731, -0.4615, -0.4317,  0.0632,
         -0.3937,  0.3188,  0.6835,  0.1572, -0.2554, -0.0289,  0.1371,  0.2426,
          0.2879, -0.5085,  0.0616, -0.0502,  0.1651,  0.1102, -0.4191,  0.1152,
         -0.3280, -0.1059,  0.0260,  0.2142, -0.5704,  0.1966,  0.2564, -0.1349,
         -0.2228, -0.0318,  0.1184, -0.0563,  0.0703, -0.3984, -0.4320, -0.4672,
          0.5872,  0.3424,  0.2357,  0.0429, -0.1772, -0.0903,  0.0558, -0.1160,
          0.1919,  0.2606, -0.0092,  0.0228,  0.5044,  0.3176, -0.5240,  0.2777,
          0.1740,  0.0616,  0.1940, -0.2246,  0.3640, -0.0680,  0.6793]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0247, 0.0179, 0.0154, 0.0033, 0.0091, 0.0121, 0.0101, 0.0063, 0.0113,
         0.0103, 0.0141, 0.0167, 0.0118, 0.0130, 0.0073, 0.0038, 0.0114, 0.0107,
         0.0096, 0.0199, 0.0125, 0.0100, 0.0077, 0.0152, 0.0073, 0.0092, 0.0105,
         0.0141, 0.0074, 0.0068, 0.0070, 0.0115, 0.0073, 0.0149, 0.0214, 0.0126,
         0.0084, 0.0105, 0.0124, 0.0138, 0.0144, 0.0065, 0.0115, 0.0103, 0.0127,
         0.0121, 0.0071, 0.0121, 0.0078, 0.0097, 0.0111, 0.0134, 0.0061, 0.0132,
         0.0140, 0.0094, 0.0086, 0.0105, 0.0122, 0.0102, 0.0116, 0.0073, 0.0070,
         0.0068, 0.0194, 0.0152, 0.0137, 0.0113, 0.0091, 0.0099, 0.0114, 0.0096,
         0.0131, 0.0140, 0.0107, 0.0111, 0.0179, 0.0148, 0.0064, 0.0143, 0.0129,
         0.0115, 0.0131, 0.0086, 0.0156, 0.0101, 0.0213]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.4572,  0.0757,  0.1249,  0.0794,  0.0873,  0.0172,  0.1135, -0.1534,
          0.1680, -0.7389,  0.1652,  0.6341, -0.0301, -0.1006, -0.9112, -0.9173,
         -0.4404,  0.9134, -0.4431,  0.5590, -0.3181, -0.0017, -0.0567,  0.2051,
         -0.1893, -0.2942, -0.3024, -0.4441, -0.0149,  0.0391,  0.3606,  0.6224,
         -1.2392,  0.0173,  0.0505,  0.3368, -0.1098,  1.0047, -0.4505, -0.2772,
          0.9691,  0.0047, -0.1924, -0.2190, -0.1924,  0.2927, -0.0527, -0.7302,
         -0.2102, -0.0424, -0.4694,  0.2594, -0.1694,  0.4553, -0.6466, -0.2229,
         -0.4827, -0.1770,  0.6195, -0.4697, -0.2648,  0.3228,  0.5995, -0.2331,
          0.5371,  0.3078,  0.1009, -0.1619,  0.2004, -0.5042,  0.2907,  0.3514,
          0.1369,  0.3429,  0.4104, -0.0954,  0.6522,  0.5408, -0.5224,  0.2341,
         -0.3090, -0.2865,  0.1272, -0.3818,  0.8208, -0.8778,  0.0488]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.4572,  0.0757,  0.1249,  0.0794,  0.0873,  0.0172,  0.1135, -0.1534,
          0.1680, -0.7389,  0.1652,  0.6341, -0.0301, -0.1006, -0.9112, -0.9173,
         -0.4404,  0.9134, -0.4431,  0.5590, -0.3181, -0.0017, -0.0567,  0.2051,
         -0.1893, -0.2942, -0.3024, -0.4441, -0.0149,  0.0391,  0.3606,  0.6224,
         -1.2392,  0.0173,  0.0505,  0.3368, -0.1098,  1.0047, -0.4505, -0.2772,
          0.9691,  0.0047, -0.1924, -0.2190, -0.1924,  0.2927, -0.0527, -0.7302,
         -0.2102, -0.0424, -0.4694,  0.2594, -0.1694,  0.4553, -0.6466, -0.2229,
         -0.4827, -0.1770,  0.6195, -0.4697, -0.2648,  0.3228,  0.5995, -0.2331,
          0.5371,  0.3078,  0.1009, -0.1619,  0.2004, -0.5042,  0.2907,  0.3514,
          0.1369,  0.3429,  0.4104, -0.0954,  0.6522,  0.5408, -0.5224,  0.2341,
         -0.3090, -0.2865,  0.1272, -0.3818,  0.8208, -0.8778,  0.0488]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0166, 0.0114, 0.0119, 0.0114, 0.0115, 0.0107, 0.0118, 0.0090, 0.0125,
         0.0050, 0.0124, 0.0199, 0.0102, 0.0095, 0.0042, 0.0042, 0.0068, 0.0263,
         0.0068, 0.0184, 0.0077, 0.0105, 0.0099, 0.0129, 0.0087, 0.0078, 0.0078,
         0.0068, 0.0104, 0.0110, 0.0151, 0.0196, 0.0030, 0.0107, 0.0111, 0.0147,
         0.0094, 0.0288, 0.0067, 0.0080, 0.0278, 0.0106, 0.0087, 0.0085, 0.0087,
         0.0141, 0.0100, 0.0051, 0.0085, 0.0101, 0.0066, 0.0136, 0.0089, 0.0166,
         0.0055, 0.0084, 0.0065, 0.0088, 0.0196, 0.0066, 0.0081, 0.0145, 0.0192,
         0.0083, 0.0180, 0.0143, 0.0116, 0.0090, 0.0129, 0.0064, 0.0141, 0.0150,
         0.0121, 0.0148, 0.0159, 0.0096, 0.0202, 0.0181, 0.0062, 0.0133, 0.0077,
         0.0079, 0.0120, 0.0072, 0.0239, 0.0044, 0.0111]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.1174, -0.4832,  0.4540, -0.5447,  0.3064,  0.2616,  0.4658,  0.1769,
          0.1447, -0.1924, -0.1151, -0.1179,  0.5554,  0.0468, -0.1637, -0.8486,
         -0.0933, -0.0765, -0.1945,  0.3231, -0.4754,  0.1660, -0.2056, -0.3380,
         -0.8220, -0.0977, -0.1506,  0.0761,  0.1335,  0.4785,  0.0420,  0.8850,
          0.2047,  0.2241,  0.3004, -0.2084,  0.5453,  0.2247,  0.1191, -0.0208,
         -0.0426,  0.5676,  0.3622,  0.1548, -0.1908,  0.2865, -0.5459, -0.3651,
          0.3619, -0.4418,  0.3610,  0.5508, -0.4586,  0.3184, -0.1847, -0.0011,
         -0.5904,  0.2676,  0.1975,  0.3048, -1.0090, -0.2201,  0.1195,  0.0286,
         -0.1407, -0.3105,  0.2733,  0.0347,  0.3389, -0.5952, -0.0248,  0.9653,
         -0.1438,  0.3284, -0.5079, -0.0110,  0.2508,  0.4343,  0.0463,  0.5406,
          0.4858, -0.0861,  0.2570, -0.1180,  0.6731, -1.0033,  0.2312]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.1174, -0.4832,  0.4540, -0.5447,  0.3064,  0.2616,  0.4658,  0.1769,
          0.1447, -0.1924, -0.1151, -0.1179,  0.5554,  0.0468, -0.1637, -0.8486,
         -0.0933, -0.0765, -0.1945,  0.3231, -0.4754,  0.1660, -0.2056, -0.3380,
         -0.8220, -0.0977, -0.1506,  0.0761,  0.1335,  0.4785,  0.0420,  0.8850,
          0.2047,  0.2241,  0.3004, -0.2084,  0.5453,  0.2247,  0.1191, -0.0208,
         -0.0426,  0.5676,  0.3622,  0.1548, -0.1908,  0.2865, -0.5459, -0.3651,
          0.3619, -0.4418,  0.3610,  0.5508, -0.4586,  0.3184, -0.1847, -0.0011,
         -0.5904,  0.2676,  0.1975,  0.3048, -1.0090, -0.2201,  0.1195,  0.0286,
         -0.1407, -0.3105,  0.2733,  0.0347,  0.3389, -0.5952, -0.0248,  0.9653,
         -0.1438,  0.3284, -0.5079, -0.0110,  0.2508,  0.4343,  0.0463,  0.5406,
          0.4858, -0.0861,  0.2570, -0.1180,  0.6731, -1.0033,  0.2312]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0116, 0.0064, 0.0163, 0.0060, 0.0141, 0.0134, 0.0165, 0.0124, 0.0120,
         0.0085, 0.0092, 0.0092, 0.0180, 0.0108, 0.0088, 0.0044, 0.0094, 0.0096,
         0.0085, 0.0143, 0.0064, 0.0122, 0.0084, 0.0074, 0.0045, 0.0094, 0.0089,
         0.0112, 0.0118, 0.0167, 0.0108, 0.0251, 0.0127, 0.0129, 0.0140, 0.0084,
         0.0179, 0.0130, 0.0117, 0.0101, 0.0099, 0.0183, 0.0149, 0.0121, 0.0086,
         0.0138, 0.0060, 0.0072, 0.0149, 0.0067, 0.0148, 0.0180, 0.0065, 0.0142,
         0.0086, 0.0103, 0.0057, 0.0135, 0.0126, 0.0140, 0.0038, 0.0083, 0.0117,
         0.0106, 0.0090, 0.0076, 0.0136, 0.0107, 0.0145, 0.0057, 0.0101, 0.0272,
         0.0090, 0.0144, 0.0062, 0.0102, 0.0133, 0.0160, 0.0108, 0.0178, 0.0168,
         0.0095, 0.0134, 0.0092, 0.0203, 0.0038, 0.0130]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.5442, -0.4113,  0.4042, -0.0600, -0.0212,  0.0947,  0.0086,  0.2233,
         -0.1332,  0.1505, -0.2939,  0.2530,  0.2214,  0.2190, -0.2210, -0.4286,
         -0.5261, -0.0133, -0.0607, -0.0924, -0.5481, -0.1495, -0.0600, -0.4370,
          0.4662,  0.0412, -0.2303, -0.4233, -0.0235,  0.4915,  0.3886, -0.7203,
         -0.1258,  0.2393, -0.2728,  0.0356, -0.0935,  0.6401, -0.5610,  0.2640,
          0.2076, -0.0677, -0.3585,  0.1390, -0.0084, -0.2073, -0.1278, -0.9362,
         -0.3586,  0.5172, -0.1849, -0.5806, -0.3976, -0.3504,  0.3562, -0.2295,
          0.0598, -0.0909,  0.3786, -0.2411,  0.2678, -0.3365,  0.0514, -0.4370,
          0.0363,  0.2190,  0.2033, -0.6389,  0.0542, -0.1986, -0.5045,  0.2743,
          0.0403,  0.2795,  0.2004, -0.8024, -0.0641, -0.2014,  0.2005,  0.1177,
         -0.5772,  0.6279, -0.3522, -0.1053, -0.1522, -0.7177,  0.6214]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.5442, -0.4113,  0.4042, -0.0600, -0.0212,  0.0947,  0.0086,  0.2233,
         -0.1332,  0.1505, -0.2939,  0.2530,  0.2214,  0.2190, -0.2210, -0.4286,
         -0.5261, -0.0133, -0.0607, -0.0924, -0.5481, -0.1495, -0.0600, -0.4370,
          0.4662,  0.0412, -0.2303, -0.4233, -0.0235,  0.4915,  0.3886, -0.7203,
         -0.1258,  0.2393, -0.2728,  0.0356, -0.0935,  0.6401, -0.5610,  0.2640,
          0.2076, -0.0677, -0.3585,  0.1390, -0.0084, -0.2073, -0.1278, -0.9362,
         -0.3586,  0.5172, -0.1849, -0.5806, -0.3976, -0.3504,  0.3562, -0.2295,
          0.0598, -0.0909,  0.3786, -0.2411,  0.2678, -0.3365,  0.0514, -0.4370,
          0.0363,  0.2190,  0.2033, -0.6389,  0.0542, -0.1986, -0.5045,  0.2743,
          0.0403,  0.2795,  0.2004, -0.8024, -0.0641, -0.2014,  0.2005,  0.1177,
         -0.5772,  0.6279, -0.3522, -0.1053, -0.1522, -0.7177,  0.6214]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0199, 0.0077, 0.0173, 0.0109, 0.0113, 0.0127, 0.0117, 0.0144, 0.0101,
         0.0134, 0.0086, 0.0149, 0.0144, 0.0144, 0.0093, 0.0075, 0.0068, 0.0114,
         0.0109, 0.0105, 0.0067, 0.0100, 0.0109, 0.0075, 0.0184, 0.0120, 0.0092,
         0.0076, 0.0113, 0.0189, 0.0170, 0.0056, 0.0102, 0.0147, 0.0088, 0.0120,
         0.0105, 0.0219, 0.0066, 0.0150, 0.0142, 0.0108, 0.0081, 0.0133, 0.0115,
         0.0094, 0.0102, 0.0045, 0.0081, 0.0194, 0.0096, 0.0065, 0.0078, 0.0081,
         0.0165, 0.0092, 0.0123, 0.0106, 0.0169, 0.0091, 0.0151, 0.0083, 0.0122,
         0.0075, 0.0120, 0.0144, 0.0142, 0.0061, 0.0122, 0.0095, 0.0070, 0.0152,
         0.0120, 0.0153, 0.0141, 0.0052, 0.0108, 0.0094, 0.0141, 0.0130, 0.0065,
         0.0217, 0.0081, 0.0104, 0.0099, 0.0056, 0.0215]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 3.7928e-01,  4.6109e-01,  2.7011e-01, -1.0448e+00, -5.0115e-01,
          1.5729e-01, -1.0933e-01, -6.6826e-01, -4.3564e-01,  2.3590e-03,
          5.0653e-01,  3.5622e-01,  2.0589e-01,  3.2480e-01, -1.0494e-01,
         -5.2791e-01,  3.3188e-01, -4.5211e-02,  1.1635e-01,  6.1676e-02,
         -2.3238e-01, -3.5127e-02, -5.9228e-01,  2.2874e-01, -3.2755e-01,
          7.7143e-02, -2.1076e-01, -4.7638e-02, -3.6307e-01, -9.8347e-01,
         -5.6164e-01, -1.2578e-01,  7.0266e-02, -8.3107e-02,  8.0140e-01,
          1.0227e-01, -5.5979e-02, -1.9560e-01,  5.4227e-01,  2.0843e-01,
          1.5604e-01, -2.9558e-02, -6.1429e-02, -2.2572e-01,  5.8741e-02,
          1.1115e-01, -2.0111e-01, -7.3743e-02, -2.5706e-01, -3.9020e-01,
          5.2259e-01, -2.0861e-01, -2.6416e-01,  6.1430e-02,  3.2901e-01,
         -2.5028e-01,  2.9186e-02, -3.2822e-01, -8.7200e-02, -2.8203e-01,
          7.5372e-02, -5.5340e-01, -2.3307e-01, -3.5834e-01,  5.2107e-01,
          1.2574e-01,  3.0753e-01,  3.3083e-01, -3.7404e-01, -2.3823e-01,
          2.5062e-01,  2.0209e-01,  3.1340e-01, -4.1931e-02, -4.4078e-02,
         -2.2951e-01,  7.4944e-01,  3.1055e-01, -7.3999e-03,  3.8398e-02,
          2.0705e-01,  9.2065e-02,  2.7502e-01, -1.4987e-01, -6.5321e-04,
         -2.5461e-01,  7.0930e-01]], device='cuda:0')
Logits before softmax and after clamp: tensor([[ 3.7928e-01,  4.6109e-01,  2.7011e-01, -1.0448e+00, -5.0115e-01,
          1.5729e-01, -1.0933e-01, -6.6826e-01, -4.3564e-01,  2.3590e-03,
          5.0653e-01,  3.5622e-01,  2.0589e-01,  3.2480e-01, -1.0494e-01,
         -5.2791e-01,  3.3188e-01, -4.5211e-02,  1.1635e-01,  6.1676e-02,
         -2.3238e-01, -3.5127e-02, -5.9228e-01,  2.2874e-01, -3.2755e-01,
          7.7143e-02, -2.1076e-01, -4.7638e-02, -3.6307e-01, -9.8347e-01,
         -5.6164e-01, -1.2578e-01,  7.0266e-02, -8.3107e-02,  8.0140e-01,
          1.0227e-01, -5.5979e-02, -1.9560e-01,  5.4227e-01,  2.0843e-01,
          1.5604e-01, -2.9558e-02, -6.1429e-02, -2.2572e-01,  5.8741e-02,
          1.1115e-01, -2.0111e-01, -7.3743e-02, -2.5706e-01, -3.9020e-01,
          5.2259e-01, -2.0861e-01, -2.6416e-01,  6.1430e-02,  3.2901e-01,
         -2.5028e-01,  2.9186e-02, -3.2822e-01, -8.7200e-02, -2.8203e-01,
          7.5372e-02, -5.5340e-01, -2.3307e-01, -3.5834e-01,  5.2107e-01,
          1.2574e-01,  3.0753e-01,  3.3083e-01, -3.7404e-01, -2.3823e-01,
          2.5062e-01,  2.0209e-01,  3.1340e-01, -4.1931e-02, -4.4078e-02,
         -2.2951e-01,  7.4944e-01,  3.1055e-01, -7.3999e-03,  3.8398e-02,
          2.0705e-01,  9.2065e-02,  2.7502e-01, -1.4987e-01, -6.5321e-04,
         -2.5461e-01,  7.0930e-01]], device='cuda:0')
Probabilities after softmax: tensor([[0.0161, 0.0175, 0.0144, 0.0039, 0.0067, 0.0129, 0.0099, 0.0056, 0.0071,
         0.0110, 0.0183, 0.0157, 0.0135, 0.0152, 0.0099, 0.0065, 0.0154, 0.0105,
         0.0124, 0.0117, 0.0087, 0.0106, 0.0061, 0.0139, 0.0079, 0.0119, 0.0089,
         0.0105, 0.0077, 0.0041, 0.0063, 0.0097, 0.0118, 0.0101, 0.0246, 0.0122,
         0.0104, 0.0091, 0.0190, 0.0136, 0.0129, 0.0107, 0.0104, 0.0088, 0.0117,
         0.0123, 0.0090, 0.0102, 0.0085, 0.0075, 0.0186, 0.0089, 0.0085, 0.0117,
         0.0153, 0.0086, 0.0113, 0.0079, 0.0101, 0.0083, 0.0119, 0.0063, 0.0087,
         0.0077, 0.0186, 0.0125, 0.0150, 0.0153, 0.0076, 0.0087, 0.0142, 0.0135,
         0.0151, 0.0106, 0.0105, 0.0088, 0.0233, 0.0150, 0.0109, 0.0115, 0.0136,
         0.0121, 0.0145, 0.0095, 0.0110, 0.0085, 0.0224]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.5646,  0.3920, -0.0981,  0.2160,  1.0517,  0.3207,  0.0420, -0.0320,
         -0.1097, -0.4028,  0.0325,  0.1914,  0.0275, -0.1950, -0.6947, -0.5893,
          0.0980, -0.2943,  0.0220,  0.1158, -0.3104, -0.2505,  0.3255, -0.0707,
         -0.2476, -0.5331, -0.1288,  0.1413,  0.6407, -0.4370,  0.0258,  0.8118,
         -0.4375, -0.1351,  0.5375, -0.0453,  0.1602,  0.5079,  0.2439, -0.4231,
         -0.6002, -0.0623,  0.3752,  0.0068,  0.6924,  0.0484,  0.0414,  0.3893,
         -0.3205, -0.0575, -0.3747,  0.6404, -0.2267, -0.2372, -0.0045, -0.0265,
         -0.4397, -0.0529, -0.4221,  0.2218, -0.2070,  0.0767,  0.1124, -0.2124,
          0.3575,  0.0033,  0.3693, -0.3954, -0.2656, -0.0657, -0.0529,  0.2592,
         -0.1894,  0.3250, -0.5775, -0.0678,  0.2615,  0.2640, -0.1111, -0.0295,
         -0.0796,  0.3253,  0.2914,  0.4859,  0.5804, -0.3704, -0.1030]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.5646,  0.3920, -0.0981,  0.2160,  1.0517,  0.3207,  0.0420, -0.0320,
         -0.1097, -0.4028,  0.0325,  0.1914,  0.0275, -0.1950, -0.6947, -0.5893,
          0.0980, -0.2943,  0.0220,  0.1158, -0.3104, -0.2505,  0.3255, -0.0707,
         -0.2476, -0.5331, -0.1288,  0.1413,  0.6407, -0.4370,  0.0258,  0.8118,
         -0.4375, -0.1351,  0.5375, -0.0453,  0.1602,  0.5079,  0.2439, -0.4231,
         -0.6002, -0.0623,  0.3752,  0.0068,  0.6924,  0.0484,  0.0414,  0.3893,
         -0.3205, -0.0575, -0.3747,  0.6404, -0.2267, -0.2372, -0.0045, -0.0265,
         -0.4397, -0.0529, -0.4221,  0.2218, -0.2070,  0.0767,  0.1124, -0.2124,
          0.3575,  0.0033,  0.3693, -0.3954, -0.2656, -0.0657, -0.0529,  0.2592,
         -0.1894,  0.3250, -0.5775, -0.0678,  0.2615,  0.2640, -0.1111, -0.0295,
         -0.0796,  0.3253,  0.2914,  0.4859,  0.5804, -0.3704, -0.1030]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0186, 0.0157, 0.0096, 0.0132, 0.0304, 0.0146, 0.0111, 0.0103, 0.0095,
         0.0071, 0.0110, 0.0128, 0.0109, 0.0087, 0.0053, 0.0059, 0.0117, 0.0079,
         0.0108, 0.0119, 0.0078, 0.0083, 0.0147, 0.0099, 0.0083, 0.0062, 0.0093,
         0.0122, 0.0201, 0.0068, 0.0109, 0.0239, 0.0068, 0.0093, 0.0181, 0.0101,
         0.0124, 0.0176, 0.0135, 0.0069, 0.0058, 0.0100, 0.0154, 0.0107, 0.0212,
         0.0111, 0.0111, 0.0156, 0.0077, 0.0100, 0.0073, 0.0201, 0.0085, 0.0084,
         0.0106, 0.0103, 0.0068, 0.0101, 0.0070, 0.0132, 0.0086, 0.0114, 0.0119,
         0.0086, 0.0152, 0.0106, 0.0153, 0.0071, 0.0081, 0.0099, 0.0101, 0.0137,
         0.0088, 0.0147, 0.0060, 0.0099, 0.0138, 0.0138, 0.0095, 0.0103, 0.0098,
         0.0147, 0.0142, 0.0172, 0.0189, 0.0073, 0.0096]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.2068, -0.5563, -0.2496, -0.3469, -0.2447,  0.6327,  0.2944, -0.4012,
         -0.8901, -0.6810,  0.5242, -0.0912,  0.3105, -0.2992, -0.5330, -0.2900,
         -0.1191,  0.7531, -0.2611, -0.1327, -0.5578,  0.2044, -0.4234, -0.2082,
         -0.2341, -0.6246, -0.0448,  0.1444, -0.1871,  0.1681,  0.2802, -0.0153,
          0.4106,  0.3737, -0.0453, -0.6854, -0.0852,  0.3754, -0.7055,  0.4967,
          0.1857,  0.2592,  0.6170,  0.5717,  0.1817,  0.1949, -0.4587, -0.2918,
         -0.4163,  0.1459,  0.0789,  0.4302, -0.2788,  0.5995, -0.4627, -0.1162,
         -0.0511, -0.1830, -0.0683, -0.0265,  0.4832, -0.0611,  0.2471, -0.3965,
         -0.0645,  0.0981, -0.4494, -0.7035,  0.0932,  0.2071, -0.7001,  0.2562,
         -0.7010, -0.3663, -0.2668, -0.4855,  0.1803, -0.2326,  0.6327,  0.0169,
         -0.2580, -0.2749,  1.0223,  0.1242,  0.2980, -0.8699,  0.1629]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.2068, -0.5563, -0.2496, -0.3469, -0.2447,  0.6327,  0.2944, -0.4012,
         -0.8901, -0.6810,  0.5242, -0.0912,  0.3105, -0.2992, -0.5330, -0.2900,
         -0.1191,  0.7531, -0.2611, -0.1327, -0.5578,  0.2044, -0.4234, -0.2082,
         -0.2341, -0.6246, -0.0448,  0.1444, -0.1871,  0.1681,  0.2802, -0.0153,
          0.4106,  0.3737, -0.0453, -0.6854, -0.0852,  0.3754, -0.7055,  0.4967,
          0.1857,  0.2592,  0.6170,  0.5717,  0.1817,  0.1949, -0.4587, -0.2918,
         -0.4163,  0.1459,  0.0789,  0.4302, -0.2788,  0.5995, -0.4627, -0.1162,
         -0.0511, -0.1830, -0.0683, -0.0265,  0.4832, -0.0611,  0.2471, -0.3965,
         -0.0645,  0.0981, -0.4494, -0.7035,  0.0932,  0.2071, -0.7001,  0.2562,
         -0.7010, -0.3663, -0.2668, -0.4855,  0.1803, -0.2326,  0.6327,  0.0169,
         -0.2580, -0.2749,  1.0223,  0.1242,  0.2980, -0.8699,  0.1629]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0138, 0.0064, 0.0087, 0.0079, 0.0088, 0.0211, 0.0150, 0.0075, 0.0046,
         0.0057, 0.0189, 0.0102, 0.0153, 0.0083, 0.0066, 0.0084, 0.0099, 0.0238,
         0.0086, 0.0098, 0.0064, 0.0137, 0.0073, 0.0091, 0.0089, 0.0060, 0.0107,
         0.0129, 0.0093, 0.0132, 0.0148, 0.0110, 0.0169, 0.0163, 0.0107, 0.0056,
         0.0103, 0.0163, 0.0055, 0.0184, 0.0135, 0.0145, 0.0207, 0.0198, 0.0134,
         0.0136, 0.0071, 0.0084, 0.0074, 0.0130, 0.0121, 0.0172, 0.0085, 0.0204,
         0.0070, 0.0100, 0.0106, 0.0093, 0.0105, 0.0109, 0.0181, 0.0105, 0.0143,
         0.0075, 0.0105, 0.0123, 0.0071, 0.0055, 0.0123, 0.0138, 0.0056, 0.0145,
         0.0056, 0.0078, 0.0086, 0.0069, 0.0134, 0.0089, 0.0211, 0.0114, 0.0086,
         0.0085, 0.0311, 0.0127, 0.0151, 0.0047, 0.0132]], device='cuda:0')
Sum of probabilities per row: tensor([1.0000], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.0083, -0.1892,  0.0678,  0.1501,  0.3181, -0.2960, -0.3243,  0.2681,
         -0.1904, -0.4074,  0.5161,  0.3238, -0.0771,  0.3844,  0.2880,  0.1226,
          0.4050, -0.3639,  0.0360, -0.0077, -0.2150,  0.2630, -0.0153, -0.7720,
         -0.3489, -0.1908,  0.2336, -0.6299,  0.5464, -0.3986, -0.2062,  0.0038,
         -0.2731,  0.0275,  0.0073, -0.5111,  0.7251, -0.0667, -0.0475,  0.4462,
          0.2515,  0.2672,  0.1706, -0.2941,  0.3101,  0.5798, -0.4708,  0.5910,
         -0.1571, -0.6502,  0.2047, -0.2204, -0.5131,  0.4049,  0.1425,  0.3075,
          0.0847, -0.4573,  0.2888, -0.4147,  0.0907, -0.0783, -0.1404,  0.1134,
          0.1326, -0.1630,  0.2677, -0.0627,  0.2778,  0.1624,  0.2789,  0.4097,
          0.6125,  0.1535,  0.1596, -0.0449,  0.4924, -0.1966, -0.2821, -0.4339,
         -0.5822, -0.0076, -0.2237, -0.1186, -0.2590, -0.4206,  0.0303]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.0083, -0.1892,  0.0678,  0.1501,  0.3181, -0.2960, -0.3243,  0.2681,
         -0.1904, -0.4074,  0.5161,  0.3238, -0.0771,  0.3844,  0.2880,  0.1226,
          0.4050, -0.3639,  0.0360, -0.0077, -0.2150,  0.2630, -0.0153, -0.7720,
         -0.3489, -0.1908,  0.2336, -0.6299,  0.5464, -0.3986, -0.2062,  0.0038,
         -0.2731,  0.0275,  0.0073, -0.5111,  0.7251, -0.0667, -0.0475,  0.4462,
          0.2515,  0.2672,  0.1706, -0.2941,  0.3101,  0.5798, -0.4708,  0.5910,
         -0.1571, -0.6502,  0.2047, -0.2204, -0.5131,  0.4049,  0.1425,  0.3075,
          0.0847, -0.4573,  0.2888, -0.4147,  0.0907, -0.0783, -0.1404,  0.1134,
          0.1326, -0.1630,  0.2677, -0.0627,  0.2778,  0.1624,  0.2789,  0.4097,
          0.6125,  0.1535,  0.1596, -0.0449,  0.4924, -0.1966, -0.2821, -0.4339,
         -0.5822, -0.0076, -0.2237, -0.1186, -0.2590, -0.4206,  0.0303]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0110, 0.0090, 0.0116, 0.0126, 0.0149, 0.0081, 0.0079, 0.0142, 0.0090,
         0.0072, 0.0182, 0.0150, 0.0101, 0.0160, 0.0145, 0.0123, 0.0163, 0.0076,
         0.0113, 0.0108, 0.0088, 0.0141, 0.0107, 0.0050, 0.0077, 0.0090, 0.0137,
         0.0058, 0.0188, 0.0073, 0.0088, 0.0109, 0.0083, 0.0112, 0.0110, 0.0065,
         0.0225, 0.0102, 0.0104, 0.0170, 0.0140, 0.0142, 0.0129, 0.0081, 0.0148,
         0.0194, 0.0068, 0.0196, 0.0093, 0.0057, 0.0133, 0.0087, 0.0065, 0.0163,
         0.0125, 0.0148, 0.0118, 0.0069, 0.0145, 0.0072, 0.0119, 0.0101, 0.0094,
         0.0122, 0.0124, 0.0092, 0.0142, 0.0102, 0.0144, 0.0128, 0.0144, 0.0164,
         0.0201, 0.0127, 0.0128, 0.0104, 0.0178, 0.0089, 0.0082, 0.0070, 0.0061,
         0.0108, 0.0087, 0.0097, 0.0084, 0.0071, 0.0112]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.4587, -0.5903, -0.2823, -0.7116, -0.5662,  0.0358, -0.5878,  0.3237,
         -0.0287, -1.1039,  0.3342, -0.0574, -0.2192, -0.4379, -0.0361, -0.0597,
         -0.1334,  0.9425, -0.3344, -1.0244,  0.0050,  0.0966, -0.4504, -0.1586,
         -0.0241,  0.3499, -0.4067, -0.1388,  0.2255, -0.6993, -0.1220, -0.2175,
         -0.8342,  0.0078,  0.0031, -0.0930, -0.0737,  0.1460, -0.1709,  0.4030,
          0.4827,  0.1273,  0.1590,  0.1176, -0.4331,  0.0755,  0.3366, -0.0900,
         -0.3846,  0.3256, -0.1326,  0.0327, -0.1278,  0.2444, -0.4276, -0.5777,
          0.0973, -0.3252, -0.0512,  0.5597,  0.8368,  0.1587, -0.3135, -0.1623,
          0.0026,  0.0196, -0.2049, -0.3460,  0.3692, -0.1060, -0.1067,  0.3928,
          0.0912,  0.4995, -0.0515, -0.5214,  0.3618, -0.1392, -0.5208,  0.2672,
         -0.2387,  0.2497, -0.0726,  0.2600, -0.3172, -0.8649,  0.3578]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.4587, -0.5903, -0.2823, -0.7116, -0.5662,  0.0358, -0.5878,  0.3237,
         -0.0287, -1.1039,  0.3342, -0.0574, -0.2192, -0.4379, -0.0361, -0.0597,
         -0.1334,  0.9425, -0.3344, -1.0244,  0.0050,  0.0966, -0.4504, -0.1586,
         -0.0241,  0.3499, -0.4067, -0.1388,  0.2255, -0.6993, -0.1220, -0.2175,
         -0.8342,  0.0078,  0.0031, -0.0930, -0.0737,  0.1460, -0.1709,  0.4030,
          0.4827,  0.1273,  0.1590,  0.1176, -0.4331,  0.0755,  0.3366, -0.0900,
         -0.3846,  0.3256, -0.1326,  0.0327, -0.1278,  0.2444, -0.4276, -0.5777,
          0.0973, -0.3252, -0.0512,  0.5597,  0.8368,  0.1587, -0.3135, -0.1623,
          0.0026,  0.0196, -0.2049, -0.3460,  0.3692, -0.1060, -0.1067,  0.3928,
          0.0912,  0.4995, -0.0515, -0.5214,  0.3618, -0.1392, -0.5208,  0.2672,
         -0.2387,  0.2497, -0.0726,  0.2600, -0.3172, -0.8649,  0.3578]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0182, 0.0064, 0.0087, 0.0057, 0.0065, 0.0119, 0.0064, 0.0159, 0.0112,
         0.0038, 0.0161, 0.0109, 0.0092, 0.0074, 0.0111, 0.0108, 0.0101, 0.0295,
         0.0082, 0.0041, 0.0116, 0.0127, 0.0073, 0.0098, 0.0112, 0.0163, 0.0077,
         0.0100, 0.0144, 0.0057, 0.0102, 0.0093, 0.0050, 0.0116, 0.0115, 0.0105,
         0.0107, 0.0133, 0.0097, 0.0172, 0.0187, 0.0131, 0.0135, 0.0130, 0.0075,
         0.0124, 0.0161, 0.0105, 0.0078, 0.0159, 0.0101, 0.0119, 0.0101, 0.0147,
         0.0075, 0.0065, 0.0127, 0.0083, 0.0109, 0.0202, 0.0266, 0.0135, 0.0084,
         0.0098, 0.0115, 0.0117, 0.0094, 0.0081, 0.0167, 0.0104, 0.0103, 0.0171,
         0.0126, 0.0190, 0.0109, 0.0068, 0.0165, 0.0100, 0.0068, 0.0150, 0.0091,
         0.0148, 0.0107, 0.0149, 0.0084, 0.0048, 0.0165]], device='cuda:0')
Sum of probabilities per row: tensor([1.0000], device='cuda:0')
Logits before softmax and clamp: tensor([[-0.0348, -0.9196,  0.0808,  0.5434, -0.6625,  0.7008,  0.1665, -0.6509,
         -0.3696, -0.1447,  0.7139,  0.9924, -0.2162,  0.3330,  0.2758, -0.4832,
          0.3624,  0.4611, -0.2321,  0.3340,  0.1091,  0.7477,  0.1033,  0.1295,
         -0.4270,  0.1445, -0.4402, -0.3360,  0.0535, -1.1868, -0.1915,  0.0642,
         -0.2210,  0.3629, -0.0123,  0.0566,  0.3728, -0.3454,  0.0759, -0.2871,
         -0.1124,  0.0152,  0.1783, -0.3285,  0.2064, -0.2465, -0.0266, -0.9991,
         -0.0572,  0.2706, -0.2926,  0.2163,  0.1260,  0.2200,  0.1923, -0.1743,
          0.0621,  0.1164,  0.1023, -0.1493, -0.1170, -0.8591,  0.3789, -0.1338,
         -0.1564,  0.0702, -0.1564, -0.0863,  0.8733,  0.3378,  0.2212,  0.7898,
          0.3150, -0.5929, -0.3526, -0.4245, -0.3690,  0.5548, -1.1211,  1.1332,
         -0.6217, -0.1918,  0.1878,  0.3375,  0.6857, -0.7994,  0.3912]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[-0.0348, -0.9196,  0.0808,  0.5434, -0.6625,  0.7008,  0.1665, -0.6509,
         -0.3696, -0.1447,  0.7139,  0.9924, -0.2162,  0.3330,  0.2758, -0.4832,
          0.3624,  0.4611, -0.2321,  0.3340,  0.1091,  0.7477,  0.1033,  0.1295,
         -0.4270,  0.1445, -0.4402, -0.3360,  0.0535, -1.1868, -0.1915,  0.0642,
         -0.2210,  0.3629, -0.0123,  0.0566,  0.3728, -0.3454,  0.0759, -0.2871,
         -0.1124,  0.0152,  0.1783, -0.3285,  0.2064, -0.2465, -0.0266, -0.9991,
         -0.0572,  0.2706, -0.2926,  0.2163,  0.1260,  0.2200,  0.1923, -0.1743,
          0.0621,  0.1164,  0.1023, -0.1493, -0.1170, -0.8591,  0.3789, -0.1338,
         -0.1564,  0.0702, -0.1564, -0.0863,  0.8733,  0.3378,  0.2212,  0.7898,
          0.3150, -0.5929, -0.3526, -0.4245, -0.3690,  0.5548, -1.1211,  1.1332,
         -0.6217, -0.1918,  0.1878,  0.3375,  0.6857, -0.7994,  0.3912]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0101, 0.0042, 0.0113, 0.0180, 0.0054, 0.0210, 0.0123, 0.0054, 0.0072,
         0.0090, 0.0213, 0.0281, 0.0084, 0.0146, 0.0137, 0.0064, 0.0150, 0.0165,
         0.0083, 0.0146, 0.0116, 0.0220, 0.0116, 0.0119, 0.0068, 0.0121, 0.0067,
         0.0075, 0.0110, 0.0032, 0.0086, 0.0111, 0.0084, 0.0150, 0.0103, 0.0110,
         0.0151, 0.0074, 0.0113, 0.0078, 0.0093, 0.0106, 0.0125, 0.0075, 0.0128,
         0.0082, 0.0102, 0.0038, 0.0099, 0.0137, 0.0078, 0.0130, 0.0118, 0.0130,
         0.0126, 0.0088, 0.0111, 0.0117, 0.0116, 0.0090, 0.0093, 0.0044, 0.0152,
         0.0091, 0.0089, 0.0112, 0.0089, 0.0096, 0.0250, 0.0146, 0.0130, 0.0230,
         0.0143, 0.0058, 0.0073, 0.0068, 0.0072, 0.0182, 0.0034, 0.0324, 0.0056,
         0.0086, 0.0126, 0.0146, 0.0207, 0.0047, 0.0154]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.1257, -0.1900, -0.2987,  0.1957,  0.2510,  0.6447, -0.2235, -0.4785,
         -0.0070, -1.3307, -0.2434, -0.0542,  0.6429, -0.3563, -0.1076, -0.9517,
         -0.0664,  0.5707, -0.3229,  0.0051, -0.4851,  0.3102, -0.2083,  0.0954,
          0.0060,  0.2944, -0.6287, -0.5592, -0.4367, -0.4506, -0.4508,  0.4161,
         -0.5774, -0.1178,  0.3054, -0.1704, -0.1434,  0.2978,  0.3729, -0.7418,
         -0.0115,  0.4398,  0.3200, -0.3069,  0.0367,  0.5891, -0.5742, -0.4121,
          0.3760,  0.3468, -0.2760,  0.2261, -0.2514, -0.4510, -0.0562, -0.0694,
         -0.1593, -0.3365,  0.2156, -0.5760,  0.0120, -0.2612,  0.2822, -0.3533,
          0.3266,  0.4010, -0.3465, -0.2164,  0.0608,  0.5944,  0.3682,  0.3935,
         -0.2378,  0.0587,  0.1514,  0.0377,  0.4804,  0.4092, -0.0227,  0.8545,
         -0.3915, -0.4738,  0.9494, -0.0908,  0.6649, -0.9561,  0.4298]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.1257, -0.1900, -0.2987,  0.1957,  0.2510,  0.6447, -0.2235, -0.4785,
         -0.0070, -1.3307, -0.2434, -0.0542,  0.6429, -0.3563, -0.1076, -0.9517,
         -0.0664,  0.5707, -0.3229,  0.0051, -0.4851,  0.3102, -0.2083,  0.0954,
          0.0060,  0.2944, -0.6287, -0.5592, -0.4367, -0.4506, -0.4508,  0.4161,
         -0.5774, -0.1178,  0.3054, -0.1704, -0.1434,  0.2978,  0.3729, -0.7418,
         -0.0115,  0.4398,  0.3200, -0.3069,  0.0367,  0.5891, -0.5742, -0.4121,
          0.3760,  0.3468, -0.2760,  0.2261, -0.2514, -0.4510, -0.0562, -0.0694,
         -0.1593, -0.3365,  0.2156, -0.5760,  0.0120, -0.2612,  0.2822, -0.3533,
          0.3266,  0.4010, -0.3465, -0.2164,  0.0608,  0.5944,  0.3682,  0.3935,
         -0.2378,  0.0587,  0.1514,  0.0377,  0.4804,  0.4092, -0.0227,  0.8545,
         -0.3915, -0.4738,  0.9494, -0.0908,  0.6649, -0.9561,  0.4298]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0123, 0.0090, 0.0081, 0.0132, 0.0140, 0.0207, 0.0087, 0.0067, 0.0108,
         0.0029, 0.0085, 0.0103, 0.0207, 0.0076, 0.0098, 0.0042, 0.0102, 0.0193,
         0.0079, 0.0109, 0.0067, 0.0148, 0.0088, 0.0120, 0.0110, 0.0146, 0.0058,
         0.0062, 0.0070, 0.0069, 0.0069, 0.0165, 0.0061, 0.0097, 0.0148, 0.0092,
         0.0094, 0.0147, 0.0158, 0.0052, 0.0108, 0.0169, 0.0150, 0.0080, 0.0113,
         0.0196, 0.0061, 0.0072, 0.0159, 0.0154, 0.0083, 0.0137, 0.0085, 0.0069,
         0.0103, 0.0102, 0.0093, 0.0078, 0.0135, 0.0061, 0.0110, 0.0084, 0.0144,
         0.0076, 0.0151, 0.0163, 0.0077, 0.0088, 0.0116, 0.0197, 0.0157, 0.0161,
         0.0086, 0.0115, 0.0127, 0.0113, 0.0176, 0.0164, 0.0106, 0.0256, 0.0074,
         0.0068, 0.0281, 0.0099, 0.0212, 0.0042, 0.0167]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.5228, -0.2326, -0.2461, -0.1204,  0.3244,  0.3805, -0.1366,  0.1166,
         -0.5883, -0.5710, -0.0980, -0.2466, -0.2264, -0.1964, -0.2028, -0.6943,
         -0.0076,  0.5849, -0.2114, -0.2180, -0.6514, -0.3822, -0.2000, -0.4977,
         -0.4435, -0.4162,  0.3898,  0.4939, -0.2015,  0.7356, -0.1662, -0.1458,
         -0.4933,  0.3642,  0.4717, -0.0690, -0.3595, -0.0976, -0.4295, -0.0863,
          1.0669, -0.2551,  0.3143,  0.4452, -0.3402, -0.1644, -0.3427,  0.1874,
         -0.0801,  0.2936,  0.2977, -0.8609, -0.1840, -0.0254, -0.4724, -0.4608,
         -0.2339, -0.1888, -0.2080,  0.0347,  0.0291,  0.4111,  0.4751, -0.1728,
          0.3986,  0.1898,  0.1104, -0.0483,  0.2683, -0.1011,  0.1558,  0.1541,
         -0.5403,  0.5114,  0.6275, -0.4141, -0.1099,  0.1029,  0.1391,  0.0755,
         -0.4685,  0.0948, -0.2084, -0.1218, -0.2184,  0.1056, -0.0797]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.5228, -0.2326, -0.2461, -0.1204,  0.3244,  0.3805, -0.1366,  0.1166,
         -0.5883, -0.5710, -0.0980, -0.2466, -0.2264, -0.1964, -0.2028, -0.6943,
         -0.0076,  0.5849, -0.2114, -0.2180, -0.6514, -0.3822, -0.2000, -0.4977,
         -0.4435, -0.4162,  0.3898,  0.4939, -0.2015,  0.7356, -0.1662, -0.1458,
         -0.4933,  0.3642,  0.4717, -0.0690, -0.3595, -0.0976, -0.4295, -0.0863,
          1.0669, -0.2551,  0.3143,  0.4452, -0.3402, -0.1644, -0.3427,  0.1874,
         -0.0801,  0.2936,  0.2977, -0.8609, -0.1840, -0.0254, -0.4724, -0.4608,
         -0.2339, -0.1888, -0.2080,  0.0347,  0.0291,  0.4111,  0.4751, -0.1728,
          0.3986,  0.1898,  0.1104, -0.0483,  0.2683, -0.1011,  0.1558,  0.1541,
         -0.5403,  0.5114,  0.6275, -0.4141, -0.1099,  0.1029,  0.1391,  0.0755,
         -0.4685,  0.0948, -0.2084, -0.1218, -0.2184,  0.1056, -0.0797]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0190, 0.0089, 0.0088, 0.0100, 0.0156, 0.0165, 0.0098, 0.0127, 0.0063,
         0.0064, 0.0102, 0.0088, 0.0090, 0.0093, 0.0092, 0.0056, 0.0112, 0.0202,
         0.0091, 0.0091, 0.0059, 0.0077, 0.0092, 0.0068, 0.0072, 0.0074, 0.0166,
         0.0185, 0.0092, 0.0235, 0.0095, 0.0097, 0.0069, 0.0162, 0.0181, 0.0105,
         0.0079, 0.0102, 0.0073, 0.0103, 0.0327, 0.0087, 0.0154, 0.0176, 0.0080,
         0.0096, 0.0080, 0.0136, 0.0104, 0.0151, 0.0152, 0.0048, 0.0094, 0.0110,
         0.0070, 0.0071, 0.0089, 0.0093, 0.0091, 0.0117, 0.0116, 0.0170, 0.0181,
         0.0095, 0.0168, 0.0136, 0.0126, 0.0107, 0.0147, 0.0102, 0.0132, 0.0131,
         0.0066, 0.0188, 0.0211, 0.0074, 0.0101, 0.0125, 0.0129, 0.0121, 0.0071,
         0.0124, 0.0091, 0.0100, 0.0091, 0.0125, 0.0104]], device='cuda:0')
Sum of probabilities per row: tensor([1.0000], device='cuda:0')
Logits before softmax and clamp: tensor([[-0.6226, -0.7442,  0.1657,  0.0332,  1.1750,  0.0892,  0.3244,  0.1712,
         -0.0616, -0.7253, -0.5217, -0.8862,  0.5152,  0.0132, -0.6914, -0.8242,
         -0.7836, -0.1810, -0.9916, -0.1494, -0.7668, -0.5016,  0.1706, -0.9551,
         -0.6267,  0.4177, -0.2179, -0.0074, -0.0026,  0.1257,  0.1460,  0.1585,
          0.1145, -0.0657,  0.1322,  0.2327,  0.0896, -0.2309, -0.1500,  0.0357,
          0.3457,  0.0506,  0.6471,  0.1688, -0.2701,  0.1999, -0.3486, -0.6580,
          0.7634,  0.2005, -0.0673,  0.7578,  0.0296, -0.4294, -0.4116, -0.0139,
         -0.0366,  0.3725,  0.6387, -0.3861,  0.1336,  0.2905, -0.2102, -0.1716,
         -0.2497, -0.0143, -0.1533, -0.2195, -0.1611,  0.1723, -0.9431,  0.4259,
         -0.5879, -0.0790, -0.0304, -0.3435, -0.0402,  0.6134, -0.1197, -0.1582,
         -0.1046, -0.4504, -0.1058, -0.2599,  0.3085, -0.6338,  0.1235]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[-0.6226, -0.7442,  0.1657,  0.0332,  1.1750,  0.0892,  0.3244,  0.1712,
         -0.0616, -0.7253, -0.5217, -0.8862,  0.5152,  0.0132, -0.6914, -0.8242,
         -0.7836, -0.1810, -0.9916, -0.1494, -0.7668, -0.5016,  0.1706, -0.9551,
         -0.6267,  0.4177, -0.2179, -0.0074, -0.0026,  0.1257,  0.1460,  0.1585,
          0.1145, -0.0657,  0.1322,  0.2327,  0.0896, -0.2309, -0.1500,  0.0357,
          0.3457,  0.0506,  0.6471,  0.1688, -0.2701,  0.1999, -0.3486, -0.6580,
          0.7634,  0.2005, -0.0673,  0.7578,  0.0296, -0.4294, -0.4116, -0.0139,
         -0.0366,  0.3725,  0.6387, -0.3861,  0.1336,  0.2905, -0.2102, -0.1716,
         -0.2497, -0.0143, -0.1533, -0.2195, -0.1611,  0.1723, -0.9431,  0.4259,
         -0.5879, -0.0790, -0.0304, -0.3435, -0.0402,  0.6134, -0.1197, -0.1582,
         -0.1046, -0.4504, -0.1058, -0.2599,  0.3085, -0.6338,  0.1235]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0062, 0.0055, 0.0136, 0.0119, 0.0373, 0.0126, 0.0159, 0.0137, 0.0108,
         0.0056, 0.0068, 0.0047, 0.0193, 0.0117, 0.0058, 0.0050, 0.0053, 0.0096,
         0.0043, 0.0099, 0.0053, 0.0070, 0.0137, 0.0044, 0.0062, 0.0175, 0.0093,
         0.0114, 0.0115, 0.0131, 0.0133, 0.0135, 0.0129, 0.0108, 0.0131, 0.0145,
         0.0126, 0.0091, 0.0099, 0.0119, 0.0163, 0.0121, 0.0220, 0.0136, 0.0088,
         0.0141, 0.0081, 0.0060, 0.0247, 0.0141, 0.0108, 0.0246, 0.0119, 0.0075,
         0.0076, 0.0114, 0.0111, 0.0167, 0.0218, 0.0078, 0.0132, 0.0154, 0.0093,
         0.0097, 0.0090, 0.0113, 0.0099, 0.0092, 0.0098, 0.0137, 0.0045, 0.0176,
         0.0064, 0.0106, 0.0112, 0.0082, 0.0111, 0.0213, 0.0102, 0.0098, 0.0104,
         0.0073, 0.0104, 0.0089, 0.0157, 0.0061, 0.0130]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 1.1253, -0.0172, -0.3335,  0.1635,  0.0549,  0.4416, -0.1508, -0.3482,
          0.3968, -0.1687, -0.2158,  0.6536,  0.1094, -0.0549, -0.5976, -0.3674,
          0.2914,  0.2732, -0.3469, -0.3182, -0.0756, -0.1729, -0.2212,  0.2276,
         -0.2863,  0.1944,  0.0118,  0.3799,  0.1210, -0.4121, -0.1319, -0.0445,
          0.0332,  0.2520, -0.1024, -0.0654,  0.5118,  0.0199, -0.7501, -0.5642,
         -0.8139, -0.7754,  0.1073, -0.3459,  0.3160,  0.7945, -0.2574,  0.9366,
          0.4364, -0.2435, -0.2171, -0.0227, -0.3208,  0.7510,  0.0901,  0.0725,
         -0.3657,  0.2509,  0.0989,  0.4399, -0.2706, -0.2077,  0.6548,  0.3327,
         -0.0805,  0.1124, -0.0793, -0.2248, -0.2831,  1.0628, -0.1543,  0.3908,
          0.0965, -0.1256, -0.0438, -0.4412, -0.0352, -0.6415, -0.0659,  0.2259,
         -0.0901, -0.4180,  0.9834, -0.2836,  0.9756, -0.0042,  0.4790]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 1.1253, -0.0172, -0.3335,  0.1635,  0.0549,  0.4416, -0.1508, -0.3482,
          0.3968, -0.1687, -0.2158,  0.6536,  0.1094, -0.0549, -0.5976, -0.3674,
          0.2914,  0.2732, -0.3469, -0.3182, -0.0756, -0.1729, -0.2212,  0.2276,
         -0.2863,  0.1944,  0.0118,  0.3799,  0.1210, -0.4121, -0.1319, -0.0445,
          0.0332,  0.2520, -0.1024, -0.0654,  0.5118,  0.0199, -0.7501, -0.5642,
         -0.8139, -0.7754,  0.1073, -0.3459,  0.3160,  0.7945, -0.2574,  0.9366,
          0.4364, -0.2435, -0.2171, -0.0227, -0.3208,  0.7510,  0.0901,  0.0725,
         -0.3657,  0.2509,  0.0989,  0.4399, -0.2706, -0.2077,  0.6548,  0.3327,
         -0.0805,  0.1124, -0.0793, -0.2248, -0.2831,  1.0628, -0.1543,  0.3908,
          0.0965, -0.1256, -0.0438, -0.4412, -0.0352, -0.6415, -0.0659,  0.2259,
         -0.0901, -0.4180,  0.9834, -0.2836,  0.9756, -0.0042,  0.4790]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0315, 0.0100, 0.0073, 0.0120, 0.0108, 0.0159, 0.0088, 0.0072, 0.0152,
         0.0086, 0.0082, 0.0196, 0.0114, 0.0097, 0.0056, 0.0071, 0.0137, 0.0134,
         0.0072, 0.0074, 0.0095, 0.0086, 0.0082, 0.0128, 0.0077, 0.0124, 0.0103,
         0.0149, 0.0115, 0.0068, 0.0089, 0.0098, 0.0106, 0.0131, 0.0092, 0.0096,
         0.0170, 0.0104, 0.0048, 0.0058, 0.0045, 0.0047, 0.0114, 0.0072, 0.0140,
         0.0226, 0.0079, 0.0261, 0.0158, 0.0080, 0.0082, 0.0100, 0.0074, 0.0216,
         0.0112, 0.0110, 0.0071, 0.0131, 0.0113, 0.0159, 0.0078, 0.0083, 0.0197,
         0.0142, 0.0094, 0.0114, 0.0094, 0.0082, 0.0077, 0.0296, 0.0088, 0.0151,
         0.0112, 0.0090, 0.0098, 0.0066, 0.0099, 0.0054, 0.0096, 0.0128, 0.0093,
         0.0067, 0.0273, 0.0077, 0.0271, 0.0102, 0.0165]], device='cuda:0')
Sum of probabilities per row: tensor([1.0000], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.1386, -0.1233, -0.0270,  0.7907,  0.4259,  0.0617, -0.1106,  0.0171,
         -0.1976,  0.3523, -0.5146,  0.3190, -0.3394,  0.2145, -0.3360,  0.2965,
          0.5227,  0.1441, -0.6886, -0.1550, -0.2135,  0.3981, -0.3876,  0.1340,
          0.3347,  0.0743, -0.0825, -0.2282,  0.6982,  0.3204,  0.3918,  0.2323,
          0.3129, -0.4694, -0.1511, -0.2191,  0.1574,  0.1839, -0.2735, -0.6502,
          0.2989, -0.3247, -0.1003, -0.5791,  0.6077,  0.1762,  0.3847,  0.2231,
         -0.7466, -0.1611,  0.0512, -0.4907, -0.1883,  0.4963,  0.2752, -0.2048,
         -0.6750,  0.3578, -0.1550,  0.2155,  0.3533,  0.3126,  0.0524, -0.2213,
         -0.0085, -0.6429, -1.4313, -0.2095,  0.5628, -0.5494, -0.9051,  0.3978,
         -0.3080, -0.0744, -0.2317, -1.1240,  0.1298,  0.2605,  0.3648,  0.5553,
         -0.6212, -0.1226,  0.6313,  0.3440,  1.1837, -0.1146, -0.3080]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.1386, -0.1233, -0.0270,  0.7907,  0.4259,  0.0617, -0.1106,  0.0171,
         -0.1976,  0.3523, -0.5146,  0.3190, -0.3394,  0.2145, -0.3360,  0.2965,
          0.5227,  0.1441, -0.6886, -0.1550, -0.2135,  0.3981, -0.3876,  0.1340,
          0.3347,  0.0743, -0.0825, -0.2282,  0.6982,  0.3204,  0.3918,  0.2323,
          0.3129, -0.4694, -0.1511, -0.2191,  0.1574,  0.1839, -0.2735, -0.6502,
          0.2989, -0.3247, -0.1003, -0.5791,  0.6077,  0.1762,  0.3847,  0.2231,
         -0.7466, -0.1611,  0.0512, -0.4907, -0.1883,  0.4963,  0.2752, -0.2048,
         -0.6750,  0.3578, -0.1550,  0.2155,  0.3533,  0.3126,  0.0524, -0.2213,
         -0.0085, -0.6429, -1.4313, -0.2095,  0.5628, -0.5494, -0.9051,  0.3978,
         -0.3080, -0.0744, -0.2317, -1.1240,  0.1298,  0.2605,  0.3648,  0.5553,
         -0.6212, -0.1226,  0.6313,  0.3440,  1.1837, -0.1146, -0.3080]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0122, 0.0094, 0.0103, 0.0234, 0.0162, 0.0113, 0.0095, 0.0108, 0.0087,
         0.0151, 0.0063, 0.0146, 0.0076, 0.0131, 0.0076, 0.0143, 0.0179, 0.0123,
         0.0053, 0.0091, 0.0086, 0.0158, 0.0072, 0.0121, 0.0148, 0.0114, 0.0098,
         0.0084, 0.0213, 0.0146, 0.0157, 0.0134, 0.0145, 0.0066, 0.0091, 0.0085,
         0.0124, 0.0128, 0.0081, 0.0055, 0.0143, 0.0077, 0.0096, 0.0059, 0.0195,
         0.0127, 0.0156, 0.0133, 0.0050, 0.0090, 0.0112, 0.0065, 0.0088, 0.0174,
         0.0140, 0.0086, 0.0054, 0.0152, 0.0091, 0.0132, 0.0151, 0.0145, 0.0112,
         0.0085, 0.0105, 0.0056, 0.0025, 0.0086, 0.0186, 0.0061, 0.0043, 0.0158,
         0.0078, 0.0098, 0.0084, 0.0034, 0.0121, 0.0138, 0.0153, 0.0185, 0.0057,
         0.0094, 0.0199, 0.0150, 0.0347, 0.0095, 0.0078]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[-0.0051,  0.0178,  0.1028, -0.0587,  0.3410, -0.0387,  0.1911, -0.5432,
         -0.4566, -0.0295,  0.3384,  0.7740, -0.1520,  0.0598, -0.2611, -0.0685,
          0.4488,  0.3677,  0.2530, -0.0638, -0.8573,  0.5372, -0.7756, -0.0739,
         -0.1016, -0.3336, -0.0061,  0.2466, -0.1520, -0.4665, -0.3074, -0.0154,
          0.1263,  0.8109, -0.4362, -0.3110, -0.2772, -0.3435, -0.4542,  0.5097,
          0.2363,  0.1294, -0.7314,  0.6770, -0.1366,  0.1250,  0.1437, -0.0286,
          0.1467,  0.0916,  0.3946, -0.5049, -0.5640,  0.2146, -0.6064,  0.2775,
          0.1520, -0.2235,  0.2954, -0.5435,  0.3525,  0.1379,  0.1516, -0.5674,
          0.1486, -0.3031,  0.2041, -0.0966,  0.2755, -0.2588, -0.2142, -0.3765,
          0.0691,  0.5333, -0.5608,  0.0172,  0.0473, -0.2765,  0.0321, -0.3971,
         -0.8702, -0.2661,  1.0595, -0.1307, -0.1874,  0.0309, -0.7185]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[-0.0051,  0.0178,  0.1028, -0.0587,  0.3410, -0.0387,  0.1911, -0.5432,
         -0.4566, -0.0295,  0.3384,  0.7740, -0.1520,  0.0598, -0.2611, -0.0685,
          0.4488,  0.3677,  0.2530, -0.0638, -0.8573,  0.5372, -0.7756, -0.0739,
         -0.1016, -0.3336, -0.0061,  0.2466, -0.1520, -0.4665, -0.3074, -0.0154,
          0.1263,  0.8109, -0.4362, -0.3110, -0.2772, -0.3435, -0.4542,  0.5097,
          0.2363,  0.1294, -0.7314,  0.6770, -0.1366,  0.1250,  0.1437, -0.0286,
          0.1467,  0.0916,  0.3946, -0.5049, -0.5640,  0.2146, -0.6064,  0.2775,
          0.1520, -0.2235,  0.2954, -0.5435,  0.3525,  0.1379,  0.1516, -0.5674,
          0.1486, -0.3031,  0.2041, -0.0966,  0.2755, -0.2588, -0.2142, -0.3765,
          0.0691,  0.5333, -0.5608,  0.0172,  0.0473, -0.2765,  0.0321, -0.3971,
         -0.8702, -0.2661,  1.0595, -0.1307, -0.1874,  0.0309, -0.7185]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0111, 0.0114, 0.0124, 0.0105, 0.0157, 0.0108, 0.0135, 0.0065, 0.0071,
         0.0109, 0.0157, 0.0243, 0.0096, 0.0119, 0.0086, 0.0104, 0.0175, 0.0162,
         0.0144, 0.0105, 0.0047, 0.0191, 0.0052, 0.0104, 0.0101, 0.0080, 0.0111,
         0.0143, 0.0096, 0.0070, 0.0082, 0.0110, 0.0127, 0.0252, 0.0072, 0.0082,
         0.0085, 0.0079, 0.0071, 0.0186, 0.0142, 0.0127, 0.0054, 0.0220, 0.0098,
         0.0127, 0.0129, 0.0109, 0.0130, 0.0123, 0.0166, 0.0068, 0.0064, 0.0139,
         0.0061, 0.0148, 0.0130, 0.0089, 0.0150, 0.0065, 0.0159, 0.0128, 0.0130,
         0.0063, 0.0130, 0.0083, 0.0137, 0.0102, 0.0147, 0.0086, 0.0090, 0.0077,
         0.0120, 0.0191, 0.0064, 0.0114, 0.0117, 0.0085, 0.0116, 0.0075, 0.0047,
         0.0086, 0.0323, 0.0098, 0.0093, 0.0115, 0.0055]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 2.3205e-01, -1.7112e-02,  2.3593e-01, -2.1213e-01,  5.5191e-01,
          2.4906e-01,  2.7096e-01, -7.2969e-02, -1.3650e-02,  1.7700e-01,
          1.1942e-01, -9.0755e-03, -4.8940e-01, -4.4819e-01, -2.7452e-01,
          4.8934e-02,  3.3835e-01,  5.5818e-02,  1.7347e-01, -3.5713e-01,
          3.2934e-01,  1.8836e-01, -2.3534e-03, -4.7546e-01,  5.9761e-02,
          1.7354e-01, -2.8448e-01,  1.6282e-01,  5.0024e-01,  6.5215e-02,
          3.0511e-02, -5.5649e-01,  3.9164e-01,  5.8936e-01,  2.4108e-01,
          1.3512e-01,  4.5429e-01,  9.2261e-02, -3.1306e-01,  2.8177e-01,
         -5.3798e-01, -1.6839e-01, -4.5488e-01, -5.5601e-01, -2.0500e-01,
          1.9000e-01, -3.1167e-01,  1.8516e-01, -6.2753e-01, -1.0697e-02,
          2.1228e-01, -2.3828e-01, -8.4662e-02,  4.7176e-04, -1.0907e-02,
          4.4994e-01,  8.6791e-01,  1.3672e-01,  5.1238e-01, -2.5031e-01,
         -1.6263e-01, -4.0424e-01,  7.2790e-02,  1.4195e-01, -3.6164e-01,
          2.1616e-01,  8.1086e-02, -5.6708e-01,  2.6649e-01,  5.8793e-01,
          2.4991e-02, -3.0875e-01,  2.1083e-01, -3.8639e-01,  3.8817e-01,
          1.1091e-01, -1.4683e-02,  3.1624e-01,  1.4652e-01, -1.3006e-01,
          3.4304e-01,  2.2086e-01,  8.6591e-01,  3.3812e-02, -1.7214e-01,
          2.5317e-01, -1.8571e-01]], device='cuda:0')
Logits before softmax and after clamp: tensor([[ 2.3205e-01, -1.7112e-02,  2.3593e-01, -2.1213e-01,  5.5191e-01,
          2.4906e-01,  2.7096e-01, -7.2969e-02, -1.3650e-02,  1.7700e-01,
          1.1942e-01, -9.0755e-03, -4.8940e-01, -4.4819e-01, -2.7452e-01,
          4.8934e-02,  3.3835e-01,  5.5818e-02,  1.7347e-01, -3.5713e-01,
          3.2934e-01,  1.8836e-01, -2.3534e-03, -4.7546e-01,  5.9761e-02,
          1.7354e-01, -2.8448e-01,  1.6282e-01,  5.0024e-01,  6.5215e-02,
          3.0511e-02, -5.5649e-01,  3.9164e-01,  5.8936e-01,  2.4108e-01,
          1.3512e-01,  4.5429e-01,  9.2261e-02, -3.1306e-01,  2.8177e-01,
         -5.3798e-01, -1.6839e-01, -4.5488e-01, -5.5601e-01, -2.0500e-01,
          1.9000e-01, -3.1167e-01,  1.8516e-01, -6.2753e-01, -1.0697e-02,
          2.1228e-01, -2.3828e-01, -8.4662e-02,  4.7176e-04, -1.0907e-02,
          4.4994e-01,  8.6791e-01,  1.3672e-01,  5.1238e-01, -2.5031e-01,
         -1.6263e-01, -4.0424e-01,  7.2790e-02,  1.4195e-01, -3.6164e-01,
          2.1616e-01,  8.1086e-02, -5.6708e-01,  2.6649e-01,  5.8793e-01,
          2.4991e-02, -3.0875e-01,  2.1083e-01, -3.8639e-01,  3.8817e-01,
          1.1091e-01, -1.4683e-02,  3.1624e-01,  1.4652e-01, -1.3006e-01,
          3.4304e-01,  2.2086e-01,  8.6591e-01,  3.3812e-02, -1.7214e-01,
          2.5317e-01, -1.8571e-01]], device='cuda:0')
Probabilities after softmax: tensor([[0.0133, 0.0103, 0.0133, 0.0085, 0.0182, 0.0135, 0.0138, 0.0098, 0.0104,
         0.0125, 0.0118, 0.0104, 0.0064, 0.0067, 0.0080, 0.0110, 0.0147, 0.0111,
         0.0125, 0.0074, 0.0146, 0.0127, 0.0105, 0.0065, 0.0112, 0.0125, 0.0079,
         0.0124, 0.0173, 0.0112, 0.0108, 0.0060, 0.0155, 0.0189, 0.0134, 0.0120,
         0.0166, 0.0115, 0.0077, 0.0139, 0.0061, 0.0089, 0.0067, 0.0060, 0.0086,
         0.0127, 0.0077, 0.0126, 0.0056, 0.0104, 0.0130, 0.0083, 0.0097, 0.0105,
         0.0104, 0.0165, 0.0250, 0.0120, 0.0175, 0.0082, 0.0089, 0.0070, 0.0113,
         0.0121, 0.0073, 0.0130, 0.0114, 0.0060, 0.0137, 0.0189, 0.0108, 0.0077,
         0.0130, 0.0071, 0.0155, 0.0117, 0.0104, 0.0144, 0.0122, 0.0092, 0.0148,
         0.0131, 0.0250, 0.0109, 0.0088, 0.0135, 0.0087]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.0668, -0.3083,  0.1441, -0.1486, -0.0590,  0.6044,  0.3166, -0.9673,
         -0.6508, -0.6970,  0.3121,  0.7257,  0.1642,  0.1764, -0.2264, -0.5847,
         -0.5854,  0.1385,  0.5232, -0.1358, -1.1622,  0.0141,  0.2546, -0.8066,
         -0.6053, -0.3502,  0.3443, -0.8526,  0.5785,  0.0790,  0.2162,  0.1694,
         -0.5521,  0.1885, -0.1365,  0.0465, -0.0572,  0.2873,  0.1643,  0.9667,
          0.1513,  0.7409, -0.7360, -0.3332, -0.2315,  0.2826, -0.0063, -0.5680,
          0.0485,  0.2560, -0.2827, -0.2454, -0.3763, -0.7140,  0.1923,  0.4538,
         -0.3265,  0.0280, -0.4607, -0.7616,  0.2609,  0.0306, -0.2545, -0.3457,
          0.0363, -0.3856,  0.2322,  0.0845,  0.0235, -0.1356,  0.2392, -0.2162,
          0.1762, -0.1295,  0.1878, -0.9550, -0.0188,  0.1250, -0.0551,  0.1793,
          0.0971, -0.1184, -0.2965,  0.3840,  0.1699, -0.2662,  0.0192]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.0668, -0.3083,  0.1441, -0.1486, -0.0590,  0.6044,  0.3166, -0.9673,
         -0.6508, -0.6970,  0.3121,  0.7257,  0.1642,  0.1764, -0.2264, -0.5847,
         -0.5854,  0.1385,  0.5232, -0.1358, -1.1622,  0.0141,  0.2546, -0.8066,
         -0.6053, -0.3502,  0.3443, -0.8526,  0.5785,  0.0790,  0.2162,  0.1694,
         -0.5521,  0.1885, -0.1365,  0.0465, -0.0572,  0.2873,  0.1643,  0.9667,
          0.1513,  0.7409, -0.7360, -0.3332, -0.2315,  0.2826, -0.0063, -0.5680,
          0.0485,  0.2560, -0.2827, -0.2454, -0.3763, -0.7140,  0.1923,  0.4538,
         -0.3265,  0.0280, -0.4607, -0.7616,  0.2609,  0.0306, -0.2545, -0.3457,
          0.0363, -0.3856,  0.2322,  0.0845,  0.0235, -0.1356,  0.2392, -0.2162,
          0.1762, -0.1295,  0.1878, -0.9550, -0.0188,  0.1250, -0.0551,  0.1793,
          0.0971, -0.1184, -0.2965,  0.3840,  0.1699, -0.2662,  0.0192]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0122, 0.0084, 0.0132, 0.0098, 0.0107, 0.0208, 0.0156, 0.0043, 0.0059,
         0.0057, 0.0156, 0.0235, 0.0134, 0.0136, 0.0091, 0.0063, 0.0063, 0.0131,
         0.0192, 0.0099, 0.0036, 0.0116, 0.0147, 0.0051, 0.0062, 0.0080, 0.0161,
         0.0049, 0.0203, 0.0123, 0.0141, 0.0135, 0.0066, 0.0138, 0.0099, 0.0119,
         0.0108, 0.0152, 0.0134, 0.0299, 0.0133, 0.0239, 0.0055, 0.0082, 0.0090,
         0.0151, 0.0113, 0.0065, 0.0120, 0.0147, 0.0086, 0.0089, 0.0078, 0.0056,
         0.0138, 0.0179, 0.0082, 0.0117, 0.0072, 0.0053, 0.0148, 0.0117, 0.0088,
         0.0081, 0.0118, 0.0077, 0.0144, 0.0124, 0.0117, 0.0099, 0.0145, 0.0092,
         0.0136, 0.0100, 0.0137, 0.0044, 0.0112, 0.0129, 0.0108, 0.0136, 0.0126,
         0.0101, 0.0085, 0.0167, 0.0135, 0.0087, 0.0116]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.8925,  0.0168, -0.1317, -0.2699, -0.1915, -0.0833, -0.2628, -0.7962,
          0.1294, -0.5624,  0.4630,  0.1136,  0.1787, -0.3960, -0.1068, -0.1467,
          0.6314,  0.3088, -0.1718, -0.3751, -0.2166, -0.1436, -0.7136, -0.1927,
         -0.3544,  0.3533,  0.0489, -0.0535, -0.3469, -0.1531, -0.2931,  0.1533,
          0.0594, -0.1391,  0.5168, -0.3533,  0.1041, -0.4054,  0.0801, -0.1351,
          0.0624,  0.0112,  0.6923, -1.0442,  0.1286,  0.2139, -0.3245, -0.2579,
          0.0438, -0.0197,  0.0105, -0.0659,  0.0273, -0.1240, -0.0378, -0.7896,
         -0.6183, -0.5704, -0.1401,  0.1603,  0.6176, -0.3296,  0.3148, -0.0960,
          0.5542,  0.1906, -0.7809,  0.0608,  0.0798, -0.5564,  0.2388,  0.3888,
          0.1926, -0.2116,  0.4944,  0.0815,  0.1668,  0.9202, -0.3405, -0.5917,
         -0.3339,  0.4578,  0.7212, -0.0078, -0.2165,  0.5117, -0.2703]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.8925,  0.0168, -0.1317, -0.2699, -0.1915, -0.0833, -0.2628, -0.7962,
          0.1294, -0.5624,  0.4630,  0.1136,  0.1787, -0.3960, -0.1068, -0.1467,
          0.6314,  0.3088, -0.1718, -0.3751, -0.2166, -0.1436, -0.7136, -0.1927,
         -0.3544,  0.3533,  0.0489, -0.0535, -0.3469, -0.1531, -0.2931,  0.1533,
          0.0594, -0.1391,  0.5168, -0.3533,  0.1041, -0.4054,  0.0801, -0.1351,
          0.0624,  0.0112,  0.6923, -1.0442,  0.1286,  0.2139, -0.3245, -0.2579,
          0.0438, -0.0197,  0.0105, -0.0659,  0.0273, -0.1240, -0.0378, -0.7896,
         -0.6183, -0.5704, -0.1401,  0.1603,  0.6176, -0.3296,  0.3148, -0.0960,
          0.5542,  0.1906, -0.7809,  0.0608,  0.0798, -0.5564,  0.2388,  0.3888,
          0.1926, -0.2116,  0.4944,  0.0815,  0.1668,  0.9202, -0.3405, -0.5917,
         -0.3339,  0.4578,  0.7212, -0.0078, -0.2165,  0.5117, -0.2703]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0270, 0.0113, 0.0097, 0.0085, 0.0091, 0.0102, 0.0085, 0.0050, 0.0126,
         0.0063, 0.0176, 0.0124, 0.0132, 0.0075, 0.0100, 0.0096, 0.0208, 0.0151,
         0.0093, 0.0076, 0.0089, 0.0096, 0.0054, 0.0091, 0.0078, 0.0158, 0.0116,
         0.0105, 0.0078, 0.0095, 0.0083, 0.0129, 0.0118, 0.0096, 0.0186, 0.0078,
         0.0123, 0.0074, 0.0120, 0.0097, 0.0118, 0.0112, 0.0221, 0.0039, 0.0126,
         0.0137, 0.0080, 0.0086, 0.0116, 0.0109, 0.0112, 0.0104, 0.0114, 0.0098,
         0.0107, 0.0050, 0.0060, 0.0063, 0.0096, 0.0130, 0.0205, 0.0080, 0.0152,
         0.0101, 0.0193, 0.0134, 0.0051, 0.0118, 0.0120, 0.0064, 0.0141, 0.0163,
         0.0134, 0.0090, 0.0182, 0.0120, 0.0131, 0.0278, 0.0079, 0.0061, 0.0079,
         0.0175, 0.0228, 0.0110, 0.0089, 0.0185, 0.0085]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.0858,  0.1289,  0.4058, -0.4584,  0.4789,  0.7469, -0.2545,  0.1129,
         -0.4519,  0.0371, -0.3905, -0.3832, -0.6123, -0.2455, -0.7272, -0.6876,
          0.2193,  0.4639, -0.5450, -0.8154, -0.7614, -0.2079, -0.1591, -0.7094,
         -0.2999, -0.3333,  0.0563,  0.2061,  0.2279, -0.4286,  0.4357,  0.1936,
         -0.1621,  0.3875,  0.2644, -0.1543, -0.1790, -0.2181, -0.1876,  0.3105,
          0.2562,  0.6863, -0.6767,  0.2073, -0.1520,  0.0396,  0.0148, -0.0622,
         -0.1660,  0.1903,  0.0909, -0.7143, -0.0425,  0.2658, -0.4675,  0.5980,
          0.3591,  0.0914,  0.2724,  0.7385,  0.6347,  0.1894, -0.6474,  0.2046,
          0.2172,  0.2583, -0.2792, -0.8565,  0.1077, -0.4507, -0.1267,  0.0713,
         -0.1911,  0.3032,  0.1009, -0.5291,  0.0417, -0.1259,  0.5141,  0.0048,
         -0.5958,  0.3540,  0.4675,  0.0654,  0.1560, -0.7988, -0.1566]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.0858,  0.1289,  0.4058, -0.4584,  0.4789,  0.7469, -0.2545,  0.1129,
         -0.4519,  0.0371, -0.3905, -0.3832, -0.6123, -0.2455, -0.7272, -0.6876,
          0.2193,  0.4639, -0.5450, -0.8154, -0.7614, -0.2079, -0.1591, -0.7094,
         -0.2999, -0.3333,  0.0563,  0.2061,  0.2279, -0.4286,  0.4357,  0.1936,
         -0.1621,  0.3875,  0.2644, -0.1543, -0.1790, -0.2181, -0.1876,  0.3105,
          0.2562,  0.6863, -0.6767,  0.2073, -0.1520,  0.0396,  0.0148, -0.0622,
         -0.1660,  0.1903,  0.0909, -0.7143, -0.0425,  0.2658, -0.4675,  0.5980,
          0.3591,  0.0914,  0.2724,  0.7385,  0.6347,  0.1894, -0.6474,  0.2046,
          0.2172,  0.2583, -0.2792, -0.8565,  0.1077, -0.4507, -0.1267,  0.0713,
         -0.1911,  0.3032,  0.1009, -0.5291,  0.0417, -0.1259,  0.5141,  0.0048,
         -0.5958,  0.3540,  0.4675,  0.0654,  0.1560, -0.7988, -0.1566]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0122, 0.0127, 0.0168, 0.0071, 0.0180, 0.0236, 0.0087, 0.0125, 0.0071,
         0.0116, 0.0076, 0.0076, 0.0061, 0.0087, 0.0054, 0.0056, 0.0139, 0.0178,
         0.0065, 0.0049, 0.0052, 0.0091, 0.0095, 0.0055, 0.0083, 0.0080, 0.0118,
         0.0137, 0.0140, 0.0073, 0.0173, 0.0136, 0.0095, 0.0165, 0.0145, 0.0096,
         0.0093, 0.0090, 0.0093, 0.0152, 0.0144, 0.0222, 0.0057, 0.0137, 0.0096,
         0.0116, 0.0113, 0.0105, 0.0095, 0.0135, 0.0122, 0.0055, 0.0107, 0.0146,
         0.0070, 0.0203, 0.0160, 0.0122, 0.0147, 0.0234, 0.0211, 0.0135, 0.0058,
         0.0137, 0.0139, 0.0145, 0.0084, 0.0047, 0.0124, 0.0071, 0.0098, 0.0120,
         0.0092, 0.0151, 0.0124, 0.0066, 0.0116, 0.0098, 0.0187, 0.0112, 0.0062,
         0.0159, 0.0178, 0.0119, 0.0131, 0.0050, 0.0095]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.0837,  0.0485, -0.1748,  0.0752,  0.8425,  0.0398, -0.1904, -0.4615,
          0.4124,  0.1234, -0.7368,  0.3814, -0.1175,  0.0854, -0.3218, -0.7216,
          0.0113, -0.1088,  0.4831,  0.0341, -0.5247, -0.3025,  0.0105,  0.5228,
         -0.0477,  0.1377, -0.9319, -0.2086,  0.5417,  0.4602, -0.0421,  0.3107,
         -0.1637, -0.1760,  0.1052,  0.6743,  0.3219,  0.3696, -0.0419,  0.2111,
         -0.1909, -0.8087,  0.3074, -0.4823, -0.6737,  0.0978, -0.2415, -0.6179,
          0.0390,  0.0496,  0.2923,  0.7311, -0.4859, -0.4535,  0.0856,  0.2873,
         -1.0009, -0.2632,  0.3452, -0.0500, -0.3265, -0.7774, -0.1348,  0.0964,
          0.0674, -0.1651,  0.1983, -0.2222,  0.1573, -0.2902,  0.3826, -0.2259,
         -0.1109,  0.1762,  0.1986,  0.2001, -0.3975, -0.0658, -0.1126,  0.0950,
         -0.2403, -0.0086,  0.0831, -0.2449,  0.5593,  0.3388, -0.1955]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.0837,  0.0485, -0.1748,  0.0752,  0.8425,  0.0398, -0.1904, -0.4615,
          0.4124,  0.1234, -0.7368,  0.3814, -0.1175,  0.0854, -0.3218, -0.7216,
          0.0113, -0.1088,  0.4831,  0.0341, -0.5247, -0.3025,  0.0105,  0.5228,
         -0.0477,  0.1377, -0.9319, -0.2086,  0.5417,  0.4602, -0.0421,  0.3107,
         -0.1637, -0.1760,  0.1052,  0.6743,  0.3219,  0.3696, -0.0419,  0.2111,
         -0.1909, -0.8087,  0.3074, -0.4823, -0.6737,  0.0978, -0.2415, -0.6179,
          0.0390,  0.0496,  0.2923,  0.7311, -0.4859, -0.4535,  0.0856,  0.2873,
         -1.0009, -0.2632,  0.3452, -0.0500, -0.3265, -0.7774, -0.1348,  0.0964,
          0.0674, -0.1651,  0.1983, -0.2222,  0.1573, -0.2902,  0.3826, -0.2259,
         -0.1109,  0.1762,  0.1986,  0.2001, -0.3975, -0.0658, -0.1126,  0.0950,
         -0.2403, -0.0086,  0.0831, -0.2449,  0.5593,  0.3388, -0.1955]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0121, 0.0117, 0.0093, 0.0120, 0.0258, 0.0116, 0.0092, 0.0070, 0.0168,
         0.0126, 0.0053, 0.0163, 0.0099, 0.0121, 0.0081, 0.0054, 0.0113, 0.0100,
         0.0180, 0.0115, 0.0066, 0.0082, 0.0112, 0.0188, 0.0106, 0.0128, 0.0044,
         0.0090, 0.0191, 0.0176, 0.0107, 0.0152, 0.0094, 0.0093, 0.0124, 0.0218,
         0.0154, 0.0161, 0.0107, 0.0137, 0.0092, 0.0050, 0.0151, 0.0069, 0.0057,
         0.0123, 0.0087, 0.0060, 0.0116, 0.0117, 0.0149, 0.0231, 0.0068, 0.0071,
         0.0121, 0.0148, 0.0041, 0.0086, 0.0157, 0.0106, 0.0080, 0.0051, 0.0097,
         0.0123, 0.0119, 0.0094, 0.0136, 0.0089, 0.0130, 0.0083, 0.0163, 0.0089,
         0.0100, 0.0133, 0.0136, 0.0136, 0.0075, 0.0104, 0.0099, 0.0122, 0.0088,
         0.0110, 0.0121, 0.0087, 0.0195, 0.0156, 0.0092]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[ 0.7799,  0.2147, -0.1605, -0.6577, -0.0927, -0.1060, -0.0187, -0.3176,
         -0.1590, -0.9936,  0.3863,  0.6169, -0.3319, -0.1994, -0.4203, -0.0268,
          0.0901,  0.4266, -0.3683, -0.4790,  0.1114, -0.1720, -0.8738, -0.4664,
         -0.6335, -0.0057, -0.5099, -0.1602,  0.3523, -0.6019, -0.0636,  0.0201,
         -0.5366,  0.0318,  0.3251,  0.2404,  0.2427, -0.3062, -0.1411, -0.3018,
         -0.1032, -0.0905,  0.4106, -0.1237, -0.4648, -0.1696, -0.4720,  0.1173,
         -0.2106,  0.2425, -0.0926,  0.3824, -0.2839, -0.0375, -0.2674, -0.6634,
          0.5562, -0.0392, -0.2671, -0.2111,  1.2690, -0.1771, -0.0249,  0.0193,
          0.2312,  0.1139, -0.2688, -0.0950,  0.4092, -0.0031,  0.0837,  0.0543,
          0.2153,  0.1927, -0.0584, -0.3084,  0.2139,  0.0571, -0.0157,  0.1236,
          0.3783,  0.1748,  0.6626,  0.2703, -0.2115, -0.5296, -0.0830]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[ 0.7799,  0.2147, -0.1605, -0.6577, -0.0927, -0.1060, -0.0187, -0.3176,
         -0.1590, -0.9936,  0.3863,  0.6169, -0.3319, -0.1994, -0.4203, -0.0268,
          0.0901,  0.4266, -0.3683, -0.4790,  0.1114, -0.1720, -0.8738, -0.4664,
         -0.6335, -0.0057, -0.5099, -0.1602,  0.3523, -0.6019, -0.0636,  0.0201,
         -0.5366,  0.0318,  0.3251,  0.2404,  0.2427, -0.3062, -0.1411, -0.3018,
         -0.1032, -0.0905,  0.4106, -0.1237, -0.4648, -0.1696, -0.4720,  0.1173,
         -0.2106,  0.2425, -0.0926,  0.3824, -0.2839, -0.0375, -0.2674, -0.6634,
          0.5562, -0.0392, -0.2671, -0.2111,  1.2690, -0.1771, -0.0249,  0.0193,
          0.2312,  0.1139, -0.2688, -0.0950,  0.4092, -0.0031,  0.0837,  0.0543,
          0.2153,  0.1927, -0.0584, -0.3084,  0.2139,  0.0571, -0.0157,  0.1236,
          0.3783,  0.1748,  0.6626,  0.2703, -0.2115, -0.5296, -0.0830]],
       device='cuda:0')
Probabilities after softmax: tensor([[0.0246, 0.0140, 0.0096, 0.0058, 0.0103, 0.0101, 0.0111, 0.0082, 0.0096,
         0.0042, 0.0166, 0.0209, 0.0081, 0.0092, 0.0074, 0.0110, 0.0123, 0.0173,
         0.0078, 0.0070, 0.0126, 0.0095, 0.0047, 0.0071, 0.0060, 0.0112, 0.0068,
         0.0096, 0.0160, 0.0062, 0.0106, 0.0115, 0.0066, 0.0116, 0.0156, 0.0143,
         0.0144, 0.0083, 0.0098, 0.0083, 0.0102, 0.0103, 0.0170, 0.0100, 0.0071,
         0.0095, 0.0070, 0.0127, 0.0091, 0.0144, 0.0103, 0.0165, 0.0085, 0.0108,
         0.0086, 0.0058, 0.0196, 0.0108, 0.0086, 0.0091, 0.0401, 0.0094, 0.0110,
         0.0115, 0.0142, 0.0126, 0.0086, 0.0102, 0.0170, 0.0112, 0.0122, 0.0119,
         0.0140, 0.0137, 0.0106, 0.0083, 0.0139, 0.0119, 0.0111, 0.0127, 0.0164,
         0.0134, 0.0218, 0.0148, 0.0091, 0.0066, 0.0104]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[-3.6783, -3.5419, -4.3896, -6.6305, -5.7281, -5.8203, -1.3120, -6.0698,
         -4.5789, -4.6057, -2.8814, -5.8415, -6.2108, -4.4595, -2.7838, -4.4566,
         -4.5614, -4.0528, -4.1482, -3.9877, -3.9551, -3.9522, -4.8919, -5.2037,
         -5.3528, -4.5839, -6.8327, -1.5944, -4.2115, -0.7106, -1.3401, -2.4177,
         -1.8087, -1.9346, -1.2297,  1.5717, -3.0413, -3.2583, -3.5005, -2.6742,
         -4.8488, -2.7486, -2.6084, -6.0369, -2.7653, -1.7622, -2.5852, -3.6772,
         -7.1350, -4.6135, -6.9926, -4.6026, -4.9411, -6.1255, -7.3827, -5.1721,
          4.3076,  3.5824, -0.8023,  1.3911,  0.8655,  2.8655, -1.5852,  3.8393,
          3.8338, -0.9073, -4.3385, -2.0857,  0.9064,  0.1303,  5.9544, -1.5619,
         -1.0606, -0.7022,  0.4470,  6.4569,  3.7193, -1.6167,  3.4877, -5.4081,
          1.9678, -6.6760, -2.5279, -3.8068, -3.4477, -5.4110, -8.3626]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[-3.6783, -3.5419, -4.3896, -6.6305, -5.7281, -5.8203, -1.3120, -6.0698,
         -4.5789, -4.6057, -2.8814, -5.8415, -6.2108, -4.4595, -2.7838, -4.4566,
         -4.5614, -4.0528, -4.1482, -3.9877, -3.9551, -3.9522, -4.8919, -5.2037,
         -5.3528, -4.5839, -6.8327, -1.5944, -4.2115, -0.7106, -1.3401, -2.4177,
         -1.8087, -1.9346, -1.2297,  1.5717, -3.0413, -3.2583, -3.5005, -2.6742,
         -4.8488, -2.7486, -2.6084, -6.0369, -2.7653, -1.7622, -2.5852, -3.6772,
         -7.1350, -4.6135, -6.9926, -4.6026, -4.9411, -6.1255, -7.3827, -5.1721,
          4.3076,  3.5824, -0.8023,  1.3911,  0.8655,  2.8655, -1.5852,  3.8393,
          3.8338, -0.9073, -4.3385, -2.0857,  0.9064,  0.1303,  5.9544, -1.5619,
         -1.0606, -0.7022,  0.4470,  6.4569,  3.7193, -1.6167,  3.4877, -5.4081,
          1.9678, -6.6760, -2.5279, -3.8068, -3.4477, -5.4110, -8.3626]],
       device='cuda:0')
Probabilities after softmax: tensor([[1.8768e-05, 2.1512e-05, 9.2156e-06, 9.8022e-07, 2.4168e-06, 2.2039e-06,
         2.0003e-04, 1.7172e-06, 7.6262e-06, 7.4244e-06, 4.1643e-05, 2.1575e-06,
         1.4914e-06, 8.5936e-06, 4.5911e-05, 8.6183e-06, 7.7609e-06, 1.2906e-05,
         1.1732e-05, 1.3774e-05, 1.4231e-05, 1.4272e-05, 5.5768e-06, 4.0830e-06,
         3.5174e-06, 7.5881e-06, 8.0075e-07, 1.5082e-04, 1.1013e-05, 3.6499e-04,
         1.9450e-04, 6.6210e-05, 1.2173e-04, 1.0733e-04, 2.1720e-04, 3.5768e-03,
         3.5490e-05, 2.8566e-05, 2.2421e-05, 5.1227e-05, 5.8222e-06, 4.7556e-05,
         5.4711e-05, 1.7747e-06, 4.6769e-05, 1.2752e-04, 5.5996e-05, 1.8789e-05,
         5.9183e-07, 7.3670e-06, 6.8244e-07, 7.4474e-06, 5.3092e-06, 1.6243e-06,
         4.6199e-07, 4.2139e-06, 5.5167e-02, 2.6712e-02, 3.3303e-04, 2.9858e-03,
         1.7651e-03, 1.3044e-02, 1.5222e-04, 3.4539e-02, 3.4349e-02, 2.9984e-04,
         9.6987e-06, 9.2282e-05, 1.8389e-03, 8.4627e-04, 2.8634e-01, 1.5580e-04,
         2.5722e-04, 3.6807e-04, 1.1616e-03, 4.7327e-01, 3.0633e-02, 1.4750e-04,
         2.4299e-02, 3.3281e-06, 5.3149e-03, 9.3656e-07, 5.9302e-05, 1.6505e-05,
/opt/conda/conda-bld/pytorch_1728945370933/work/aten/src/ATen/native/cuda/TensorCompare.cu:110: _assert_async_cuda_kernel: block: [0,0,0], thread: [0,0,0] Assertion `probability tensor contains either `inf`, `nan` or element < 0` failed.
         2.3636e-05, 3.3186e-06, 1.7341e-07]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Logits before softmax and clamp: tensor([[-1.5598, -1.6854, -3.6529, -4.1214, -4.4878, -3.1538, -1.9830, -3.2154,
         -2.5821, -3.2499, -2.8512, -3.8521, -2.4356, -1.9641, -4.3075, -4.2600,
         -3.9677, -3.4310, -3.4609, -3.4711, -3.6686, -3.0640, -4.2432, -4.3781,
         -3.2947, -3.4989, -3.1382, -1.4223, -4.3935, -3.5553, -3.3598, -4.8140,
         -3.3203, -2.4378, -1.8546, -1.4734, -2.5483, -5.1720, -4.2538, -3.9627,
         -5.4479,  0.4021, -2.3077, -4.3678, -2.9732, -2.3101, -3.1308, -3.3171,
         -6.7556, -2.0746, -5.2813, -3.8906, -2.3882, -3.6268, -5.3048, -2.4307,
          2.3713, -0.2362, -1.3018, -2.6298,  3.9943, -0.6546, -3.1370,  7.7283,
          4.0166, -2.2424, -3.3350, -3.4089, -1.4682, -2.1189, 10.5899, -1.8823,
         -2.3023,  1.6221, -2.4510,  1.4398,  2.9157, -2.4863,  4.8331, -3.8630,
         -2.1329, -5.4249, -2.0456, -3.5182, -3.4062, -4.9816, -4.4119]],
       device='cuda:0')
Logits before softmax and after clamp: tensor([[-1.5598, -1.6854, -3.6529, -4.1214, -4.4878, -3.1538, -1.9830, -3.2154,
         -2.5821, -3.2499, -2.8512, -3.8521, -2.4356, -1.9641, -4.3075, -4.2600,
         -3.9677, -3.4310, -3.4609, -3.4711, -3.6686, -3.0640, -4.2432, -4.3781,
         -3.2947, -3.4989, -3.1382, -1.4223, -4.3935, -3.5553, -3.3598, -4.8140,
         -3.3203, -2.4378, -1.8546, -1.4734, -2.5483, -5.1720, -4.2538, -3.9627,
         -5.4479,  0.4021, -2.3077, -4.3678, -2.9732, -2.3101, -3.1308, -3.3171,
         -6.7556, -2.0746, -5.2813, -3.8906, -2.3882, -3.6268, -5.3048, -2.4307,
          2.3713, -0.2362, -1.3018, -2.6298,  3.9943, -0.6546, -3.1370,  7.7283,
          4.0166, -2.2424, -3.3350, -3.4089, -1.4682, -2.1189, 10.0000, -1.8823,
         -2.3023,  1.6221, -2.4510,  1.4398,  2.9157, -2.4863,  4.8331, -3.8630,
         -2.1329, -5.4249, -2.0456, -3.5182, -3.4062, -4.9816, -4.4119]],
       device='cuda:0')
Probabilities after softmax: tensor([[8.5509e-06, 7.5414e-06, 1.0543e-06, 6.5998e-07, 4.5751e-07, 1.7368e-06,
         5.6006e-06, 1.6330e-06, 3.0763e-06, 1.5776e-06, 2.3506e-06, 8.6390e-07,
         3.5616e-06, 5.7075e-06, 5.4789e-07, 5.7456e-07, 7.6964e-07, 1.3164e-06,
         1.2776e-06, 1.2646e-06, 1.0379e-06, 1.9000e-06, 5.8428e-07, 5.1054e-07,
         1.5085e-06, 1.2300e-06, 1.7641e-06, 9.8111e-06, 5.0274e-07, 1.1624e-06,
         1.4134e-06, 3.3016e-07, 1.4703e-06, 3.5539e-06, 6.3680e-06, 9.3229e-06,
         3.1820e-06, 2.3080e-07, 5.7812e-07, 7.7346e-07, 1.7515e-07, 6.0823e-05,
         4.0478e-06, 5.1586e-07, 2.0807e-06, 4.0378e-06, 1.7772e-06, 1.4751e-06,
         4.7372e-08, 5.1101e-06, 2.0691e-07, 8.3126e-07, 3.7344e-06, 1.0823e-06,
         2.0210e-07, 3.5791e-06, 4.3579e-04, 3.2124e-05, 1.1067e-05, 2.9331e-06,
         2.2086e-03, 2.1141e-05, 1.7662e-06, 9.2423e-02, 2.2584e-03, 4.3207e-06,
         1.4490e-06, 1.3457e-06, 9.3714e-06, 4.8889e-06, 8.9613e-01, 6.1935e-06,
         4.0697e-06, 2.0601e-04, 3.5073e-06, 1.7168e-04, 7.5112e-04, 3.3857e-06,
         5.1098e-03, 8.5455e-07, 4.8206e-06, 1.7924e-07, 5.2603e-06, 1.2063e-06,
         1.3494e-06, 2.7923e-07, 4.9360e-07]], device='cuda:0')
Sum of probabilities per row: tensor([1.], device='cuda:0')
Warning: NaN or Inf found in probabilities here
Traceback (most recent call last):
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 981, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1025, in _run_stage
    self.fit_loop.run()
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/loops/fit_loop.py", line 205, in run
    self.advance()
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/loops/fit_loop.py", line 363, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 140, in run
    self.advance(data_fetcher)
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 250, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], batch_idx, kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 190, in run
    self._optimizer_step(batch_idx, closure)
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 268, in _optimizer_step
    call._call_lightning_module_hook(
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 167, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/core/module.py", line 1306, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/core/optimizer.py", line 153, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 238, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/plugins/precision/precision.py", line 122, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/torch/optim/lr_scheduler.py", line 137, in wrapper
    return func.__get__(opt, opt.__class__)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/torch/optim/optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/torch/optim/optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/torch/optim/adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/plugins/precision/precision.py", line 108, in _wrap_closure
    closure_result = closure()
                     ^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 144, in __call__
    self._result = self.closure(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 129, in closure
    step_output = self._step_fn()
                  ^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 317, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 319, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 390, in training_step
    return self.lightning_module.training_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home6/scur2773/uvadlc_practicals_2024/assignment2/part2/train.py", line 55, in training_step
    generated_sents = self.generate()
                      ^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home6/scur2773/uvadlc_practicals_2024/assignment2/part2/train.py", line 120, in generate
    y = self.model.generate(x, n_steps, temperature=1.0, do_sample=do_sample, top_k=top_k, top_p=top_p)[0]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/home6/scur2773/uvadlc_practicals_2024/assignment2/part2/gpt.py", line 534, in generate
    idx_next = torch.multinomial(probs, num_samples=1)  # (b, 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/home6/scur2773/uvadlc_practicals_2024/assignment2/part2/train.py", line 209, in <module>
    train(args=args)
  File "/gpfs/home6/scur2773/uvadlc_practicals_2024/assignment2/part2/train.py", line 202, in train
    trainer.fit(lightning_model)
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 68, in _call_and_handle_interrupt
    trainer._teardown()
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1004, in _teardown
    self.strategy.teardown()
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 531, in teardown
    _optimizers_to_device(self.optimizers, torch.device("cpu"))
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/lightning_fabric/utilities/optimizer.py", line 28, in _optimizers_to_device
    _optimizer_to_device(opt, device)
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/lightning_fabric/utilities/optimizer.py", line 42, in _optimizer_to_device
    v[key] = move_data_to_device(val, device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/lightning_fabric/utilities/apply_func.py", line 110, in move_data_to_device
    return apply_to_collection(batch, dtype=_TransferableDataType, function=batch_to)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/lightning_utilities/core/apply_func.py", line 64, in apply_to_collection
    return function(data, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/scur2773/.conda/envs/dl2024/lib/python3.12/site-packages/lightning_fabric/utilities/apply_func.py", line 104, in batch_to
    data_output = data.to(device, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

srun: error: gcn42: task 0: Exited with exit code 1
srun: Terminating StepId=8833431.0

JOB STATISTICS
==============
Job ID: 8833431
Cluster: snellius
User/Group: scur2773/scur2773
State: FAILED (exit code 1)
Nodes: 1
Cores per node: 18
CPU Utilized: 00:02:55
CPU Efficiency: 5.37% of 00:54:18 core-walltime
Job Wall-clock time: 00:03:01
Memory Utilized: 1.64 GB
Memory Efficiency: 1.36% of 120.00 GB
